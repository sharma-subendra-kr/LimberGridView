/*

This is a release of LimberGridView 0.0.0, brought to you by Subendra Kumar Sharma.
This software is released under the GNU General Public License version 3, or (at your option) any later version.

LimberGridView, a powerful JavaScript Libary that gives you flexible, movable, resizable(any size) and auto-arranging grids. 

Copyright (c) 2018, Subendra Kumar Sharma. All Rights reserved. (sharma.subendra.kr@gmail.com, sharma.subendrakr@yahoo.com)

This file is part of LimberGridView.

LimberGridView is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

LimberGridView is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with LimberGridView.  If not, see <https://www.gnu.org/licenses/>.

*/

!function(i){var e={};function t(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return i[s].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=i,t.c=e,t.d=function(i,e,s){t.o(i,e)||Object.defineProperty(i,e,{enumerable:!0,get:s})},t.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},t.t=function(i,e){if(1&e&&(i=t(i)),8&e)return i;if(4&e&&"object"==typeof i&&i&&i.__esModule)return i;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),2&e&&"string"!=typeof i)for(var r in i)t.d(s,r,function(e){return i[e]}.bind(null,r));return s},t.n=function(i){var e=i&&i.__esModule?function(){return i.default}:function(){return i};return t.d(e,"a",e),e},t.o=function(i,e){return Object.prototype.hasOwnProperty.call(i,e)},t.p="",t(t.s=0)}([function(i,e){window.LimberGridView=function(){function i(i){this.options=JSON.parse(JSON.stringify(i)),this.callbacks=i.callbacks,this.initialGridData=this.options.initialGridData,this.initialPositionData=this.options.initialGridData.initialPositionData,this.positionData=JSON.parse(JSON.stringify(this.initialPositionData)),void 0!=this.options.initialGridData.mobileAspectRatio&&null!=this.options.initialGridData.mobileAspectRatio&&"number"==typeof this.options.initialGridData.mobileAspectRatio&&(this.MOBILE_ASPECT_RATIO=this.options.initialGridData.mobileAspectRatio),1==this.options.editable&&(this.onLimberGridMouseDownFunctionVariable=this.onLimberGridMouseDown.bind(this),this.onLimberGridMouseMoveBindedFunctionVariable=this.onLimberGridMouseMove.bind(this),this.onLimberGridMouseUpBindedFunctionVariable=this.onLimberGridMouseUp.bind(this),this.onLimberGridContextMenuBindedFunctionVariable=this.onLimberGridContextMenu.bind(this),this.onLimberGridTouchStartFunctionVariable=this.onLimberGridTouchStart.bind(this),this.onLimberGridTouchMoveBindedFunctionVariable=this.onLimberGridTouchMove.bind(this),this.onLimberGridTouchEndBindedFunctionVariable=this.onLimberGridTouchEnd.bind(this),this.onLimberGridTouchCancelBindedFunctionVariable=this.onLimberGridTouchCancel.bind(this),this.onLimberGridTouchContextMenuBindedFunctionVariable=this.onLimberGridTouchContextMenu.bind(this),this.onItemMouseDownFunctionVariable=this.onItemMouseDown.bind(this),this.onMouseMoveBindedFunctionVariable=this.onMouseMove.bind(this),this.onMouseUpBindedFunctionVariable=this.onMouseUp.bind(this),this.onContextMenuBindedFunctionVariable=this.onContextMenu.bind(this),this.onItemTouchStartFunctionVariable=this.onItemTouchStart.bind(this),this.onTouchMoveBindedFunctionVariable=this.onTouchMove.bind(this),this.onTouchEndBindedFunctionVariable=this.onTouchEnd.bind(this),this.onTouchCancelBindedFunctionVariable=this.onTouchCancel.bind(this),this.onItemTouchContextMenuBindedFunctionVariable=this.onItemTouchContextMenu.bind(this),this.limberGridMouseDownCheckTimeOutVariable=null,this.limberGridTouchStartCheckTimeOutVariable=null,void 0!=this.options.moveGuideRadius&&null!=this.options.moveGuideRadius&&"number"==typeof this.options.moveGuideRadius&&(this.MOVE_GUIDE_RADIUS=this.options.moveGuideRadius),void 0!=this.options.resizeSquareGuideLength&&null!=this.options.resizeSquareGuideLength&&"number"==typeof this.options.resizeSquareGuideLength&&(this.RESIZE_SQUARE_GUIDE_LENGTH=this.options.resizeSquareGuideLength),void 0!=this.options.resizeSquareBorderGuideWidth&&null!=this.options.resizeSquareBorderGuideWidth&&"number"==typeof this.options.resizeSquareBorderGuideWidth&&(this.RESIZE_SQUARE_BORDER_GUIDE_WIDTH=this.options.resizeSquareBorderGuideWidth)),void 0!=this.callbacks.onItemClickCallback&&null!=this.callbacks.onItemClickCallback&&(this.onItemClickFunctionVariable=this.onItemClick.bind(this)),0!=this.options.reRenderOnResize&&(this.onWindowResizeFunctionVariable=this.onWindowResize.bind(this),this.onWindowResizeTimerCallbackFunctionVariable=this.onWindowResizeTimerCallback.bind(this),window.addEventListener("resize",this.onWindowResizeFunctionVariable)),this.init(this.initialGridData.gridWidth,this.options.autoArrange)}return i.prototype.constructor=i,i.prototype.MOVE_GUIDE_RADIUS=10,i.prototype.RESIZE_SQUARE_GUIDE_LENGTH=10,i.prototype.RESIZE_SQUARE_BORDER_GUIDE_WIDTH=3,i.prototype.AUTO_SCROLL_DISTANCE=50,i.prototype.AUTO_SCROLL_POINT=50,i.prototype.MOVE_OR_RESIZE_HEIGHT_INCREMENTS=50,i.prototype.MOUSE_DOWN_TIME=500,i.prototype.TOUCH_HOLD_TIME=300,i.prototype.DEMO_WAIT_TIME=500,i.prototype.WINDOW_RESIZE_WAIT_TIME=1e3,i.prototype.MARGIN=5,i.prototype.MOBILE_ASPECT_RATIO=16/9,i.prototype.ADD_OR_CUTSPACE_TOGGLE="ADD",i.prototype.init=function(i,e){if(0!=this.options.el.indexOf("#"))throw"DOM Element with Id required";if(this.$body=document.getElementsByTagName("body"),this.elementID=this.options.el.substring(1,this.options.el.length),this.pseudoElementID="limberGridViewPseudoContainer_"+this.elementID,this.$el=document.getElementById(this.options.el.substring(1,this.options.el.length)),this.$body[0].insertAdjacentHTML("beforeend",'<div id = "'+this.pseudoElementID+'" class = "limberGridViewPseudoContainer"></div>'),this.$bodyPseudoEl=document.getElementById(this.pseudoElementID),this.$el.innerHTML='<div class = "limberGridViewContainer"><style></style><div class = "limberGridView"></div><div class = "limberGridViewLicense"><div class = "limberGridViewLicenseIcon">i</div><div class = "limberGridViewLicenseDetails">LimberGridView Copyright (c) 2018, Subendra Kumar Sharma. License: GNU General Public License version 3, or (at your option) any later version.</div></div></div>',this.$limberGridViewContainer=this.$el.querySelectorAll(".limberGridViewContainer"),this.$limberGridViewStyle=this.$el.getElementsByTagName("style"),this.$limberGridView=this.$el.querySelectorAll(".limberGridView"),this.PADDING_LEFT=parseInt(window.getComputedStyle(this.$limberGridView[0],null).getPropertyValue("padding-left")),this.PADDING_RIGHT=parseInt(window.getComputedStyle(this.$limberGridView[0],null).getPropertyValue("padding-right")),this.PADDING_TOP=parseInt(window.getComputedStyle(this.$limberGridView[0],null).getPropertyValue("padding-top")),this.PADDING_BOTTOM=parseInt(window.getComputedStyle(this.$limberGridView[0],null).getPropertyValue("padding-bottom")),this.WIDTH=this.$limberGridView[0].clientWidth-this.PADDING_LEFT-this.PADDING_RIGHT,this.HEIGHT=this.$limberGridView[0].clientHeight-this.PADDING_TOP-this.PADDING_BOTTOM,void 0!=i&&null!=i||0!=this.positionData.length||(i=this.WIDTH),this.WIDTH_SCALE_FACTOR=this.WIDTH/i,1==e){for(var t=JSON.parse(JSON.stringify(this.positionData)),s=[],r=t.length,o=0;o<r;o++)s.push(o),t[o].width=t[o].width*this.WIDTH_SCALE_FACTOR,t[o].height=t[o].height*this.WIDTH_SCALE_FACTOR,t[o].width>this.WIDTH&&(t[o].width=this.WIDTH);this.positionData=this.fitRemainingItemsBelowDeepestLine(0,t,s,[]).positionData}else{if(void 0==this.initialGridData.margin||null==this.initialGridData.margin)throw"Margin is required for rendering with position coordinates";if(!("number"==typeof this.initialGridData.margin&&this.initialGridData.margin>0))throw"Margin is required for rendering with position coordinates";this.MARGIN=this.initialGridData.margin,this.MARGIN=this.MARGIN*this.WIDTH_SCALE_FACTOR}},i.prototype.getGridData=function(){return{gridHeight:this.HEIGHT,gridWidth:this.WIDTH,margin:this.MARGIN,initialPositionData:JSON.parse(JSON.stringify(this.positionData))}},i.prototype.setAddOrCutSpace=function(i){"ADD"!=i&&"CUTSPACE"!=i||(this.ADD_OR_CUTSPACE_TOGGLE=i)},i.prototype.render=function(i,e=!0){if(this.unInitializeEvents(),void 0===i||null===i)i=this.positionData;if(1==e)var t=this.WIDTH_SCALE_FACTOR;else t=1;var s=["limberGridViewItem"];1==this.options.editable&&s.push("limberGridViewItemEditable");var r=s.join(" "),o=[],n=performance.now();if(this.isMobile()){if(this.serializedPositionData=this.getRowSequence(!0),"string"==this.options.dataType)for(d=i.length,a=0;a<d;a++){i[a].width*=t,i[a].height*=t,i[a].x*=t,i[a].y*=t,i[a].width>this.WIDTH&&(i[a].width=this.WIDTH);h="</div>",l='<div class = "limberGridViewItem" data-index = "'+a+'" '+('style = "transform : translate(0px, '+((this.WIDTH/this.MOBILE_ASPECT_RATIO+this.getMarginAtPoint(this.serializedPositionData.map[a]))*this.serializedPositionData.map[a]+"px); ")+("width : "+this.WIDTH+"px; ")+("height : "+this.WIDTH/this.MOBILE_ASPECT_RATIO+"px; ")+'">')+("<div>"+(u=this.callbacks.getItemRenderDataCallback(a,this.WIDTH,this.WIDTH/this.MOBILE_ASPECT_RATIO,"render"))+h)+"</div>";o.push(l)}else if("node"==this.options.dataType){this.$limberGridViewContainer[0].removeChild(this.$limberGridView[0]);for(d=i.length,a=0;a<d;a++){i[a].width*=t,i[a].height*=t,i[a].x*=t,i[a].y*=t,i[a].width>this.WIDTH&&(i[a].width=this.WIDTH);c=document.createElement("div");(m=document.createAttribute("data-index")).value=a,c.setAttributeNode(m),c.classList.add("limberGridViewItem"),c.style.transform="translate(0px, "+(this.WIDTH/this.MOBILE_ASPECT_RATIO+this.getMarginAtPoint(this.serializedPositionData.map[a]))*this.serializedPositionData.map[a]+"px)",c.style.width=this.WIDTH+"px",c.style.height=this.WIDTH/this.MOBILE_ASPECT_RATIO+"px","string"==typeof(u=this.callbacks.getItemRenderDataCallback(a,this.WIDTH,this.WIDTH/this.MOBILE_ASPECT_RATIO,"render"))?c.innerHTML=u:c.appendChild(u),this.$limberGridView[0].appendChild(c)}this.$limberGridViewContainer[0].appendChild(this.$limberGridView[0])}}else if("string"==this.options.dataType)for(var d=i.length,a=0;a<d;a++){i[a].width*=t,i[a].width>this.WIDTH&&(i[a].width=this.WIDTH);var h="</div>",l='<div class = "'+r+'" data-index = "'+a+'" '+('style = "transform : translate('+(i[a].x*=t)+"px, "+((i[a].y*=t)+"px); ")+("width : "+i[a].width+"px; ")+("height : "+(i[a].height*=t)+"px; ")+'">')+("<div>"+(u=this.callbacks.getItemRenderDataCallback(a,i[a].width,i[a].height,"render"))+h)+"</div>";o.push(l)}else if("node"==this.options.dataType){this.$limberGridViewContainer[0].removeChild(this.$limberGridView[0]);for(var d=i.length,a=0;a<d;a++){i[a].width*=t,i[a].width>this.WIDTH&&(i[a].width=this.WIDTH);var m,u,c=document.createElement("div");(m=document.createAttribute("data-index")).value=a,c.setAttributeNode(m),s.length>0?(c.classList.add(s[0]),c.classList.add(s[1])):c.classList.add(s[0]),c.style.transform="translate("+(i[a].x*=t)+"px, "+(i[a].y*=t)+"px)",c.style.width=i[a].width+"px",c.style.height=(i[a].height*=t)+"px","string"==typeof(u=this.callbacks.getItemRenderDataCallback(a,i[a].width,i[a].height,"render"))?c.innerHTML=u:c.appendChild(u),this.$limberGridView[0].appendChild(c)}this.$limberGridViewContainer[0].appendChild(this.$limberGridView[0])}"string"==this.options.dataType&&(this.$limberGridView[0].innerHTML=o.join(""));var p=performance.now();console.log(n),console.log(p),console.log(p-n),this.$limberGridViewItems=this.$limberGridView[0].querySelectorAll(".limberGridViewItem"),this.renderPseudoElements(i),this.initializeVariables(),this.initializeEvents(),void 0!=this.callbacks.renderComplete&&null!=this.callbacks.renderComplete&&this.callbacks.renderComplete()},i.prototype.renderPseudoElements=function(i){if(void 0!=this.$limberGridViewGridPseudoItems){for(var e=this.positionData.length,t=0;t<e;t++)this.$limberGridViewGridPseudoItems[0].parentNode.removeChild(this.$limberGridViewGridPseudoItems[0]);this.$limberGridViewGridPseudoItems=void 0,this.$limberGridViewBodyPseudoItems=void 0}var s=[],r=[];if(this.isMobile())for(e=i.length,t=0;t<e;t++){d='<div class = "limberGridViewBodyPseudoItem" data-index = "'+t+'" ',a='<div class = "limberGridViewGridPseudoItem" data-index = "'+t+'" '+(o='style = "transform : translate(0px, '+((this.WIDTH/this.MOBILE_ASPECT_RATIO+this.getMarginAtPoint(this.serializedPositionData.map[t]))*this.serializedPositionData.map[t]+"px); ")+("width : "+this.WIDTH+"px; ")+("height : "+this.WIDTH/this.MOBILE_ASPECT_RATIO+"px; ")+("margin : "+this.MARGIN+'px;">'))+(n="</div>"),h=d+o+n;s.push(a),r.push(h)}else for(var e=i.length,t=0;t<e;t++){var o,n,d='<div class = "limberGridViewBodyPseudoItem" data-index = "'+t+'" ',a='<div class = "limberGridViewGridPseudoItem" data-index = "'+t+'" '+(o='style = "transform : translate('+i[t].x+"px, "+(i[t].y+"px); ")+("width : "+i[t].width+"px; ")+("height : "+i[t].height+"px; ")+'">')+(n="</div>"),h=d+o+n;s.push(a),r.push(h)}s.push('<div class = "limberGridViewMoveGuide"></div>'),s.push('<div class = "limberGridViewHeightAdjustGuide"></div>'),s.push('<div class = "limberGridViewAddItemGuide"></div>'),s.push('<div class = "limberGridViewAddItemOnTouchHoldGuide"></div>'),this.$bodyPseudoEl.innerHTML=r.join(""),this.$limberGridView[0].insertAdjacentHTML("beforeend",s.join("")),this.$limberGridViewGridPseudoItems=this.$limberGridView[0].getElementsByClassName("limberGridViewGridPseudoItem"),this.$limberGridViewBodyPseudoItems=this.$bodyPseudoEl.getElementsByClassName("limberGridViewBodyPseudoItem"),this.$limberGridViewMoveGuide=this.$limberGridView[0].getElementsByClassName("limberGridViewMoveGuide"),this.$limberGridViewHeightAdjustGuide=this.$limberGridView[0].getElementsByClassName("limberGridViewHeightAdjustGuide"),this.$limberGridViewAddItemGuide=this.$limberGridView[0].getElementsByClassName("limberGridViewAddItemGuide"),this.$limberGridViewAddItemOnTouchHoldGuide=this.$limberGridView[0].getElementsByClassName("limberGridViewAddItemOnTouchHoldGuide")},i.prototype.renderItems=function(i,e=!0,t="onDemand"){this.unInitializeEvents();var s=this.$limberGridView[0].scrollTop;if(1==e)var r=this.WIDTH_SCALE_FACTOR;else r=1;var o=["limberGridViewItem"];1==this.options.editable&&o.push("limberGridViewItemEditable");var n=performance.now();if(this.isMobile()){this.$limberGridViewContainer[0].removeChild(this.$limberGridView[0]);for(d=i.length,a=0;a<d;a++){m=document.createElement("div");(h=document.createAttribute("data-index")).value=i[a],m.setAttributeNode(h),m.classList.add("limberGridViewItem"),m.style.transform="translate(0px, "+(this.WIDTH/this.MOBILE_ASPECT_RATIO+this.getMarginAtPoint(this.serializedPositionData.map[i[a]]))*this.serializedPositionData.map[i[a]]+"px)",m.style.width=this.WIDTH+"px",m.style.height=this.WIDTH/this.MOBILE_ASPECT_RATIO+"px","string"==typeof(l=this.callbacks.getItemRenderDataCallback(i[a],this.WIDTH,this.WIDTH/this.MOBILE_ASPECT_RATIO,t))?m.innerHTML=l:m.appendChild(l),void 0==this.$limberGridViewItems[i[a]]||null==this.$limberGridViewItems[i[a]]?this.$limberGridView[0].appendChild(m):this.$limberGridView[0].replaceChild(m,this.$limberGridViewItems[i[a]])}this.$limberGridViewContainer[0].appendChild(this.$limberGridView[0])}else{this.$limberGridViewContainer[0].removeChild(this.$limberGridView[0]);for(var d=i.length,a=0;a<d;a++){this.positionData[i[a]].width*=r,this.positionData[i[a]].width>this.WIDTH&&(this.positionData[i[a]].width=this.WIDTH);var h,l,m=document.createElement("div");(h=document.createAttribute("data-index")).value=i[a],m.setAttributeNode(h),o.length>0?(m.classList.add(o[0]),m.classList.add(o[1])):m.classList.add(o[0]),m.style.transform="translate("+(this.positionData[i[a]].x*=r)+"px, "+(this.positionData[i[a]].y*=r)+"px)",m.style.width=this.positionData[i[a]].width+"px",m.style.height=(this.positionData[i[a]].height*=r)+"px","string"==typeof(l=this.callbacks.getItemRenderDataCallback(i[a],this.positionData[i[a]].width,this.positionData[i[a]].height,t))?m.innerHTML=l:m.appendChild(l),void 0==this.$limberGridViewItems[i[a]]||null==this.$limberGridViewItems[i[a]]?this.$limberGridView[0].appendChild(m):this.$limberGridView[0].replaceChild(m,this.$limberGridViewItems[i[a]])}this.$limberGridViewContainer[0].appendChild(this.$limberGridView[0])}var u=performance.now();console.log(n),console.log(u),console.log(u-n),this.$limberGridViewItems=this.$limberGridView[0].querySelectorAll(".limberGridViewItem"),this.renderPseudoItems(i),this.initializeVariables(),this.initializeEvents();var c={items:JSON.parse(JSON.stringify(i)),scale:e,processType:t};return void 0!=this.callbacks.itemsRenderComplete&&null!=this.callbacks.itemsRenderComplete&&"addItems"!=t&&"resizeItems"!=t&&"removeItems"!=t&&"addItemInteractive"!=t&&(this.$limberGridView[0].scrollTop=s,this.callbacks.itemsRenderComplete(c.items,e,t,s)),c},i.prototype.renderPseudoItems=function(i){if(this.isMobile()){this.$limberGridViewContainer[0].removeChild(this.$limberGridView[0]),this.$body[0].removeChild(this.$bodyPseudoEl);for(e=i.length,t=0;t<e;t++){r=document.createElement("div");(s=document.createAttribute("data-index")).value=i[t],r.setAttributeNode(s),r.classList.add("limberGridViewGridPseudoItem"),r.style.transform="translate(0px, "+(this.WIDTH/this.MOBILE_ASPECT_RATIO+this.getMarginAtPoint(this.serializedPositionData.map[t]))*this.serializedPositionData.map[t]+"px)",r.style.width=this.WIDTH+"px",r.style.height=this.WIDTH/this.MOBILE_ASPECT_RATIO+"px";n=document.createElement("div");(o=document.createAttribute("data-index")).value=i[t],n.setAttributeNode(o),n.classList.add("limberGridViewBodyPseudoItem"),n.style.transform="translate(0px, 0px)",n.style.width=this.WIDTH+"px",n.style.height=this.WIDTH/this.MOBILE_ASPECT_RATIO+"px",void 0==this.$limberGridViewGridPseudoItems[i[t]]||null==this.$limberGridViewGridPseudoItems[i[t]]?(this.$limberGridView[0].appendChild(r),this.$bodyPseudoEl.appendChild(n)):(this.$limberGridView[0].replaceChild(r,this.$limberGridViewGridPseudoItems[i[t]]),this.$bodyPseudoEl.replaceChild(n,this.$limberGridViewBodyPseudoItems[i[t]]))}this.$limberGridViewContainer[0].appendChild(this.$limberGridView[0]),this.$body[0].appendChild(this.$bodyPseudoEl)}else{this.$limberGridViewContainer[0].removeChild(this.$limberGridView[0]),this.$body[0].removeChild(this.$bodyPseudoEl);for(var e=i.length,t=0;t<e;t++){var s,r=document.createElement("div");(s=document.createAttribute("data-index")).value=i[t],r.setAttributeNode(s),r.classList.add("limberGridViewGridPseudoItem"),r.style.transform="translate("+this.positionData[i[t]].x+"px, "+this.positionData[i[t]].y+"px)",r.style.width=this.positionData[i[t]].width+"px",r.style.height=this.positionData[i[t]].height+"px";var o,n=document.createElement("div");(o=document.createAttribute("data-index")).value=i[t],n.setAttributeNode(o),n.classList.add("limberGridViewBodyPseudoItem"),n.style.transform="translate(0px, 0px)",n.style.width=this.positionData[i[t]].width+"px",n.style.height=this.positionData[i[t]].height+"px",void 0==this.$limberGridViewGridPseudoItems[i[t]]||null==this.$limberGridViewGridPseudoItems[i[t]]?(this.$limberGridView[0].appendChild(r),this.$bodyPseudoEl.appendChild(n)):(this.$limberGridView[0].replaceChild(r,this.$limberGridViewGridPseudoItems[i[t]]),this.$bodyPseudoEl.replaceChild(n,this.$limberGridViewBodyPseudoItems[i[t]]))}this.$limberGridViewContainer[0].appendChild(this.$limberGridView[0]),this.$body[0].appendChild(this.$bodyPseudoEl)}this.$limberGridViewGridPseudoItems=this.$limberGridView[0].getElementsByClassName("limberGridViewGridPseudoItem"),this.$limberGridViewBodyPseudoItems=this.$bodyPseudoEl.getElementsByClassName("limberGridViewBodyPseudoItem")},i.prototype.removeItems=function(i){this.unInitializeEvents();for(var e=this.$limberGridView[0].scrollTop,t=[],s=o=this.positionData.length-1;s>=0;s--){var r=s;t.push(o-s)}i.sort(function(i,e){return Number(i)-Number(e)});var o;for(s=o=i.length-1;s>=0;s--){r=i[s];this.positionData.splice(r,1);var n=this.$limberGridViewItems[r],d=this.$limberGridViewGridPseudoItems[r],a=this.$limberGridViewBodyPseudoItems[r];this.$limberGridView[0].removeChild(n),this.$limberGridView[0].removeChild(d),this.$bodyPseudoEl.removeChild(a),this.$limberGridViewItems=this.$limberGridView[0].querySelectorAll(".limberGridViewItem"),this.$limberGridViewGridPseudoItems=this.$limberGridView[0].getElementsByClassName("limberGridViewGridPseudoItem"),this.$limberGridViewBodyPseudoItems=this.$bodyPseudoEl.getElementsByClassName("limberGridViewBodyPseudoItem")}t.splice(this.positionData.length),this.isMobile()&&(this.serializedPositionData=this.getRowSequence(!0)),this.renderItems(t,!1,"removeItems"),void 0!=this.callbacks.removeCompleteCallback&&null!=this.callbacks.removeCompleteCallback&&(this.$limberGridView[0].scrollTop=e,this.callbacks.removeCompleteCallback(i))},i.prototype.addItems=function(i=1,e=100,t=100){if(0!=i&&!(e>this.WIDTH)){for(var s=0,r=this.positionData.length,o=0;o<r;o++)this.positionData[o].y+this.positionData[o].height>s&&(s=this.positionData[o].y+this.positionData[o].height);for(var n=[],d=s+=this.getMarginAtPoint(s),a=i,h=this.WIDTH;0!=a;){for(var l=0;h>e+this.getMarginAtPoint(l)&&0!=a;){var m={x:this.getMarginAtPoint(l)+l,y:s,width:e,height:t};h=h-e-this.getMarginAtPoint(l),l=l+this.getMarginAtPoint(l)+e,a--,n.push(m)}h=this.WIDTH,s=s+t+this.MARGIN}var u=this.$limberGridView[0].scrollTop,c=this.addItemsAtPositions(n,!1,"addItems");this.isMobile()?this.$limberGridView[0].scrollTop=u:this.$limberGridView[0].scrollTop=d,void 0!=this.callbacks.addCompleteCallback&&null!=this.callbacks.addCompleteCallback&&this.callbacks.addCompleteCallback(c.items,e,t,"addItems")}},i.prototype.addItemsAtPositions=function(i,e=!0,t="onDemand"){for(var s=[],r=this.positionData.length,o=i.length,n=0;n<o;n++)s.push(r+n),this.isMobile()&&(this.serializedPositionData.list.push(r+n),this.serializedPositionData.map[r+n]=this.serializedPositionData.list.length-1),this.positionData.push(i[n]);return this.renderItems(s,e,t)},i.prototype.reInitializeEvents=function(){this.unInitializeEvents(),this.initializeEvents()},i.prototype.initializeVariables=function(){},i.prototype.initializeEvents=function(){if(1==this.options.editable){0==this.isMobile()&&0!=this.options.enableInteractiveAddAndCut&&(this.$limberGridView[0].addEventListener("mousedown",this.onLimberGridMouseDownFunctionVariable),0!=this.options.enableTouchInteraction&&this.$limberGridView[0].addEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable));for(var i=this.$limberGridViewItems.length,e=0;e<i;e++)0==this.isMobile()&&(this.$limberGridViewItems[e].addEventListener("mousedown",this.onItemMouseDownFunctionVariable),0!=this.options.enableTouchInteraction&&this.$limberGridViewItems[e].addEventListener("touchstart",this.onItemTouchStartFunctionVariable)),void 0!=this.callbacks.onItemClickCallback&&null!=this.callbacks.onItemClickCallback&&this.$limberGridViewItems[e].addEventListener("click",this.onItemClickFunctionVariable)}},i.prototype.unInitializeEvents=function(){if(1==this.options.editable&&(void 0!=this.$limberGridView&&(this.$limberGridView[0].removeEventListener("mousedown",this.onLimberGridMouseDownFunctionVariable),this.$limberGridView[0].removeEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable)),void 0!=this.$limberGridViewItems))for(var i=this.$limberGridViewItems.length,e=0;e<i;e++)this.$limberGridViewItems[e].removeEventListener("mousedown",this.onItemMouseDownFunctionVariable),this.$limberGridViewItems[e].removeEventListener("touchstart",this.onItemTouchStartFunctionVariable),this.$limberGridViewItems[e].removeEventListener("click",this.onItemClickFunctionVariable)},i.prototype.initializeItemTouchEvents=function(){if(void 0!=this.$limberGridViewItems)for(var i=this.$limberGridViewItems.length,e=0;e<i;e++)this.$limberGridViewItems[e].addEventListener("mousedown",this.onItemMouseDownFunctionVariable),this.$limberGridViewItems[e].addEventListener("touchstart",this.onItemTouchStartFunctionVariable)},i.prototype.unInitializeItemTouchEvents=function(){if(void 0!=this.$limberGridViewItems)for(var i=this.$limberGridViewItems.length,e=0;e<i;e++)this.$limberGridViewItems[e].removeEventListener("mousedown",this.onItemMouseDownFunctionVariable),this.$limberGridViewItems[e].removeEventListener("touchstart",this.onItemTouchStartFunctionVariable)},i.prototype.isMobile=function(){return window.matchMedia("only screen and (max-width: 1033px) and (min-width : 1px)").matches},i.prototype.resizePlane=function(i,e,t){if(this.positionData[i].x+e>this.WIDTH)return!1;if("number"!=typeof e||"number"!=typeof t)return!1;if(e<50||t<50)return!1;var s=this.findAffectedItemsOnResize(i,e,t),r=JSON.parse(JSON.stringify(this.positionData[i]));r.width=e,r.height=t;var o=this.findFreeSpaces(r,s.affectedItems);r.doNotMergeFlag=!0;for(var n=this.mergeFreeSpaces(o,[r]),d=[],a=s.affectedItemsExceptSelf.length,h=0;h<a;h++){var l=s.affectedItemsExceptSelf[h];d[h]=JSON.parse(JSON.stringify(this.positionData[s.affectedItemsExceptSelf[h]])),d[h].index=l}var m=this.fitItemsIntoFreeSpaces(d,JSON.parse(JSON.stringify(n)),[r]),u=m.repositionedItems,c=JSON.parse(JSON.stringify(this.positionData));for(a=u.length,h=0;h<a;h++){c[l=u[h].index].x=u[h].x,c[l].y=u[h].y}c[i].width=e,c[i].height=t;var p=[],b=(a=s.affectedItemsExceptSelf.length,u.length);for(h=0;h<a;h++){for(var G=!1,w=0;w<b;w++)if(s.affectedItemsExceptSelf[h]==u[w].index){G=!0;break}0==G&&p.push(s.affectedItemsExceptSelf[h])}for(a=(c=this.fitRemainingItems(c,p,s,i,JSON.parse(JSON.stringify(m)))).length,h=0;h<a;h++)this.$limberGridViewItems[h].style.transform="translate("+c[h].x+"px, "+c[h].y+"px)",this.$limberGridViewItems[h].classList.remove("limberGridViewItemDemo","limberGridViewItemResizingState");this.positionData=c;var I=this.$limberGridView[0].scrollTop;this.renderItems([i],!1,"resizeItems"),this.$limberGridView[0].scrollTop=I},i.prototype.resizePlaneDemo=function(i,e,t){if(this.positionData[i].x+e>this.WIDTH)return!1;if("number"!=typeof e||"number"!=typeof t)return!1;if(e<50||t<50)return!1;for(var s=this.$limberGridViewItems.length,r=0;r<s;r++)this.$limberGridViewItems[r].style.transform="translate("+this.positionData[r].x+"px, "+this.positionData[r].y+"px)",this.$limberGridViewItems[r].classList.remove("limberGridViewItemDemo");var o=this.findAffectedItemsOnResize(i,e,t),n=JSON.parse(JSON.stringify(this.positionData[i]));n.width=e,n.height=t;var d=this.findFreeSpaces(n,o.affectedItems);n.doNotMergeFlag=!0;var a=this.mergeFreeSpaces(d,[n]),h=[];for(s=o.affectedItemsExceptSelf.length,r=0;r<s;r++){var l=o.affectedItemsExceptSelf[r];h[r]=JSON.parse(JSON.stringify(this.positionData[o.affectedItemsExceptSelf[r]])),h[r].index=l}var m=this.fitItemsIntoFreeSpaces(h,JSON.parse(JSON.stringify(a)),[n]).repositionedItems;for(s=m.length,r=0;r<s;r++){l=m[r].index;this.$limberGridViewItems[l].style.transform="translate("+m[r].x+"px, "+m[r].y+"px)"}this.$limberGridViewItems[i].classList.add("limberGridViewItemDemo");var u=[],c=(s=o.affectedItemsExceptSelf.length,m.length);for(r=0;r<s;r++){for(var p=!1,b=0;b<c;b++)if(o.affectedItemsExceptSelf[r]==m[b].index){p=!0;break}if(0==p){l=o.affectedItemsExceptSelf[r];u.push(o.affectedItemsExceptSelf[r]),this.$limberGridViewItems[l].classList.add("limberGridViewItemDemo")}}},i.prototype.movePlane=function(i,e,t){var s=this.findAffectedItemsOnMove(i,e,t),r=JSON.parse(JSON.stringify(this.positionData[i]));r.x=e,r.y=t;var o=this.findFreeSpaces(r,s.affectedItems);r.doNotMergeFlag=!0;for(var n=this.mergeFreeSpaces(o,[r]),d=[],a=s.affectedItemsExceptSelf.length,h=0;h<a;h++){var l=s.affectedItemsExceptSelf[h];d[h]=JSON.parse(JSON.stringify(this.positionData[s.affectedItemsExceptSelf[h]])),d[h].index=l}var m=this.fitItemsIntoFreeSpaces(d,JSON.parse(JSON.stringify(n)),[r]),u=m.repositionedItems,c=JSON.parse(JSON.stringify(this.positionData));for(a=u.length,h=0;h<a;h++){c[l=u[h].index].x=u[h].x,c[l].y=u[h].y}c[i].x=e,c[i].y=t;var p=[],b=(a=s.affectedItemsExceptSelf.length,u.length);for(h=0;h<a;h++){for(var G=!1,w=0;w<b;w++)if(s.affectedItemsExceptSelf[h]==u[w].index){G=!0;break}0==G&&p.push(s.affectedItemsExceptSelf[h])}for(a=(c=this.fitRemainingItems(c,p,s,i,JSON.parse(JSON.stringify(m)))).length,h=0;h<a;h++)this.$limberGridViewItems[h].style.transform="translate("+c[h].x+"px, "+c[h].y+"px)",this.$limberGridViewItems[h].classList.remove("limberGridViewItemDemo");this.positionData=c},i.prototype.movePlaneDemo=function(i,e,t){for(var s=this.$limberGridViewItems.length,r=0;r<s;r++)this.$limberGridViewItems[r].style.transform="translate("+this.positionData[r].x+"px, "+this.positionData[r].y+"px)",this.$limberGridViewItems[r].classList.remove("limberGridViewItemDemo");var o=this.findAffectedItemsOnMove(i,e,t),n=JSON.parse(JSON.stringify(this.positionData[i]));n.x=e,n.y=t;var d=this.findFreeSpaces(n,o.affectedItems);n.doNotMergeFlag=!0;var a=this.mergeFreeSpaces(d,[n]),h=[];for(s=o.affectedItemsExceptSelf.length,r=0;r<s;r++){var l=o.affectedItemsExceptSelf[r];h[r]=JSON.parse(JSON.stringify(this.positionData[o.affectedItemsExceptSelf[r]])),h[r].index=l}var m=this.fitItemsIntoFreeSpaces(h,JSON.parse(JSON.stringify(a)),[n]).repositionedItems;for(s=m.length,r=0;r<s;r++){l=m[r].index;this.$limberGridViewItems[l].style.transform="translate("+m[r].x+"px, "+m[r].y+"px)"}this.$limberGridViewItems[i].classList.add("limberGridViewItemDemo");var u=[],c=(s=o.affectedItemsExceptSelf.length,m.length);for(r=0;r<s;r++){for(var p=!1,b=0;b<c;b++)if(o.affectedItemsExceptSelf[r]==m[b].index){p=!0;break}if(0==p){l=o.affectedItemsExceptSelf[r];u.push(o.affectedItemsExceptSelf[r]),this.$limberGridViewItems[l].classList.add("limberGridViewItemDemo")}}},i.prototype.findFreeSpaces=function(i,e){for(var t=[],s=e.length,r=0;r<s;r++){if(1!=this.isPlaneBInsidePlaneA_TouchingIsInside(i,this.positionData[e[r]],"all").isInside)for(var o=this.subtractPlanes(this.positionData[e[r]],i),n=o.length,d=0;d<n;d++)t.push(o[d])}return t},i.prototype.mergeFreeSpaces=function(i,e){for(var t=i.concat(e),s=function(i,e,t){for(var s=!1,r=i.length,o=0;o<r;o++)if(t.arePlainsSame(i[o],e)){s=!0;break}return s},r=[],o=i.length,n=0;n<o-1;n++)for(var d=n+1;d<o;d++)if(!this.isPlaneBInsidePlaneA_TouchingNotInside(i[n],i[d])){var a=this.mergePlains(i[n],i[d],t);0!=a&&(s(r,a,this)||r.push(a))}for(var h=function(i,e,t,r){for(var o=[],n=i.length,d=e.length,a=0;a<n;a++)for(var h=0;h<d;h++)if(!r.isPlaneBInsidePlaneA_TouchingNotInside(i[a],e[h])){var l=r.mergePlains(i[a],e[h],t);0!=l&&(s(e.concat(o),l,r)||o.push(l))}return o},l=h(i,r,t,this);l.length>0;)l=h(i,r=r.concat(l),t,this);var m={};for(o=(r=r.concat(i)).length,n=0;n<o-1;n++)for(d=n+1;d<o;d++){if(this.isPlaneBInsidePlaneA_TouchingIsInside(r[n],r[d],"all").isInside)m[d]=!0;else this.isPlaneBInsidePlaneA_TouchingIsInside(r[d],r[n],"all").isInside&&(m[n]=!0)}var u=[];for(o=r.length,n=0;n<o;n++)m.hasOwnProperty(n)||u.push(r[n]);return u},i.prototype.findAffectedItemsOnMove=function(i,e,t){var s=JSON.parse(JSON.stringify(this.positionData[i]));s.x=e,s.y=t;for(var r=[],o=[],n=this.positionData.length,d=0;d<n;d++){1==this.isPlaneBInsidePlaneA_TouchingIsInside(s,this.positionData[d])&&(r.push(d),d!=i&&o.push(d))}return{affectedItems:r,affectedItemsExceptSelf:o}},i.prototype.findAffectedItemsOnResize=function(i,e,t){var s=JSON.parse(JSON.stringify(this.positionData[i]));s.width=e,s.height=t;for(var r=[],o=[],n=this.positionData.length,d=0;d<n;d++){1==this.isPlaneBInsidePlaneA_TouchingIsInside(s,this.positionData[d])&&(r.push(d),d!=i&&o.push(d))}return{affectedItems:r,affectedItemsExceptSelf:o}},i.prototype.isPlaneBInsidePlaneA_TouchingIsInside=function(i,e,t){for(var s=[i.x,i.y],r=[i.x+i.width,i.y],o=[i.x,i.y+i.height],n=[i.x+i.width,i.y+i.height],d=[s,r,n,o],a=[e.x,e.y],h=[e.x+e.width,e.y],l=[e.x,e.y+e.height],m=[e.x+e.width,e.y+e.height],u=[a,h,m,l],c=[],p=0,b=!1,G=u.length,w=0;w<G;w++)u[w][0]>=s[0]&&u[w][0]<=r[0]&&u[w][0]>=o[0]&&u[w][0]<=n[0]&&u[w][1]>=s[1]&&u[w][1]<=o[1]&&u[w][1]>=r[1]&&u[w][1]<=n[1]?(c[w]=!0,p++,b=!0):c[w]=!1;p=4==p;var I=!1,g=0;for(G=d.length,w=0;w<G;w++)d[w][0]>=a[0]&&d[w][0]<=h[0]&&d[w][0]>=l[0]&&d[w][0]<=m[0]&&d[w][1]>=a[1]&&d[w][1]<=l[1]&&d[w][1]>=h[1]&&d[w][1]<=m[1]&&(b=!0,g++);return 4==g&&(I=!0),(a[0]>s[0]&&h[0]<r[0]&&a[1]<s[1]&&l[1]>o[1]||a[1]>s[1]&&l[1]<o[1]&&a[0]<s[0]&&h[0]>r[0])&&(b=!0),"overall"==t?b:"individual"==t?c:"all"==t?{overall:b,individual:c,isInside:p,engulfed:I}:b},i.prototype.isPlaneBInsidePlaneA_TouchingNotInside=function(i,e,t){for(var s=[i.x,i.y],r=[i.x+i.width,i.y],o=[i.x,i.y+i.height],n=[i.x+i.width,i.y+i.height],d=[s,r,n,o],a=[e.x,e.y],h=[e.x+e.width,e.y],l=[e.x,e.y+e.height],m=[e.x+e.width,e.y+e.height],u=[a,h,m,l],c=[],p=0,b=!1,G=u.length,w=0;w<G;w++)u[w][0]>s[0]&&u[w][0]<r[0]&&u[w][0]>o[0]&&u[w][0]<n[0]&&u[w][1]>s[1]&&u[w][1]<o[1]&&u[w][1]>r[1]&&u[w][1]<n[1]?(c[w]=!0,p++,b=!0):c[w]=!1;p=4==p;var I=!1,g=0;for(G=d.length,w=0;w<G;w++)d[w][0]>a[0]&&d[w][0]<h[0]&&d[w][0]>l[0]&&d[w][0]<m[0]&&d[w][1]>a[1]&&d[w][1]<l[1]&&d[w][1]>h[1]&&d[w][1]<m[1]&&(b=!0,g++);return 4==g&&(I=!0),(a[0]>=s[0]&&h[0]<=r[0]&&a[1]<=s[1]&&l[1]>=o[1]||a[1]>=s[1]&&l[1]<=o[1]&&a[0]<=s[0]&&h[0]>=r[0])&&(b=!0),(s[0]>=a[0]&&r[0]<=h[0]&&s[1]<=a[1]&&o[1]>=l[1]||s[1]>=a[1]&&o[1]<=l[1]&&s[0]<=a[0]&&r[0]>=h[0])&&(b=!0),a[0]==s[0]&&h[0]==r[0]&&(a[1]>=s[1]&&a[1]<o[1]||l[1]>s[1]&&l[1]<=o[1])&&(b=!0),s[0]==a[0]&&r[0]==h[0]&&(s[1]>=a[1]&&s[1]<l[1]||o[1]>a[1]&&o[1]<=l[1])&&(b=!0,s[1]>a[1]&&o[1]<l[1]&&(I=!0)),a[1]==s[1]&&l[1]==o[1]&&(a[0]>=s[0]&&a[0]<r[0]||h[0]>s[0]&&h[0]<=r[0])&&(b=!0),s[1]==a[1]&&o[1]==l[1]&&(s[0]>=a[0]&&s[0]<h[0]||r[0]>a[0]&&r[0]<=h[0])&&(b=!0,s[0]>a[0]&&r[0]<h[0]&&(I=!0)),"overall"==t?b:"individual"==t?c:"all"==t?{overall:b,individual:c,isInside:p,engulfed:I}:b},i.prototype.fitItemsIntoFreeSpaces=function(i,e,t){i=JSON.parse(JSON.stringify(i)),e=JSON.parse(JSON.stringify(e)),t=JSON.parse(JSON.stringify(t));this.sortPlainsByArea(i);for(var s=[],r=this.findMatchingSpace(i,e);null!=r.matchingItemIndex&&null!=r.matchingFreeSpaceIndex;){var o=JSON.parse(JSON.stringify(i[r.matchingItemIndex])),n={x:e[r.matchingFreeSpaceIndex].x+this.getMarginAtPoint(e[r.matchingFreeSpaceIndex].x),y:e[r.matchingFreeSpaceIndex].y+this.getMarginAtPoint(e[r.matchingFreeSpaceIndex].y),width:o.width,height:o.height,index:o.index};s.push(n);var d={x:e[r.matchingFreeSpaceIndex].x,y:e[r.matchingFreeSpaceIndex].y,width:o.width+this.getMarginAtPoint(e[r.matchingFreeSpaceIndex].x),height:o.height+this.getMarginAtPoint(e[r.matchingFreeSpaceIndex].y),doNotMergeFlag:!0};i.splice(r.matchingItemIndex,1);for(var a=[],h=e.length,l=0;l<h;l++){var m=this.subtractPlanes(e[l],d);0!=m?a=a.concat(m):a.push(JSON.parse(JSON.stringify(e[l])))}t.push(d);var u=this.mergeFreeSpaces(a,t);e=u;r=this.findMatchingSpace(i,u)}return{repositionedItems:s,freeSpaces:e}},i.prototype.findMatchingSpace=function(i,e){for(var t=null,s=null,r=i.length,o=0;o<r;o++){for(var n=[],d=[],a=e.length,h=0;h<a;h++){var l=JSON.parse(JSON.stringify(i[o]));this.getMarginAtPoint(e[h].x)==this.MARGIN&&(l.width+=1*this.MARGIN),this.getMarginAtPoint(e[h].y)==this.MARGIN&&(l.height+=1*this.MARGIN);var m=e[h].width,u=e[h].height;if(this.arePlainsIdentical(l,e[h])){t=o,s=h;break}Math.floor(m/l.width)>=1&&u>=l.height&&n.push(h),Math.floor(u/l.height)>=1&&m>=l.width&&d.push(h)}var c=0,p=null,b=0,G=null,w=0,I=null,g=0,f=null;a=n.length;for(k=0;k<a;k++){var v=Math.floor(e[n[k]].width/l.width);(y=e[n[k]].width/l.width-v)>c&&(c=y,p=n[k]),(e[n[k]].y<=b||0==b)&&(e[n[k]].y==b?null==p?(b=e[n[k]].y,G=n[k]):y==c&&(b=e[n[k]].y,G=n[k]):(b=e[n[k]].y,G=n[k]))}a=d.length;for(k=0;k<a;k++){var y;v=Math.floor(e[d[k]].height/l.height);(y=e[d[k]].height/l.height-v)>w&&(w=y,I=d[k]),(e[d[k]].y<=g||0==g)&&(e[d[k]].y==g?null==I?(g=e[d[k]].y,f=d[k]):y==w&&(g=e[d[k]].y,f=d[k]):(g=e[d[k]].y,f=d[k]))}if(null!=G||null!=f){if(b<g){t=o,s=G;break}t=o,s=f;break}if(null!=p||null!=I){if(c>w){t=o,s=p;break}t=o,s=I;break}}return{matchingItemIndex:t,matchingFreeSpaceIndex:s}},i.prototype.fitRemainingItems=function(i,e,t,s,r){if(0==e.length)return i;for(var o=[],n=t.affectedItems.length,d=0;d<n;d++)o.push(JSON.parse(JSON.stringify(i[t.affectedItems[d]])));var a=this.sortPlainsByDepth(o),h=a[0].y+a[0].height,l={};for(n=e.length,d=0;d<n;d++)l[e[d]]=!0;var m=null,u=null;for(n=i.length,d=0;d<n;d++)l.hasOwnProperty(d)||i[d].y<h&&(i[d].y+i[d].height<=h||i[d].y+i[d].height>h)&&(i[d].y+i[d].height>h&&(m<i[d].y+i[d].height||null==m)&&(m=i[d].y+i[d].height),i[d].y+i[d].height<=h&&(u<i[d].y+i[d].height||null==u)&&(u=i[d].y+i[d].height));if(null!=m){var c=m,p=(I=this.getItemsFromPointDepth(c,!0,i)).itemsFromPointDepth,b=this.fitRemainingItemsAboveDeepestLine(c,i,e,r);i=b.positionData,e=b.remainingItems;var G=this.fitRemainingItemsBelowDeepestLine(c,i,e,t),w=this.shitftItemsBelow(G.deepestY-c+I.shiftHeightToAdd,G.positionData,p)}else if(null!=u){var I;c=u,p=(I=this.getItemsFromPointDepth(c,!1,i)).itemsFromPointDepth,G=this.fitRemainingItemsBelowDeepestLine(c,i,e,t),w=this.shitftItemsBelow(G.deepestY-c,G.positionData,p)}return w},i.prototype.fitRemainingItemsAboveDeepestLine=function(i,e,t,s){for(var r={x:0,y:i,width:this.WIDTH,height:1},o={},n=t.length,d=0;d<n;d++)o[t[d]]=!0;var a=[];for(n=e.length,d=0;d<n;d++)if(!o.hasOwnProperty(d)&&e[d].y<=i&&e[d].y+e[d].height<=i){var h=JSON.parse(JSON.stringify(e[d]));h.doNotMergeFlag=!0,a.push(h)}var l=s.freeSpaces;l.push(r);var m=this.mergeFreeSpaces(l,a);for(n=m.length,d=0;d<n;d++)m[d].y+m[d].height==i+1&&(m[d].height-=1);var u=[];for(n=t.length,d=0;d<n;d++)u.push(JSON.parse(JSON.stringify(e[t[d]]))),u[d].index=t[d];var c=this.fitItemsIntoFreeSpaces(u,m,a).repositionedItems;if(c.length>0){fittedRemainingItems={};n=c.length;var p=t.length;for(d=0;d<n;d++)for(var b=0;b<p;b++)c[d].index==t[b]&&(fittedRemainingItems[b]=!0,e[t[b]].x=c[d].x,e[t[b]].y=c[d].y);var G=Object.keys(fittedRemainingItems);for(d=n=G.length-1;d>=0;d--)t.splice(G[d],1)}return{remainingItems:t,positionData:e}},i.prototype.fitRemainingItemsBelowDeepestLine=function(i,e,t,s){if(0==t.length)return{positionData:e,deepestY:i};JSON.parse(JSON.stringify(t));for(var r=[],o=t.length,n=0;n<o;n++)r.push(JSON.parse(JSON.stringify(e[t[n]]))),r[n].index=t[n];r=this.sortPlainsByHeight(r);for(var d={x:0,y:i,width:this.WIDTH,height:r[0].height+this.getMarginAtPoint(i)},a=this.WIDTH,h=i;0!=r.length;){r.length>0&&(h=i+r[0].height+this.getMarginAtPoint(i));var l=[],m=[],u={};for(o=r.length,n=0;n<o;n++)if(!u.hasOwnProperty(n)&&a>=r[n].width+this.getMarginAtPoint(this.WIDTH-a)){r[n].x=this.WIDTH-a+this.getMarginAtPoint(this.WIDTH-a),r[n].y=i+this.getMarginAtPoint(i),e[r[n].index].x=this.WIDTH-a+this.getMarginAtPoint(this.WIDTH-a),e[r[n].index].y=i+this.getMarginAtPoint(i);var c={x:this.WIDTH-a,y:i,width:r[n].width+this.getMarginAtPoint(this.WIDTH-a),height:r[n].height+this.getMarginAtPoint(i),doNotMergeFlag:!0};m.push(c);var p={x:this.WIDTH-a,y:i+this.getMarginAtPoint(i)+r[n].height,width:r[n].width+this.getMarginAtPoint(this.WIDTH-a),height:d.y+d.height-(i+this.getMarginAtPoint(i)+r[n].height)};this.isValidPlane(p)&&l.push(p),u[n]=!0,a-=r[n].width+this.getMarginAtPoint(this.WIDTH-a)}for(n=o=(I=Object.keys(u)).length-1;n>=0;n--)r.splice(I[n],1);if(a>0){p={x:this.WIDTH-a,y:i,width:a,height:d.height};this.isValidPlane(p)&&l.push(p)}if(r.length>0){this.mergeFreeSpaces(l,m);var b=this.fitItemsIntoFreeSpaces(r,l,m).repositionedItems;if(b.length>0){u={};o=b.length;var G=r.length;for(n=0;n<o;n++)for(var w=0;w<G;w++)b[n].index==r[w].index&&(u[w]=!0,e[r[w].index].x=b[n].x,e[r[w].index].y=b[n].y);var I;for(n=o=(I=Object.keys(u)).length-1;n>=0;n--)r.splice(I[n],1)}}if(r.length>0){i=d.y+d.height;d={x:0,y:d.y+d.height,width:this.WIDTH,height:r[0].height+this.getMarginAtPoint(d.y+d.height)};a=this.WIDTH}}return{positionData:e,deepestY:h}},i.prototype.getItemsFromPointDepth=function(i,e=!1,t){for(var s={},r=0,o=t.length,n=0;n<o;n++)if(1==e&&t[n].y<i&&t[n].y+t[n].height>i){s[n]=!0;var d=i-t[n].y;d>r&&(r=d)}else t[n].y>=i&&(s[n]=!0);return{itemsFromPointDepth:s,shiftHeightToAdd:r}},i.prototype.shitftItemsBelow=function(i,e,t){i+=this.MARGIN;for(var s=e.length,r=0;r<s;r++)t.hasOwnProperty(r)&&(e[r].y+=i);return e},i.prototype.shiftItemsUp=function(i,e){for(var t=this.positionData.length,s=0;s<t;s++)this.positionData[s].y>=i&&(this.positionData[s].y-=e,this.$limberGridViewItems[s].style.transform="translate("+this.positionData[s].x+"px, "+this.positionData[s].y+"px)")},i.prototype.mergePlains=function(i,e,t=[]){for(var s=this.getLines(i),r=this.getLines(e),o={0:2,1:3,2:0,3:1},n=0,d=[],a=[],h=[],l=[],m=null,u=null,c=null,p=s.length,b=0;b<p;b++){n=0,d=[],a=[],h=[],l=[],m=null;var G=s[b],w=r[o[b]];u=b,c=o[b];for(var I=JSON.parse(JSON.stringify(w[0])),g=JSON.parse(JSON.stringify(w[1])),f=G.length,v=0;v<f;v++){var y=JSON.parse(JSON.stringify(G[v]));if(0==b||2==b)var V=y[0],D=I[1],A=(y[0]-I[0])/(g[0]-I[0]),x=Math.abs(y[1]-I[1]);else V=I[0],D=y[1],A=(y[1]-I[1])/(g[1]-I[1]),x=Math.abs(y[0]-I[0]);A<0||A>1||(A>=0&&A<=1?(d.push([V,D]),a.push(y),m=x,n++):console.warn("Should not hit this check algo"))}I=JSON.parse(JSON.stringify(G[0])),g=JSON.parse(JSON.stringify(G[1])),f=w.length;for(var T=0;T<f;T++){y=JSON.parse(JSON.stringify(w[T]));if(0==b||2==b)V=y[0],D=I[1],A=(y[0]-I[0])/(g[0]-I[0]),x=Math.abs(y[1]-I[1]);else V=I[0],D=y[1],A=(y[1]-I[1])/(g[1]-I[1]),x=Math.abs(y[0]-I[0]);A<0||A>1||(A>=0&&A<=1?(h.push([V,D]),l.push(y),m=x,n++):console.warn("Should not hit this check algo"))}if(2==n||3==n||4==n){if(2==n&&JSON.stringify(a)==JSON.stringify(h))continue;break}}if(n<=0||n>=5)return!1;if(0==u||2==u){var P=JSON.parse(JSON.stringify(s[o[u]])),E=JSON.parse(JSON.stringify(r[o[c]]));if((x=Math.abs(P[0][1]-E[0][1]))<m){u=o[u],m=x;var C=r[c=o[c]][0][1];for(p=d.length,b=0;b<p;b++)d[b][1]=C,a[b][1]=P[0][1];for(C=s[u][0][1],p=h.length,b=0;b<p;b++)h[b][1]=C,l[b][1]=E[0][1]}}else{P=JSON.parse(JSON.stringify(s[o[u]])),E=JSON.parse(JSON.stringify(r[o[c]]));if((x=Math.abs(P[0][0]-E[0][0]))<m){u=o[u],m=x;var S=r[c=o[c]][0][0];for(p=d.length,b=0;b<p;b++)d[b][0]=S,a[b][0]=P[0][0];for(S=s[u][0][0],p=h.length,b=0;b<p;b++)h[b][0]=S,l[b][0]=E[0][0]}}if(m>this.MARGIN){var L=[],M=null;if(4==n)L=a.concat(l),M=this.getPlainFrom4Points(L);else{for(p=a.length,b=0;b<p;b++)L.push(a[b]),L.push(d[b]);for(p=l.length,b=0;b<p;b++)L.push(l[b]),L.push(h[b]);if(L.length>4){var $={},O=[];for(p=L.length,b=0;b<p;b++){var N=JSON.parse(JSON.stringify(L[b]));$.hasOwnProperty(N)||($[N]=!0,O.push(L[b]))}M=this.getPlainFrom4Points(O)}else M=this.getPlainFrom4Points(L)}var R=this.getLines(M);if(0==u||2==u)if(0==u)var _=JSON.parse(JSON.stringify(R[2]));else _=JSON.parse(JSON.stringify(R[0]));else if(3==u)_=JSON.parse(JSON.stringify(R[1]));else _=JSON.parse(JSON.stringify(R[3]));var B=-1,H=null;for(p=t.length,b=0;b<p;b++)if(this.isPlaneBInsidePlaneA_TouchingNotInside(M,t[b])){if(t[b].hasOwnProperty("doNotMergeFlag")){B=-1,H=-1;break}this.getLines(t[b]);if(0==u||2==u)if(0==u)x=Math.abs(_[0][1]-(t[b].y+t[b].height));else x=Math.abs(_[0][1]-t[b].y);else if(3==u)x=Math.abs(_[0][0]-(t[b].x+t[b].width));else x=Math.abs(_[0][0]-t[b].x);if(x<B||B<0){B=x,H=b;break}}if(null!=H)if(B>this.MARGIN)var k=!1;else k=!1;else var F=!0}else F=!0;if(1==F){k={};if(0==u||2==u){P=JSON.parse(JSON.stringify(s[o[u]])),E=JSON.parse(JSON.stringify(r[o[c]]));u=o[u];for(C=r[c=o[c]][0][1],p=d.length,b=0;b<p;b++)d[b][1]=C,a[b][1]=P[0][1];for(C=s[u][0][1],p=h.length,b=0;b<p;b++)h[b][1]=C,l[b][1]=E[0][1]}else{P=JSON.parse(JSON.stringify(s[o[u]])),E=JSON.parse(JSON.stringify(r[o[c]]));u=o[u];for(S=r[c=o[c]][0][0],p=d.length,b=0;b<p;b++)d[b][0]=S,a[b][0]=P[0][0];for(S=s[u][0][0],p=h.length,b=0;b<p;b++)h[b][0]=S,l[b][0]=E[0][0]}if(4==n){var z=a.concat(l);k=this.getPlainFrom4Points(z)}else{for(z=[],p=a.length,b=0;b<p;b++)z.push(a[b]),z.push(d[b]);for(p=l.length,b=0;b<p;b++)z.push(l[b]),z.push(h[b]);if(z.length>4){$={};var W=[];for(p=z.length,b=0;b<p;b++){N=JSON.parse(JSON.stringify(z[b]));$.hasOwnProperty(N)||($[N]=!0,W.push(z[b]))}k=this.getPlainFrom4Points(W)}else k=this.getPlainFrom4Points(z)}}return 0!=k&&(!!this.isValidPlane(k)&&k)},i.prototype.subtractPlanes=function(i,e){var t=[],s=this.isPlaneBInsidePlaneA_TouchingIsInside(i,e,"all");if(1==s.engulfed)return!1;if(1!=s.overall)return!1;if(i.x<=e.x){if(i.x+i.width>e.x)if(i.y<e.y){var r={x:i.x,y:i.y,width:i.width,height:e.y-i.y};if(this.isValidPlane(r)&&t.push(r),i.y+i.height<e.y+e.height){r={x:i.x,y:e.y,width:e.x-i.x,height:i.y+i.height-e.y};this.isValidPlane(r)&&t.push(r)}else if(i.y+i.height>=e.y+e.height){r={x:i.x,y:e.y,width:e.x-i.x,height:e.height};if(this.isValidPlane(r)&&t.push(r),i.y+i.height>e.y+e.height){r={x:i.x,y:e.y+e.height,width:i.width,height:i.y+i.height-(e.y+e.height)};this.isValidPlane(r)&&t.push(r)}}}else if(i.y>=e.y){if(i.y+i.height<e.y+e.height){r={x:i.x,y:i.y,width:e.x-i.x,height:i.height};this.isValidPlane(r)&&t.push(r)}else{r={x:i.x,y:i.y,width:e.x-i.x,height:e.y+e.height-i.y};this.isValidPlane(r)&&t.push(r)}if(i.y+i.height>e.y+e.height){r={x:i.x,y:e.y+e.height,width:i.width,height:i.y+i.height-(e.y+e.height)};this.isValidPlane(r)&&t.push(r)}}if(i.x+i.width>e.x+e.width)if(i.y<e.y)if(i.y+i.height<e.y+e.height){r={x:e.x+e.width,y:e.y,width:i.x+i.width-(e.x+e.width),height:i.y+i.height-e.y};this.isValidPlane(r)&&t.push(r)}else{r={x:e.x+e.width,y:e.y,width:i.x+i.width-(e.x+e.width),height:e.height};this.isValidPlane(r)&&t.push(r)}else if(i.y+i.height<e.y+e.height){r={x:e.x+e.width,y:i.y,width:i.x+i.width-(e.x+e.width),height:i.height};this.isValidPlane(r)&&t.push(r)}else{r={x:e.x+e.width,y:i.y,width:i.x+i.width-(e.x+e.width),height:e.y+e.height-i.y};this.isValidPlane(r)&&t.push(r)}}else if(i.y<e.y){r={x:i.x,y:i.y,width:i.width,height:e.y-i.y};if(this.isValidPlane(r)&&t.push(r),i.y+i.height<e.y+e.height)if(i.x+i.width<=e.x+e.width);else{r={x:e.x+e.width,y:e.y,width:i.x+i.width-(e.x+e.width),height:i.y+i.height-e.y};this.isValidPlane(r)&&t.push(r)}else if(i.y+i.height>=e.y+e.height)if(i.x+i.width<=e.x+e.width){if(i.y+i.height>e.y+e.height){r={x:i.x,y:e.y+e.height,width:i.width,height:i.y+i.height-(e.y+e.height)};this.isValidPlane(r)&&t.push(r)}}else{r={x:e.x+e.width,y:e.y,width:i.x+i.width-(e.x+e.width),height:e.height};if(this.isValidPlane(r)&&t.push(r),i.y+i.height>e.y+e.height){r={x:i.x,y:e.y+e.height,width:i.width,height:i.y+i.height-(e.y+e.height)};this.isValidPlane(r)&&t.push(r)}}}else if(i.y>=e.y)if(i.y+i.height<e.y+e.height)if(i.x+i.width<e.x+e.width);else{r={x:e.x+e.width,y:i.y,width:i.x+i.width-(e.x+e.width),height:i.height};this.isValidPlane(r)&&t.push(r)}else if(i.x+i.width<e.x+e.width){if(i.y+i.height>e.y+e.height){r={x:i.x,y:e.y+e.height,width:i.width,height:i.y+i.height-(e.y+e.height)};this.isValidPlane(r)&&t.push(r)}}else{r={x:e.x+e.width,y:i.y,width:i.x+i.width-(e.x+e.width),height:e.y+e.height-i.y};if(this.isValidPlane(r)&&t.push(r),i.y+i.height>e.y+e.height){r={x:i.x,y:e.y+e.height,width:i.width,height:i.y+i.height-(e.y+e.height)};this.isValidPlane(r)&&t.push(r)}}return t.length>0&&t},i.prototype.onWindowResize=function(i){setTimeout(this.onWindowResizeTimerCallbackFunctionVariable,this.WINDOW_RESIZE_WAIT_TIME),window.removeEventListener("resize",this.onWindowResizeFunctionVariable)},i.prototype.onWindowResizeTimerCallback=function(i){this.init(this.WIDTH,!1),this.render(),0!=this.options.reRenderOnResize&&window.addEventListener("resize",this.onWindowResizeFunctionVariable)},i.prototype.onItemClick=function(i){this.callbacks.onItemClickCallback(i)},i.prototype.onLimberGridMouseDown=function(i){i.target.classList.contains("limberGridView")&&(i.stopPropagation(),1==i.which&&(this.limberGridMouseDownCancel=!1,this.limberGridMouseDownTimerComplete=!1,clearTimeout(this.limberGridMouseDownCheckTimeOutVariable),this.limberGridMouseDownCheckTimeOutVariable=setTimeout(this.onLimberGridMouseDownCheck.bind(this,i,i.offsetX,i.offsetY),this.MOUSE_DOWN_TIME),this.$limberGridView[0].addEventListener("mousemove",this.onLimberGridMouseMoveBindedFunctionVariable),document.addEventListener("mouseup",this.onLimberGridMouseUpBindedFunctionVariable),document.addEventListener("contextmenu",this.onLimberGridContextMenuBindedFunctionVariable)))},i.prototype.onLimberGridTouchStart=function(i){i.target.classList.contains("limberGridView")&&(i.stopPropagation(),this.limberGridTouchStartCancel=!1,this.limberGridTouchStartTimerComplete=!1,clearTimeout(this.limberGridTouchStartCheckTimeOutVariable),this.limberGridTouchStartCheckTimeOutVariable=setTimeout(this.onLimberGridTouchStartCheck.bind(this,i),this.TOUCH_HOLD_TIME),this.$limberGridView[0].addEventListener("touchmove",this.onLimberGridTouchMoveBindedFunctionVariable),document.addEventListener("touchend",this.onLimberGridTouchEndBindedFunctionVariable),document.addEventListener("touchcancel",this.onLimberGridTouchCancelBindedFunctionVariable),document.addEventListener("contextmenu",this.onLimberGridTouchContextMenuBindedFunctionVariable),this.unInitializeItemTouchEvents(),i.stopPropagation())},i.prototype.onLimberGridMouseDownCheck=function(i,e,t){if(0==this.limberGridMouseDownCancel){this.limberGridMouseDownTimerComplete=!0,this.$body[0].classList.add("limberGridViewBodyTagStateElementDraggingOrResizing","limberGridViewBodyTagStateElementAdding");for(var s=this.$limberGridViewItems.length,r=0;r<s;r++)this.$limberGridViewItems[r].classList.add("limberGridViewItemResizingState");for(s=this.$limberGridViewGridPseudoItems.length,r=0;r<s;r++)this.$limberGridViewGridPseudoItems[r].classList.add("limberGridViewGridPseudoItemResizingState");var o=this.$limberGridView[0].scrollTop,n=e+this.$limberGridView[0].scrollLeft-this.PADDING_LEFT,d=t+o-this.PADDING_TOP;this.userActionData={type:"add",addPositionX:n,addPositionY:d},this.$limberGridViewAddItemGuide[0].style.height="1px",this.$limberGridViewAddItemGuide[0].style.width="1px",this.$limberGridViewAddItemGuide[0].style.transform="translate("+n+"px, "+d+"px)","ADD"==this.ADD_OR_CUTSPACE_TOGGLE?this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideActive"):"CUTSPACE"==this.ADD_OR_CUTSPACE_TOGGLE&&this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideActive","limberGridViewAddItemGuideCutMode"),this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$limberGridViewHeightAdjustGuide[0].classList.add("limberGridViewHeightAdjustGuideActive")}},i.prototype.onLimberGridTouchStartCheck=function(i){if(0==this.limberGridTouchStartCancel){this.limberGridTouchStartTimerComplete=!0,this.$body[0].classList.add("limberGridViewBodyTagStateElementDraggingOrResizing","limberGridViewBodyTagStateElementAdding");for(var e=this.$limberGridViewItems.length,t=0;t<e;t++)this.$limberGridViewItems[t].classList.add("limberGridViewItemResizingState");for(e=this.$limberGridViewGridPseudoItems.length,t=0;t<e;t++)this.$limberGridViewGridPseudoItems[t].classList.add("limberGridViewGridPseudoItemResizingState");var s=this.calculateTouchPosOnLimberGrid(i),r=s.x,o=s.y;this.userActionData={type:"add",addPositionX:r,addPositionY:o};setTimeout(function(){this.$limberGridViewAddItemOnTouchHoldGuide[0].classList.remove("limberGridViewAddItemOnTouchHoldGuideActive")}.bind(this),500),this.$limberGridViewAddItemGuide[0].style.height="1px",this.$limberGridViewAddItemGuide[0].style.width="1px",this.$limberGridViewAddItemGuide[0].style.transform="translate("+r+"px, "+o+"px)","ADD"==this.ADD_OR_CUTSPACE_TOGGLE?this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideActive"):"CUTSPACE"==this.ADD_OR_CUTSPACE_TOGGLE&&this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideActive","limberGridViewAddItemGuideCutMode"),this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$limberGridViewHeightAdjustGuide[0].classList.add("limberGridViewHeightAdjustGuideActive"),this.insertAddItemOnTouchHoldGuideStyles(r,o),this.$limberGridViewAddItemOnTouchHoldGuide[0].style.transform="translate("+r+"px, "+o+"px)",this.$limberGridViewAddItemOnTouchHoldGuide[0].classList.add("limberGridViewAddItemOnTouchHoldGuideActive"),i.preventDefault()}},i.prototype.onLimberGridMouseMove=function(i){if(1==this.limberGridMouseDownTimerComplete){(this.$limberGridViewAddItemGuide[0].classList.contains("limberGridViewAddItemGuideAddAllow")||this.$limberGridViewAddItemGuide[0].classList.contains("limberGridViewAddItemGuideAddDisallow"))&&this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideAddAllow","limberGridViewAddItemGuideAddDisallow");var e=this.$limberGridView[0].scrollTop,t=this.$limberGridView[0].scrollLeft,s=this.userActionData.addPositionX,r=this.userActionData.addPositionY,o=i.offsetX-s+t-this.PADDING_LEFT,n=i.offsetY-r+e-this.PADDING_TOP;this.userActionData.newWidth=o,this.userActionData.newHeight=n;var d=i.offsetY+e;this.adjustHeight(d),o>0&&n>0&&(this.$limberGridViewAddItemGuide[0].style.width=o+"px",this.$limberGridViewAddItemGuide[0].style.height=n+"px"),"ADD"==this.ADD_OR_CUTSPACE_TOGGLE?(clearTimeout(this.addItemAllowCheckTimeOutVariable),this.addItemAllowCheckTimeOutVariable=setTimeout(this.addItemAllowCheckTimeOut.bind(this,this.userActionData.addPositionX,this.userActionData.addPositionY,o,n),this.DEMO_WAIT_TIME)):"CUTSPACE"==this.ADD_OR_CUTSPACE_TOGGLE&&(clearTimeout(this.cutSpaceAllowCheckTimeOutVariable),this.cutSpaceAllowCheckTimeOutVariable=setTimeout(this.cutSpaceAllowCheckTimeOut.bind(this,this.userActionData.addPositionX,this.userActionData.addPositionY,o,n),this.DEMO_WAIT_TIME))}else clearTimeout(this.limberGridMouseDownCheckTimeOutVariable),this.$limberGridView[0].removeEventListener("mousemove",this.onLimberGridMouseMoveBindedFunctionVariable),document.removeEventListener("mouseup",this.onLimberGridMouseUpBindedFunctionVariable),document.removeEventListener("contextmenu",this.onLimberGridContextMenuBindedFunctionVariable);i.stopPropagation()},i.prototype.onLimberGridTouchMove=function(i){if(1==this.limberGridTouchStartTimerComplete){console.log("limberGridTouchStartTimerComplete"),(this.$limberGridViewAddItemGuide[0].classList.contains("limberGridViewAddItemGuideAddAllow")||this.$limberGridViewAddItemGuide[0].classList.contains("limberGridViewAddItemGuideAddDisallow"))&&this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideAddAllow","limberGridViewAddItemGuideAddDisallow");var e=this.$limberGridView[0].scrollTop,t=this.$limberGridView[0].scrollLeft,s=this.userActionData.addPositionX,r=this.userActionData.addPositionY,o=this.calculateTouchPosOnLimberGrid(i);if(0!=o){var n=o.x-s,d=o.y-r;this.userActionData.newWidth=n,this.userActionData.newHeight=d,n>0&&d>0&&(this.$limberGridViewAddItemGuide[0].style.width=n+"px",this.$limberGridViewAddItemGuide[0].style.height=d+"px")}if(0!=o){var a=this.$limberGridView[0].getBoundingClientRect(),h=(this.$limberGridView[0].offsetWidth,a.left,this.$limberGridView[0].offsetHeight-a.top),l=(o.x,this.PADDING_LEFT,o.y+this.PADDING_TOP-e),m=o.y;this.adjustHeight(m);var u=this.adjustScroll(l,h)}"ADD"==this.ADD_OR_CUTSPACE_TOGGLE?(clearTimeout(this.addItemAllowCheckTimeOutVariable),1!=u&&(this.addItemAllowCheckTimeOutVariable=setTimeout(this.addItemAllowCheckTimeOut.bind(this,this.userActionData.addPositionX,this.userActionData.addPositionY,n,d),this.DEMO_WAIT_TIME))):"CUTSPACE"==this.ADD_OR_CUTSPACE_TOGGLE&&(clearTimeout(this.cutSpaceAllowCheckTimeOutVariable),1!=u&&(this.cutSpaceAllowCheckTimeOutVariable=setTimeout(this.cutSpaceAllowCheckTimeOut.bind(this,this.userActionData.addPositionX,this.userActionData.addPositionY,n,d),this.DEMO_WAIT_TIME))),i.preventDefault()}else clearTimeout(this.limberGridTouchStartCheckTimeOutVariable),this.$limberGridView[0].removeEventListener("touchmove",this.onLimberGridTouchMoveBindedFunctionVariable),document.removeEventListener("touchend",this.onLimberGridTouchEndBindedFunctionVariable),document.removeEventListener("touchcancel",this.onLimberGridTouchCancelBindedFunctionVariable),document.removeEventListener("contextmenu",this.onLimberGridTouchContextMenuBindedFunctionVariable),this.initializeItemTouchEvents();i.stopPropagation()},i.prototype.onLimberGridMouseUp=function(i){clearTimeout(this.addItemAllowCheckTimeOutVariable),clearTimeout(this.limberGridMouseDownCheckTimeOutVariable);var e=!1;if(1==this.limberGridMouseDownTimerComplete)if("ADD"==this.ADD_OR_CUTSPACE_TOGGLE){if(this.addItemAllowCheck(this.userActionData.addPositionX,this.userActionData.addPositionY,this.userActionData.newWidth,this.userActionData.newHeight)){var t={x:this.userActionData.addPositionX,y:this.userActionData.addPositionY,width:this.userActionData.newWidth,height:this.userActionData.newHeight},s=this.$limberGridView[0].scrollTop,r=this.addItemsAtPositions([t],!1,"addItemInteractive");e=!0,this.$limberGridView[0].scrollTop=s}}else"CUTSPACE"==this.ADD_OR_CUTSPACE_TOGGLE&&this.cutSpaceAllowCheck(this.userActionData.addPositionX,this.userActionData.addPositionY,this.userActionData.newWidth,this.userActionData.newHeight)&&this.shiftItemsUp(this.userActionData.addPositionY,this.userActionData.newHeight);else this.limberGridMouseDownCancel=!0;this.onLimberGridContextMenu(),i.stopPropagation(),void 0!=this.callbacks.addCompleteCallback&&null!=this.callbacks.addCompleteCallback&&1==e&&this.callbacks.addCompleteCallback(r.items,t.width,t.height,"addItemInteractive")},i.prototype.onLimberGridTouchEnd=function(i){clearTimeout(this.addItemAllowCheckTimeOutVariable),clearTimeout(this.limberGridTouchStartCheckTimeOutVariable);var e=!1;if(1==this.limberGridTouchStartTimerComplete)if("ADD"==this.ADD_OR_CUTSPACE_TOGGLE){if(this.addItemAllowCheck(this.userActionData.addPositionX,this.userActionData.addPositionY,this.userActionData.newWidth,this.userActionData.newHeight)){var t={x:this.userActionData.addPositionX,y:this.userActionData.addPositionY,width:this.userActionData.newWidth,height:this.userActionData.newHeight},s=this.$limberGridView[0].scrollTop,r=this.addItemsAtPositions([t],!1,"addItemInteractive");e=!0,this.$limberGridView[0].scrollTop=s,this.limberGridTouchStartTimerComplete=!1}}else"CUTSPACE"==this.ADD_OR_CUTSPACE_TOGGLE&&this.cutSpaceAllowCheck(this.userActionData.addPositionX,this.userActionData.addPositionY,this.userActionData.newWidth,this.userActionData.newHeight)&&this.shiftItemsUp(this.userActionData.addPositionY,this.userActionData.newHeight);else this.limberGridTouchStartCancel=!0;this.limberGridTouchStartTimerComplete=!1,this.onLimberGridContextMenu(),this.initializeItemTouchEvents(),i.stopPropagation(),void 0!=this.callbacks.addCompleteCallback&&null!=this.callbacks.addCompleteCallback&&1==e&&this.callbacks.addCompleteCallback(r.items,t.width,t.height,"addItemInteractive")},i.prototype.onLimberGridTouchCancel=function(i){clearTimeout(this.addItemAllowCheckTimeOutVariable),clearTimeout(this.limberGridTouchStartCheckTimeOutVariable),this.limberGridTouchStartCancel=!1,this.limberGridTouchStartTimerComplete=!1,this.onLimberGridContextMenu(),this.initializeItemTouchEvents(),i.stopPropagation()},i.prototype.onLimberGridTouchContextMenu=function(i){i.preventDefault()},i.prototype.onLimberGridContextMenu=function(i){void 0!=i&&(i.preventDefault(),i.stopPropagation()),this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideActive","limberGridViewAddItemGuideCutMode","limberGridViewAddItemGuideAddAllow","limberGridViewAddItemGuideAddDisallow"),this.$limberGridViewHeightAdjustGuide[0].classList.remove("limberGridViewHeightAdjustGuideActive"),this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$body[0].classList.remove("limberGridViewBodyTagStateElementDraggingOrResizing","limberGridViewBodyTagStateElementAdding");for(var e=this.$limberGridViewItems.length,t=0;t<e;t++)this.$limberGridViewItems[t].classList.remove("limberGridViewItemResizingState");for(e=this.$limberGridViewGridPseudoItems.length,t=0;t<e;t++)this.$limberGridViewGridPseudoItems[t].classList.remove("limberGridViewGridPseudoItemResizingState");this.$limberGridViewAddItemOnTouchHoldGuide[0].classList.remove("limberGridViewAddItemOnTouchHoldGuideActive"),this.$limberGridView[0].removeEventListener("mousemove",this.onLimberGridMouseMoveBindedFunctionVariable),document.removeEventListener("mouseup",this.onLimberGridMouseUpBindedFunctionVariable),document.removeEventListener("contextmenu",this.onLimberGridContextMenuBindedFunctionVariable),this.$limberGridView[0].removeEventListener("touchmove",this.onLimberGridTouchMoveBindedFunctionVariable),document.removeEventListener("touchend",this.onLimberGridTouchEndBindedFunctionVariable),document.removeEventListener("touchcancel",this.onLimberGridTouchCancelBindedFunctionVariable),document.removeEventListener("contextmenu",this.onLimberGridTouchContextMenuBindedFunctionVariable)},i.prototype.addItemAllowCheckTimeOut=function(i,e,t,s){0==this.addItemAllowCheck(i,e,t,s)?(this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideAddAllow"),this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideAddDisallow")):(this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideAddDisallow"),this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideAddAllow"))},i.prototype.addItemAllowCheck=function(i,e,t,s){var r={x:i,y:e,width:t,height:s};if(i<0||e<0)return!1;if("number"!=typeof t||"number"!=typeof s)return!1;if(i+t>this.WIDTH)return!1;if(t<50||s<50)return!1;for(var o=this.positionData.length,n=0;n<o;n++){var d={x:this.positionData[n].x-this.getMarginAtPoint(this.positionData[n].x),y:this.positionData[n].y-this.getMarginAtPoint(this.positionData[n].y),width:this.positionData[n].width+this.getMarginAtPoint(this.positionData[n].x)+this.MARGIN,height:this.positionData[n].height+this.getMarginAtPoint(this.positionData[n].y)+this.MARGIN};if(this.isPlaneBInsidePlaneA_TouchingIsInside(d,r))return!1}return!0},i.prototype.cutSpaceAllowCheckTimeOut=function(i,e,t,s){0==this.cutSpaceAllowCheck(i,e,t,s)?(this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideAddAllow"),this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideAddDisallow")):(this.$limberGridViewAddItemGuide[0].classList.remove("limberGridViewAddItemGuideAddDisallow"),this.$limberGridViewAddItemGuide[0].classList.add("limberGridViewAddItemGuideAddAllow"))},i.prototype.cutSpaceAllowCheck=function(i,e,t,s){var r={x:0,y:e-this.MARGIN/2,width:this.WIDTH,height:s+this.MARGIN/2};if("number"!=typeof t||"number"!=typeof s)return!1;for(var o=this.positionData.length,n=0;n<o;n++){if(this.isPlaneBInsidePlaneA_TouchingIsInside(r,this.positionData[n]))return!1}return!0},i.prototype.insertAddItemOnTouchHoldGuideStyles=function(i,e){var t=[];t[0]="@keyframes limberGridViewAddItemOnTouchHoldRipple {",t[1]="0% {",t[2]="transform: translate("+(i-5)+"px, "+(e-5)+"px) scale(0, 0);",t[3]="opacity: 1;",t[4]="}",t[5]="20% {",t[6]="transform: translate("+(i-5)+"px, "+(e-5)+"px) scale(25, 25);",t[7]="opacity: 1;",t[8]="}",t[9]="100% {",t[10]="transform: translate("+(i-5)+"px, "+(e-5)+"px) scale(50, 50);",t[11]="opacity: 0;",t[12]="}",t[13]="}";var s=t.join("");this.$limberGridViewStyle[0].innerHTML=s},i.prototype.onItemMouseDown=function(i){if(1==i.which&&i.target.classList.contains("limberGridViewItem")){i.stopPropagation();var e=Math.sqrt(Math.pow(0-i.offsetX,2)+Math.pow(0-i.offsetY,2)),t=i.currentTarget.offsetWidth-this.RESIZE_SQUARE_GUIDE_LENGTH,s=i.currentTarget.offsetHeight-this.RESIZE_SQUARE_GUIDE_LENGTH,r=this.RESIZE_SQUARE_GUIDE_LENGTH+this.RESIZE_SQUARE_BORDER_GUIDE_WIDTH,o=this.RESIZE_SQUARE_GUIDE_LENGTH+this.RESIZE_SQUARE_BORDER_GUIDE_WIDTH;if(e<=this.MOVE_GUIDE_RADIUS)this.userActionData={type:"move",itemIndex:i.currentTarget.attributes["data-index"].value},this.mouseDownCancel=!1,this.mouseDownTimerComplete=!1,document.addEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),document.addEventListener("mouseup",this.onMouseUpBindedFunctionVariable),document.addEventListener("contextmenu",this.onContextMenuBindedFunctionVariable),clearTimeout(this.longPressCheck),this.longPressCheck=setTimeout(this.mouseDownCheck.bind(this,i),this.MOUSE_DOWN_TIME),i.preventDefault();else if(i.offsetX>=t&&i.offsetX<=t+r&&i.offsetY>=s&&i.offsetY<=s+o){this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$limberGridViewHeightAdjustGuide[0].classList.add("limberGridViewHeightAdjustGuideActive"),this.userActionData={type:"resize",itemIndex:i.currentTarget.attributes["data-index"].value},this.mouseDownCancel=!1,this.mouseDownTimerComplete=!0,this.$limberGridView[0].addEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),document.addEventListener("mouseup",this.onMouseUpBindedFunctionVariable),document.addEventListener("contextmenu",this.onContextMenuBindedFunctionVariable);var n=this.$limberGridViewItems[this.userActionData.itemIndex].style.transform,d=n.indexOf("px"),a=n.indexOf(","),h=Number(n.substring(10,d)),l=Number(n.substring(a+2,n.length-3));this.userActionData.itemPositionX=h,this.userActionData.itemPositionY=l,this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.width=this.positionData[this.userActionData.itemIndex].width+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.height=this.positionData[this.userActionData.itemIndex].height+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.transform="translate("+h+"px, "+l+"px)",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.add("limberGridViewGridPseudoItemActive"),this.$body[0].classList.add("limberGridViewBodyTagStateElementDraggingOrResizing");for(var m=this.$limberGridViewItems.length,u=0;u<m;u++)this.$limberGridViewItems[u].classList.add("limberGridViewItemResizingState");for(m=this.$limberGridViewGridPseudoItems.length,u=0;u<m;u++)this.$limberGridViewGridPseudoItems[u].classList.add("limberGridViewGridPseudoItemResizingState");this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemResizeAllow","limberGridViewGridPseudoItemResizeDisallow"),i.preventDefault()}}},i.prototype.onItemTouchStart=function(i){if(0==i.which&&i.target.classList.contains("limberGridViewItem")&&(i.stopPropagation(),!(i.touches.length>1))){var e=this.calculateTouchPosOnLimberGridItem(i);if(0!=e){var t=Math.sqrt(Math.pow(0-e.x,2)+Math.pow(0-e.y,2)),s=i.currentTarget.offsetWidth-this.RESIZE_SQUARE_GUIDE_LENGTH,r=i.currentTarget.offsetHeight-this.RESIZE_SQUARE_GUIDE_LENGTH,o=this.RESIZE_SQUARE_GUIDE_LENGTH+this.RESIZE_SQUARE_BORDER_GUIDE_WIDTH,n=this.RESIZE_SQUARE_GUIDE_LENGTH+this.RESIZE_SQUARE_BORDER_GUIDE_WIDTH;if(t<=this.MOVE_GUIDE_RADIUS)this.userActionData={type:"move",itemIndex:i.currentTarget.attributes["data-index"].value},this.tapHoldCancel=!1,this.tapHoldTimerComplete=!1,document.addEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),document.addEventListener("touchend",this.onTouchEndBindedFunctionVariable),this.$limberGridView[0].removeEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable),document.addEventListener("contextmenu",this.onItemTouchContextMenuBindedFunctionVariable),document.addEventListener("touchcancel",this.onTouchCancelBindedFunctionVariable),this.longTouchCheck=setTimeout(this.tapHoldCheck.bind(this,i),this.TOUCH_HOLD_TIME),i.preventDefault();else if(e.x>=s&&e.x<=s+o&&e.y>=r&&e.y<=r+n){this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$limberGridViewHeightAdjustGuide[0].classList.add("limberGridViewHeightAdjustGuideActive"),this.userActionData={type:"resize",itemIndex:i.currentTarget.attributes["data-index"].value},this.tapHoldCancel=!1,this.tapHoldTimerComplete=!0,this.$limberGridView[0].addEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),document.addEventListener("touchend",this.onTouchEndBindedFunctionVariable),this.$limberGridView[0].removeEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable),document.addEventListener("touchcancel",this.onTouchCancelBindedFunctionVariable);var d=this.$limberGridViewItems[this.userActionData.itemIndex].style.transform,a=d.indexOf("px"),h=d.indexOf(","),l=Number(d.substring(10,a)),m=Number(d.substring(h+2,d.length-3));this.userActionData.itemPositionX=l,this.userActionData.itemPositionY=m,this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.width=this.positionData[this.userActionData.itemIndex].width+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.height=this.positionData[this.userActionData.itemIndex].height+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.transform="translate("+l+"px, "+m+"px)",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.add("limberGridViewGridPseudoItemActive"),this.$body[0].classList.add("limberGridViewBodyTagStateElementDraggingOrResizing");for(var u=this.$limberGridViewItems.length,c=0;c<u;c++)this.$limberGridViewItems[c].classList.add("limberGridViewItemResizingState");for(u=this.$limberGridViewGridPseudoItems.length,c=0;c<u;c++)this.$limberGridViewGridPseudoItems[c].classList.add("limberGridViewGridPseudoItemResizingState");this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemResizeAllow","limberGridViewGridPseudoItemResizeDisallow"),i.preventDefault()}i.stopPropagation()}}},i.prototype.mouseDownCheck=function(i){0==this.mouseDownCancel?(this.mouseDownTimerComplete=!0,console.log("mouseDownTimerComplete"),this.$body[0].classList.add("limberGridViewBodyTagStateElementDraggingOrResizing"),this.$limberGridViewItems[this.userActionData.itemIndex].classList.add("limberGridViewItemDemo"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.add("limberGridViewBodyPseudoItemActive"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate("+i.pageX+"px, "+i.pageY+"px)",this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$limberGridViewHeightAdjustGuide[0].classList.add("limberGridViewHeightAdjustGuideActive")):console.log("mouseDown cancel before TimerComplete")},i.prototype.tapHoldCheck=function(i){0==this.tapHoldCancel&&(this.tapHoldTimerComplete=!0,this.$body[0].classList.add("limberGridViewBodyTagStateElementDraggingOrResizing"),this.$limberGridViewItems[this.userActionData.itemIndex].classList.add("limberGridViewItemDemo"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.add("limberGridViewBodyPseudoItemActive"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate("+i.touches[0].pageX+"px, "+i.touches[0].pageY+"px)",this.$limberGridViewHeightAdjustGuide[0].style.height="0px",this.$limberGridViewHeightAdjustGuide[0].classList.add("limberGridViewHeightAdjustGuideActive"))},i.prototype.onMouseMove=function(i){if(1==this.mouseDownTimerComplete)if("move"==this.userActionData.type){this.$limberGridViewMoveGuide[0].classList.contains("limberGridViewMoveGuideActive")&&this.$limberGridViewMoveGuide[0].classList.remove("limberGridViewMoveGuideActive"),(this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewBodyPseudoItemMoveAllow")||this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewBodyPseudoItemMoveDisallow"))&&this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewBodyPseudoItemMoveAllow","limberGridViewBodyPseudoItemMoveDisallow"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate("+i.pageX+"px, "+i.pageY+"px)";var e=this.calculateMousePosOnLimberGrid(i);if(0!=e){var t=this.$limberGridView[0].scrollTop,s=(this.$limberGridView[0].scrollHeight,e.y);this.adjustHeight(s)}clearTimeout(this.showMoveDemoTimeOutVariable),this.showMoveDemoTimeOutVariable=setTimeout(this.showMoveDemo.bind(this,this.userActionData.itemIndex,e),this.DEMO_WAIT_TIME)}else{t=this.$limberGridView[0].scrollTop;var r=this.$limberGridView[0].scrollLeft,o=this.userActionData.itemPositionX,n=this.userActionData.itemPositionY,d=i.offsetX-o+r-this.PADDING_LEFT,a=i.offsetY-n+t-this.PADDING_TOP;this.userActionData.newWidth=d,this.userActionData.newHeight=a;s=i.offsetY+t;this.adjustHeight(s),d>0&&a>0&&(this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.width=d+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.height=a+"px"),(this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewGridPseudoItemResizeAllow")||this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewGridPseudoItemResizeDisallow"))&&this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemResizeAllow","limberGridViewGridPseudoItemResizeDisallow"),clearTimeout(this.showResizeDemoTimeOutVariable),this.showResizeDemoTimeOutVariable=setTimeout(this.showResizeDemo.bind(this,this.userActionData.itemIndex,d,a),this.DEMO_WAIT_TIME)}else this.mouseDownCancel=!0,clearTimeout(this.longPressCheck),document.removeEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),this.$limberGridView[0].removeEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),document.removeEventListener("mouseup",this.onMouseUpBindedFunctionVariable),document.removeEventListener("contextmenu",this.onContextMenuBindedFunctionVariable);i.preventDefault(),i.stopPropagation()},i.prototype.onTouchMove=function(i){if(1==this.tapHoldTimerComplete)if("move"==this.userActionData.type){if(this.$limberGridViewMoveGuide[0].classList.contains("limberGridViewMoveGuideActive")&&this.$limberGridViewMoveGuide[0].classList.remove("limberGridViewMoveGuideActive"),(this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewBodyPseudoItemMoveAllow")||this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewBodyPseudoItemMoveDisallow"))&&this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewBodyPseudoItemMoveAllow","limberGridViewBodyPseudoItemMoveDisallow"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate("+i.touches[0].pageX+"px, "+i.touches[0].pageY+"px)",0!=(a=this.calculateTouchPosOnLimberGrid(i))){var e=this.$limberGridView[0].scrollTop,t=this.$limberGridView[0].scrollLeft,s=this.$limberGridView[0].getBoundingClientRect(),r=(this.$limberGridView[0].offsetWidth,s.left,this.$limberGridView[0].offsetHeight-s.top),o=(a.x,this.PADDING_LEFT,a.y+this.PADDING_TOP-e),n=a.y;this.adjustHeight(n);var d=this.adjustScroll(o,r)}clearTimeout(this.showMoveDemoTimeOutVariable),1!=d&&(this.showMoveDemoTimeOutVariable=setTimeout(this.showMoveDemo.bind(this,this.userActionData.itemIndex,a),this.DEMO_WAIT_TIME))}else{e=this.$limberGridView[0].scrollTop,t=this.$limberGridView[0].scrollLeft;var a,h=this.userActionData.itemPositionX,l=this.userActionData.itemPositionY;if(0!=(a=this.calculateTouchPosOnLimberGrid(i))){var m=a.x-h,u=a.y-l;this.userActionData.newWidth=m,this.userActionData.newHeight=u,m>0&&u>0&&(this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.width=m+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.height=u+"px"),(this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewGridPseudoItemResizeAllow")||this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.contains("limberGridViewGridPseudoItemResizeDisallow"))&&this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemResizeAllow","limberGridViewGridPseudoItemResizeDisallow")}if(0!=a){s=this.$limberGridView[0].getBoundingClientRect(),this.$limberGridView[0].offsetWidth,s.left,r=this.$limberGridView[0].offsetHeight-s.top,a.x,this.PADDING_LEFT,o=a.y+this.PADDING_TOP-e,n=a.y;this.adjustHeight(n);d=this.adjustScroll(o,r)}clearTimeout(this.showResizeDemoTimeOutVariable),1!=d&&(this.showResizeDemoTimeOutVariable=setTimeout(this.showResizeDemo.bind(this,this.userActionData.itemIndex,m,u),this.DEMO_WAIT_TIME))}else this.tapHoldCancel=!0,clearTimeout(this.longTouchCheck),document.removeEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),this.$limberGridView[0].removeEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),document.removeEventListener("touchend",this.onTouchEndBindedFunctionVariable),document.removeEventListener("contextmenu",this.onContextMenuBindedFunctionVariable),document.removeEventListener("contextmenu",this.onItemTouchContextMenuBindedFunctionVariable),document.removeEventListener("touchcancel",this.onTouchCancelBindedFunctionVariable),this.$limberGridView[0].addEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable);i.stopPropagation()},i.prototype.onMouseUp=function(i){clearTimeout(this.showMoveDemoTimeOutVariable),clearTimeout(this.showResizeDemoTimeOutVariable);var e=!1,t=!1;if(1==this.mouseDownTimerComplete)if("move"==this.userActionData.type){this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewBodyPseudoItemActive"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate(0px, 0px)";var s=this.calculateMousePosOnLimberGrid(i);if(0!=s){var r=this.checkNewMoveCoordinates(this.userActionData.itemIndex,s);if(0!=r){var o={};r.hasOwnProperty("revisedCoordinates")?(this.movePlane(this.userActionData.itemIndex,r.revisedCoordinates.x,r.revisedCoordinates.y),o.x=r.revisedCoordinates.x,o.y=r.revisedCoordinates.y,t=!0):(this.movePlane(this.userActionData.itemIndex,r.x,r.y),o.x=r.x,o.y=r.y,t=!0)}else this.revertShowMoveOrResizeDemo()}else this.revertShowMoveOrResizeDemo()}else{this.$limberGridView[0].scrollTop,this.$limberGridView[0].scrollLeft,this.userActionData.itemPositionX,this.userActionData.itemPositionY;var n=this.userActionData.newWidth,d=this.userActionData.newHeight;n>0&&d>0&&(this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.width=n+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.height=d+"px"),0==this.resizePlane(this.userActionData.itemIndex,n,d)&&(this.revertShowMoveOrResizeDemo(),e=!0),this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.transform="translate(0px, 0px)",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemActive")}else this.mouseDownCancel=!0,clearTimeout(this.longPressCheck);document.removeEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),this.$limberGridView[0].removeEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),document.removeEventListener("mouseup",this.onMouseUpBindedFunctionVariable),document.removeEventListener("contextmenu",this.onContextMenuBindedFunctionVariable),this.$body[0].classList.remove("limberGridViewBodyTagStateElementDraggingOrResizing"),this.$limberGridViewMoveGuide[0].classList.remove("limberGridViewMoveGuideActive"),this.$limberGridViewHeightAdjustGuide[0].classList.remove("limberGridViewHeightAdjustGuideActive"),i.preventDefault(),i.stopPropagation(),void 0!=this.callbacks.moveCompleteCallback&&null!=this.callbacks.moveCompleteCallback&&(1==t?(o.width=this.positionData[this.userActionData.itemIndex].width,o.height=this.positionData[this.userActionData.itemIndex].height,this.callbacks.moveCompleteCallback(!0,this.userActionData.itemIndex,o)):"move"==this.userActionData.type&&this.callbacks.moveCompleteCallback(!1,this.userActionData.itemIndex,i)),void 0!=this.callbacks.resizeCompleteCallback&&null!=this.callbacks.resizeCompleteCallback&&1==e&&this.callbacks.resizeCompleteCallback(this.userActionData.itemIndex,{x:this.positionData[this.userActionData.itemIndex].x,y:this.positionData[this.userActionData.itemIndex].y,height:d,width:n}),this.userActionData=null},i.prototype.onTouchEnd=function(i){clearTimeout(this.showMoveDemoTimeOutVariable),clearTimeout(this.showResizeDemoTimeOutVariable);var e=!1,t=!1;if(1==this.tapHoldTimerComplete)if("move"==this.userActionData.type){this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewBodyPseudoItemActive"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate(0px, 0px)";var s=this.calculateTouchPosOnLimberGrid(i);if(0!=s){var r=this.checkNewMoveCoordinates(this.userActionData.itemIndex,s);if(0!=r){var o={};r.hasOwnProperty("revisedCoordinates")?(this.movePlane(this.userActionData.itemIndex,r.revisedCoordinates.x,r.revisedCoordinates.y),o.x=r.revisedCoordinates.x,o.y=r.revisedCoordinates.y,t=!0):(this.movePlane(this.userActionData.itemIndex,r.x,r.y),o.x=r.x,o.y=r.y,t=!0)}else this.revertShowMoveOrResizeDemo()}else this.revertShowMoveOrResizeDemo()}else{this.$limberGridView[0].scrollTop,this.$limberGridView[0].scrollLeft,this.userActionData.itemPositionX,this.userActionData.itemPositionY;var n=this.userActionData.newWidth,d=this.userActionData.newHeight;n>0&&d>0&&(this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.width=n+"px",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.height=d+"px"),0==this.resizePlane(this.userActionData.itemIndex,n,d)&&(this.revertShowMoveOrResizeDemo(),e=!0),this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].style.transform="translate(0px, 0px)",this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemActive")}else this.tapHoldCancel=!0,clearTimeout(this.longTouchCheck);document.removeEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),this.$limberGridView[0].removeEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),document.removeEventListener("touchend",this.onTouchEndBindedFunctionVariable),document.removeEventListener("contextmenu",this.onContextMenuBindedFunctionVariable),document.removeEventListener("contextmenu",this.onItemTouchContextMenuBindedFunctionVariable),document.removeEventListener("touchcancel",this.onTouchCancelBindedFunctionVariable),this.$limberGridView[0].addEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable),this.$body[0].classList.remove("limberGridViewBodyTagStateElementDraggingOrResizing"),this.$limberGridViewMoveGuide[0].classList.remove("limberGridViewMoveGuideActive"),this.$limberGridViewHeightAdjustGuide[0].classList.remove("limberGridViewHeightAdjustGuideActive"),i.stopPropagation(),void 0!=this.callbacks.moveCompleteCallback&&null!=this.callbacks.moveCompleteCallback&&(1==t?(o.width=this.positionData[this.userActionData.itemIndex].width,o.height=this.positionData[this.userActionData.itemIndex].height,this.callbacks.moveCompleteCallback(!0,this.userActionData.itemIndex,o)):"move"==this.userActionData.type&&this.callbacks.moveCompleteCallback(!1,this.userActionData.itemIndex,i)),void 0!=this.callbacks.resizeCompleteCallback&&null!=this.callbacks.resizeCompleteCallback&&1==e&&this.callbacks.resizeCompleteCallback(this.userActionData.itemIndex,{x:this.positionData[this.userActionData.itemIndex].x,y:this.positionData[this.userActionData.itemIndex].y,height:d,width:n}),this.userActionData=null},i.prototype.onContextMenu=function(i){clearTimeout(this.showMoveDemoTimeOutVariable),clearTimeout(this.showResizeDemoTimeOutVariable),this.revertShowMoveOrResizeDemo(),this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewGridPseudoItemActive"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].classList.remove("limberGridViewBodyPseudoItemActive"),this.$limberGridViewBodyPseudoItems[this.userActionData.itemIndex].style.transform="translate(0px, 0px)",document.removeEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),this.$limberGridView[0].removeEventListener("mousemove",this.onMouseMoveBindedFunctionVariable),document.removeEventListener("mouseup",this.onMouseUpBindedFunctionVariable),document.removeEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),this.$limberGridView[0].removeEventListener("touchmove",this.onTouchMoveBindedFunctionVariable),document.removeEventListener("touchend",this.onTouchEndBindedFunctionVariable),document.removeEventListener("contextmenu",this.onItemTouchContextMenuBindedFunctionVariable),document.removeEventListener("touchcancel",this.onTouchCancelBindedFunctionVariable),document.removeEventListener("contextmenu",this.onContextMenuBindedFunctionVariable),this.$body[0].classList.remove("limberGridViewBodyTagStateElementDraggingOrResizing"),this.$limberGridViewMoveGuide[0].classList.remove("limberGridViewMoveGuideActive"),this.$limberGridViewHeightAdjustGuide[0].classList.remove("limberGridViewHeightAdjustGuideActive"),this.userActionData=null,i.preventDefault(),i.stopPropagation()},i.prototype.onItemTouchContextMenu=function(i){i.preventDefault()},i.prototype.onTouchCancel=function(i){this.onContextMenu(),this.tapHoldTimerComplete=!1,this.$limberGridView[0].addEventListener("touchstart",this.onLimberGridTouchStartFunctionVariable)},i.prototype.calculateMousePosOnLimberGrid=function(i){var e=this.$limberGridView[0].getBoundingClientRect();if(i.clientX>=e.left&&i.clientX<=e.left+e.width&&i.clientY>=e.top&&i.clientY<=e.top+e.height){var t=this.$limberGridView[0].scrollTop,s=this.$limberGridView[0].scrollLeft,r=i.clientX-e.left-this.PADDING_LEFT+s,o=i.clientY-e.top-this.PADDING_TOP+t;return!(r<0||o<0)&&{x:r,y:o}}return!1},i.prototype.calculateTouchPosOnLimberGrid=function(i){var e=this.$limberGridView[0].getBoundingClientRect();if("touchend"==i.type)var t={clientX:i.changedTouches[0].clientX,clientY:i.changedTouches[0].clientY};else t={clientX:i.touches[0].clientX,clientY:i.touches[0].clientY};if(t.clientX>=e.left&&t.clientX<=e.left+e.width&&t.clientY>=e.top&&t.clientY<=e.top+e.height){var s=this.$limberGridView[0].scrollTop,r=this.$limberGridView[0].scrollLeft,o=t.clientX-e.left-this.PADDING_LEFT+r,n=t.clientY-e.top-this.PADDING_TOP+s;return!(o<0||n<0)&&{x:o,y:n}}return!1},i.prototype.calculateTouchPosOnLimberGridItem=function(i){var e=this.$limberGridViewItems[i.currentTarget.attributes["data-index"].value].getBoundingClientRect();return i.touches[0].clientX>=e.left&&i.touches[0].clientX<=e.left+e.width&&i.touches[0].clientY>=e.top&&i.touches[0].clientY<=e.top+e.height&&{x:i.touches[0].clientX-e.left,y:i.touches[0].clientY-e.top}},i.prototype.checkNewMoveCoordinates=function(i,e){if(0==e)return!1;for(var t=e.x,s=e.y,r=this.positionData[i].width,o=this.positionData[i].height,n=null,d=this.positionData.length,a=0;a<d;a++){var h=[this.positionData[a].x,this.positionData[a].y],l=[this.positionData[a].x+this.positionData[a].width,this.positionData[a].y],m=[this.positionData[a].x,this.positionData[a].y+this.positionData[a].height],u=[this.positionData[a].x+this.positionData[a].width,this.positionData[a].y+this.positionData[a].height];if(t>=h[0]&&t<=l[0]&&t>=m[0]&&t<=u[0]&&s>=h[1]&&s<=m[1]&&s>=l[1]&&s<=u[1]){!0,n=a;break}var c=this.getLines(this.positionData[a]),p=c[0],b=c[1],G=c[2],w=c[3];if(s<p[0][1]&&t>=p[0][0]-this.MARGIN&&t<=p[1][0]+this.MARGIN)if(p[0][1]-s<=this.MARGIN)return!1;if(s>G[0][1]&&t>=G[0][0]-this.MARGIN&&t<=G[1][0]+this.MARGIN)if(s-G[0][1]<=this.MARGIN)return!1;if(t>b[0][0]&&s>=b[0][1]-this.MARGIN&&s<=b[1][1]+this.MARGIN)if(t-b[0][0]<=this.MARGIN)return!1;if(t<w[0][0]&&s>=w[0][1]-this.MARGIN&&s<=w[1][1]+this.MARGIN)if(w[0][0]-t<=this.MARGIN)return!1;if(s>G[0][1]&&t+r>=G[0][0]-this.MARGIN&&t+r<=G[1][0]+this.MARGIN)if(s-G[0][1]<=this.MARGIN)return!1;if(t>b[0][0]&&s+o>=b[0][1]-this.MARGIN&&s+o<=b[1][1]+this.MARGIN)if(t-b[0][0]<=this.MARGIN)return!1;if(s>G[0][1]&&G[0][0]>=t&&G[0][0]<=t+r||s>G[0][1]&&G[1][0]>=t&&G[1][0]<=t+r)if(s-G[0][1]<=this.MARGIN)return!1;if(t>b[0][0]&&b[0][1]>=s&&b[0][1]<=s+o||t>b[0][0]&&b[1][1]>=s&&b[1][1]<=s+o)if(t-b[0][0]<=this.MARGIN)return!1}return null==n?!(t+this.positionData[i].width+this.getMarginAtPoint(t)>this.WIDTH)&&e:!(this.positionData[n].x+this.positionData[i].width+this.getMarginAtPoint(this.positionData[n].x)>this.WIDTH)&&{x:t,y:s,revisedCoordinates:{x:this.positionData[n].x,y:this.positionData[n].y}}},i.prototype.showMoveDemo=function(i,e){if(0!=e){var t=this.checkNewMoveCoordinates(i,e);0==t?(this.$limberGridViewBodyPseudoItems[i].classList.remove("limberGridViewBodyPseudoItemMoveAllow"),this.$limberGridViewBodyPseudoItems[i].classList.add("limberGridViewBodyPseudoItemMoveDisallow")):(t.hasOwnProperty("revisedCoordinates")?(this.movePlaneDemo(i,t.revisedCoordinates.x,t.revisedCoordinates.y),this.$limberGridViewMoveGuide[0].style.transform="translate("+t.revisedCoordinates.x+"px, "+t.revisedCoordinates.y+"px)",this.$limberGridViewMoveGuide[0].classList.add("limberGridViewMoveGuideActive")):(this.movePlaneDemo(i,t.x,t.y),this.$limberGridViewMoveGuide[0].style.transform="translate("+t.x+"px, "+t.y+"px)",this.$limberGridViewMoveGuide[0].classList.add("limberGridViewMoveGuideActive")),this.$limberGridViewBodyPseudoItems[i].classList.remove("limberGridViewBodyPseudoItemMoveDisallow"),this.$limberGridViewBodyPseudoItems[i].classList.add("limberGridViewBodyPseudoItemMoveAllow"))}else this.$limberGridViewBodyPseudoItems[i].classList.remove("limberGridViewBodyPseudoItemMoveAllow"),this.$limberGridViewBodyPseudoItems[i].classList.add("limberGridViewBodyPseudoItemMoveDisallow")},i.prototype.showResizeDemo=function(i,e,t){0==this.resizePlaneDemo(i,e,t)?this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.add("limberGridViewGridPseudoItemResizeDisallow"):this.$limberGridViewGridPseudoItems[this.userActionData.itemIndex].classList.add("limberGridViewGridPseudoItemResizeAllow")},i.prototype.revertShowMoveOrResizeDemo=function(){for(var i=this.$limberGridViewItems.length,e=0;e<i;e++)this.$limberGridViewItems[e].style.transform="translate("+this.positionData[e].x+"px, "+this.positionData[e].y+"px)",this.$limberGridViewItems[e].classList.remove("limberGridViewItemDemo","limberGridViewItemResizingState"),this.$limberGridViewGridPseudoItems[e].classList.remove("limberGridViewGridPseudoItemResizingState","limberGridViewGridPseudoItemActive")},i.prototype.adjustHeight=function(i){this.$limberGridView[0].scrollHeight-i<=this.AUTO_SCROLL_POINT&&(this.$limberGridViewHeightAdjustGuide[0].style.height=i+this.MOVE_OR_RESIZE_HEIGHT_INCREMENTS+"px")},i.prototype.adjustScroll=function(i,e){var t=this.$limberGridView[0].scrollTop,s=!1;return i>0&&(e-i<this.AUTO_SCROLL_POINT&&(this.$limberGridView[0].scrollTop=t+this.AUTO_SCROLL_DISTANCE,s=!0),i<this.HEIGHT/10&&0!=t&&(this.$limberGridView[0].scrollTop=t-this.AUTO_SCROLL_DISTANCE,s=!0)),s},i.prototype.getPlainFrom4Points=function(i){for(var e=-1,t=-1,s=-1,r=-1,o=i.length,n=0;n<o;n++)(i[n][0]<e||e<0)&&(e=i[n][0]),i[n][0]>s&&(s=i[n][0]),(i[n][1]<t||t<0)&&(t=i[n][1]),i[n][1]>r&&(r=i[n][1]);var d={};return d.x=e,d.y=t,d.width=s-e,d.height=r-t,d},i.prototype.getCoordinates=function(i){var e=[i.x,i.y],t=[i.x+i.width,i.y],s=[i.x,i.y+i.height];return[e,t,[i.x+i.width,i.y+i.height],s]},i.prototype.getLines=function(i){var e=JSON.parse(JSON.stringify([i.x,i.y])),t=JSON.parse(JSON.stringify([i.x+i.width,i.y])),s=JSON.parse(JSON.stringify([i.x,i.y+i.height])),r=JSON.parse(JSON.stringify([i.x+i.width,i.y+i.height]));return[[e,t],[t,r],[s,r],[e,s]]},i.prototype.arePlainsSame=function(i,e){return i.x==e.x&&i.y==e.y&&i.width==e.width&&i.height==e.height},i.prototype.arePlainsIdentical=function(i,e){return i.width==e.width&&i.height==e.height},i.prototype.isValidPlane=function(i){return i.x>=0&&i.y>=0&&i.width>0&&i.height>0},i.prototype.sortPlainsByArea=function(i,e="dec"){return"asc"==e?i.sort(function(i,e){return(i.x+i.width)*(i.y+i.height)-(e.x+e.width)*(e.y+e.height)}):i.sort(function(i,e){return(e.x+e.width)*(e.y+e.height)-(i.x+i.width)*(i.y+i.height)}),i},i.prototype.sortPlainsByHeight=function(i,e="dec"){return"asc"==e?i.sort(function(i,e){return i.height-e.height}):i.sort(function(i,e){return e.height-i.height}),i},i.prototype.sortPlainsByDepth=function(i,e="dec"){return"asc"==e?i.sort(function(i,e){return i.y+i.height-(e.y+e.height)}):i.sort(function(i,e){return e.y+e.height-(i.y+i.height)}),i},i.prototype.divideEqualNumber=function(i,e=0){return NaN==i/i?0:1},i.prototype.getMarginAtPoint=function(i){return 0==i?0:this.MARGIN},i.prototype.getRowSequence=function(i){for(var e={},t=[],s=this.positionData.length,r=0;r<s;r++)e.hasOwnProperty(this.positionData[r].y)?e[this.positionData[r].y].push(r):(e[this.positionData[r].y]=[],t.push(Number(this.positionData[r].y)),e[this.positionData[r].y].push(r));t.sort(function(i,e){return i-e});for(s=t.length,r=0;r<s;r++)e[t[r]].sort(function(i,e){return this.positionData[i].x-this.positionData[e].x}.bind(this));if(1!=i)return{rowOrder:t,rows:e};var o=[],n={},d=0;for(s=t.length,r=0;r<s;r++)for(var a=e[t[r]].length,h=0;h<a;h++)o.push(e[t[r]][h]),n[e[t[r]][h]]=d++;return{list:o,map:n}},i}()}]);