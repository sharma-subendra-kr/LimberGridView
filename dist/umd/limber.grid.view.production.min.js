/** @license LimberGridView
 *
 * LimberGridView, a powerful JavaScript Libary that gives you movable, resizable(any size) and auto-arranging grids.
 *
 * Copyright Â© 2018-2020 Subendra Kumar Sharma. All Rights reserved. (jobs.sharma.subendra.kr@gmail.com)
 *
 * This file is part of LimberGridView.
 *
 * LimberGridView is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * LimberGridView is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with LimberGridView.  If not, see <https://www.gnu.org/licenses/>.
 *
 * Written by Subendra Kumar Sharma.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Stack"),require("RTreeJS"),require("UndoRedo"),require("ResizeObserver")):"function"==typeof define&&define.amd?define(["Stack","RTreeJS","UndoRedo","ResizeObserver"],t):"object"==typeof exports?exports.LimberGridView=t(require("Stack"),require("RTreeJS"),require("UndoRedo"),require("ResizeObserver")):e.LimberGridView=t(e.Stack,e.RTreeJS,e.UndoRedo,e.ResizeObserver)}(window,(function(e,t,i,o){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(o,s,function(t){return e[t]}.bind(null,s));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="assets",i(i.s=6)}([function(t,i){t.exports=e},function(e,i){e.exports=t},function(e,t){e.exports=i},function(e,t){e.exports=o},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var o=i(1),s=i(0),r=i(2),n=i.n(r);i(4),i(5);const l=function(e){return e.store.constants.privateConstants},a=function(e,t){e.store.constants.privateConstants.WIDTH=t},d=function(e){return e.store.constants.privateConstants.WIDTH},c=function(e,t){e.store.constants.privateConstants.HEIGHT=t},u=function(e,t){e.store.constants.privateConstants.WIDTH_SCALE_FACTOR=t},m=function(e,t){e.store.constants.privateConstants.MARGIN=t},h=function(e,t){e.store.constants.privateConstants.DEFINED_MIN_HEIGHT_AND_WIDTH=t},b=function(e){return e.store.constants.privateConstants.DEFINED_MIN_HEIGHT_AND_WIDTH};var I=l;const w=function(e){return e.store.constants.publicConstants},v=function(e,t,i){e.store.constants.publicConstants.hasOwnProperty(t)&&(e.store.constants.publicConstants[t]=i)};var p=w;const y=function(e,t){e.store.variables.elements.$el=t},g=function(e){return e.store.variables.elements.$limberGridView},T=function(e){return e.store.variables.elements.$limberGridViewIOTopHelper},f=function(e){return e.store.variables.elements.$limberGridViewIOBottomHelper};var A=function(e){return e.store.variables.elements};const D=function(e,t,i,o){if(function(e,t){const i=A(e),o=p(e),s=i.$limberGridView.scrollHeight;s-t<o.AUTO_SCROLL_POINT&&(i.$limberGridViewHeightAdjustGuide.style.height=s+o.MOVE_OR_RESIZE_HEIGHT_INCREMENTS+"px")}(e,t),o)return function(e,t){const i=A(e),o=p(e),s=I(e),r=i.$limberGridView.scrollTop;let n=!1;return s.HEIGHT-t<o.AUTO_SCROLL_POINT?(i.$limberGridView.scrollTop=r+o.AUTO_SCROLL_DISTANCE,n=!0):t<o.AUTO_SCROLL_POINT&&(i.$limberGridView.scrollTop=r-o.AUTO_SCROLL_DISTANCE,n=!0),n}(e,i)},x=function(e,t){const i=t.length,o=new Array(i);for(let e=0;e<i;e++)o[e]={...t[e]};e.store.variables.essentials.positionData=o},G=function(e){return e.store.variables.essentials.positionData},E=function(e,t){const i=t.length,o=new Array(i);for(let e=0;e<i;e++)o[e]={...t[e]};e.store.variables.essentials.modifiedPositionData=o},_=function(e){return e.store.variables.essentials.modifiedPositionData},C=function(e,t){const i=t.length,o=new Array(i);for(let e=0;e<i;e++)o[e]={...t[e]},o[e].index=e;o.sort((e,t)=>e.y===t.y?e.x-t.x:e.y-t.y),e.store.variables.essentials.serializedPositionData=o},R=function(e){return e.store.variables.essentials.serializedPositionData},H=function(e){return e.store.variables.essentials.callbacks},M=function(e,t){e.store.variables.essentials.limberGridViewBoundingClientRect=t},$=function(e){return e.store.variables.essentials.limberGridViewBoundingClientRect},N=function(e,t){e.store.variables.essentials.renderedItems=[...t]},O=function(e){return e.store.variables.essentials.renderedItems},V=function(e,t){e.store.variables.essentials.ioTopHelperPos=t},L=function(e){return e.store.variables.essentials.ioTopHelperPos},S=function(e,t){e.store.variables.essentials.ioBottomHelperPos=t},P=function(e){return e.store.variables.essentials.ioBottomHelperPos};const W=function(e,t){const i=A(e),o=I(e),s=$(e);if(t.clientX>=s.left&&t.clientX<=s.left+s.width&&t.clientY>=s.top&&t.clientY<=s.top+s.height){const e=i.$limberGridView.scrollTop,r=i.$limberGridView.scrollLeft,n=t.clientX-s.left-o.PADDING_LEFT+r,l=t.clientY-s.top-o.PADDING_TOP+e;if(n<0||l<0)return;return{x:n,y:l,offsetX:n-r,offsetY:l-e}}},Y=function(e,t){const i=A(e),o=I(e),s=$(e);let r;if(r="touchend"===t.type?{clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY}:{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY},r.clientX>=s.left&&r.clientX<=s.left+s.width&&r.clientY>=s.top&&r.clientY<=s.top+s.height){const e=i.$limberGridView.scrollTop,t=i.$limberGridView.scrollLeft,n=r.clientX-s.left-o.PADDING_LEFT+t,l=r.clientY-s.top-o.PADDING_TOP+e;if(n<0||l<0)return;return{x:n,y:l,offsetX:n-t,offsetY:l-e}}},X=function(e,t){const i=A(e).$limberGridViewItems[t.currentTarget.attributes["data-index"].value].getBoundingClientRect();if(t.touches[0].clientX>=i.left&&t.touches[0].clientX<=i.left+i.width&&t.touches[0].clientY>=i.top&&t.touches[0].clientY<=i.top+i.height){return{x:t.touches[0].clientX-i.left,y:t.touches[0].clientY-i.top}}},k=function(e){return e.options};var U=k;const z=(e,t)=>{const i=p(e),o=U(e),s=G(e),r=parseInt(t.currentTarget.attributes["data-index"].value);let n,l,a,d;if(t.touches){if(!t.touches)return!1;if(l=X(e,t),!l)return!1;n=Math.sqrt(Math.pow(0-l.x,2)+Math.pow(0-l.y,2)),a=l.x,d=l.y}else n=Math.sqrt(Math.pow(0-t.offsetX,2)+Math.pow(0-t.offsetY,2)),a=t.offsetX,d=t.offsetY;const c=t.currentTarget.offsetWidth-i.RESIZE_SQUARE_GUIDE_LENGTH,u=t.currentTarget.offsetHeight-i.RESIZE_SQUARE_GUIDE_LENGTH,m=i.RESIZE_SQUARE_GUIDE_LENGTH+i.RESIZE_SQUARE_GUIDE_BORDER_WIDTH,h=i.RESIZE_SQUARE_GUIDE_LENGTH+i.RESIZE_SQUARE_GUIDE_BORDER_WIDTH,b=-i.RESIZE_SQUARE_GUIDE_BORDER_WIDTH,I=t.currentTarget.offsetHeight-i.RESIZE_SQUARE_GUIDE_LENGTH,w=i.RESIZE_SQUARE_GUIDE_LENGTH,v=i.RESIZE_SQUARE_GUIDE_LENGTH+i.RESIZE_SQUARE_GUIDE_BORDER_WIDTH;return o.itemMouseDownMoveCheck&&o.itemMouseDownMoveCheck(a,d,{...s[r]},r,t.target)||n<=i.MOVE_GUIDE_RADIUS&&!o.itemMouseDownMoveCheck?{type:"move",itemIndex:t.currentTarget.attributes["data-index"].value}:o.itemMouseDownResizeCheck&&o.itemMouseDownResizeCheck(a,d,{...s[r]},r,t.target,"bottomRight")?{type:"resize",itemIndex:t.currentTarget.attributes["data-index"].value}:o.itemMouseDownResizeCheck&&o.itemMouseDownResizeCheck(a,d,{...s[r]},r,t.target,"bottomLeft")?{type:"resizeBottomLeft",itemIndex:t.currentTarget.attributes["data-index"].value}:a>=c&&a<=c+m&&d>=u&&d<=u+h&&!o.itemMouseDownResizeCheck?{type:"resize",itemIndex:t.currentTarget.attributes["data-index"].value}:a>=b&&a<=w&&d>=I&&d<=I+v&&!o.itemMouseDownResizeCheck?{type:"resizeBottomLeft",itemIndex:t.currentTarget.attributes["data-index"].value}:void 0},j=(e,t)=>{const i=A(e),o=G(e)[t.itemIndex];i.$limberGridViewHeightAdjustGuide.style.height="0px",i.$limberGridViewHeightAdjustGuide.classList.add("limber-grid-view-height-adjust-guide-active"),i.$limberGridViewPseudoItem.style.width=o.width+"px",i.$limberGridViewPseudoItem.style.height=o.height+"px",i.$limberGridViewPseudoItem.setAttribute("data-after","w: 0px, h: 0px"),i.$limberGridViewPseudoItem.style.transform=`translate(${t.itemX}px,${t.itemY}px)`,i.$limberGridViewPseudoItem.classList.add("limber-grid-view-pseudo-item-active"),i.$limberGridViewPseudoItem.classList.remove("limber-grid-view-pseudo-item-resize-allow","limber-grid-view-pseudo-item-resize-disallow"),i.$body.classList.add("limber-grid-view-body-tag-state-editing");const s=i.$limberGridViewItems.length;for(let e=0;e<s;e++)i.$limberGridViewItems[e]&&i.$limberGridViewItems[e].classList.add("limber-grid-view-item-resizing-state");i.$limberGridViewPseudoItem.classList.add("limber-grid-view-pseudo-item-resizing-state")},F=(e,t,i)=>{const o=A(e),s=G(e)[t.itemIndex];o.$limberGridViewHeightAdjustGuide.style.height="0px",o.$limberGridViewHeightAdjustGuide.classList.add("limber-grid-view-height-adjust-guide-active"),o.$limberGridViewItems[t.itemIndex]&&o.$limberGridViewItems[t.itemIndex].classList.add("limber-grid-view-item-demo"),o.$pseudoContainerItem.classList.add("limber-grid-view-pseudo-container-item-active"),o.$pseudoContainerItem.style.width=s.width+"px",o.$pseudoContainerItem.style.height=s.height+"px",i.touches?i.touches&&(o.$pseudoContainerItem.style.transform=`translate(${i.touches[0].pageX}px, ${i.touches[0].pageY}px)`):o.$pseudoContainerItem.style.transform=`translate(${i.pageX}px, ${i.pageY}px)`,o.$body.classList.add("limber-grid-view-body-tag-state-editing")},B=(e,t,i,o)=>{const s=A(e);"move"===o?(s.$limberGridViewMoveGuide.classList.remove("limber-grid-view-move-guide-active"),s.$pseudoContainerItem.classList.remove("limber-grid-view-pseudo-container-item-move-allow","limber-grid-view-pseudo-container-item-move-disallow"),i.touches?i.touches&&(s.$pseudoContainerItem.style.transform=`translate(${i.touches[0].pageX}px, ${i.touches[0].pageY}px)`):s.$pseudoContainerItem.style.transform=`translate(${i.pageX}px, ${i.pageY}px)`):"resize"===o&&s.$limberGridViewPseudoItem.classList.remove("limber-grid-view-pseudo-item-resize-allow","limber-grid-view-pseudo-item-resize-disallow")},Z=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),K=(e,t,i,o)=>(i-e)*(i-e)+(o-t)*(o-t),q=function(e,t){const i=e.options.isMobileCheck;return i?i(t||$(e)):(t=t||$(e)).width<980||window.innerHeight>window.innerWidth&&t.width<981},Q=(e,t=6)=>Math.trunc(e*Math.pow(10,t))/Math.pow(10,t),J=(e=22)=>{const t=new Array(e);for(let i=0;i<e;i++)t[i]="0123456789abcdefghijklmnopqrstuvwxyz"[Math.floor(36*Math.random())];return t.join("")},ee=e=>{e.x1=e.x,e.x2=e.x+e.width,e.y1=e.y,e.y2=e.y+e.height},te=e=>{const t=e%1,i=Math.trunc(e);return t<=.25?i:t<=.5?i+.25:t<=.75?i+.5:t<=.9999999999999999?i+.75:i-.25},ie=e=>{const t=e%1,i=Math.trunc(e);return t<=.25?i+.25:t<=.5?i+.5:t<=.75?i+.75:t<=.9999999999999999?i+1:i+.25},oe=e=>{e.x1=ie(e.x1),e.y1=ie(e.y1),e.x2=te(e.x2),e.y2=te(e.y2),e.x=ie(e.x),e.y=ie(e.y),e.width=te(e.width),e.height=te(e.height)},se=(e,t)=>!(e.mX1>=t.mX2||t.mX1>=e.mX2||e.mY1>=t.mY2||t.mY1>=e.mY2),re=(e,t)=>!(isNaN(e.x1)||isNaN(e.x2)||isNaN(t.mX1)||isNaN(t.mX2))&&!(e.x1>=t.mX2||t.mX1>=e.x2||e.y1>=t.mY2||t.mY1>=e.y2),ne=(e,t)=>!(isNaN(e.x1)||isNaN(e.x2)||isNaN(t.mX1)||isNaN(t.mX2))&&!(e.x1>t.mX2||t.mX1>e.x2||e.y1>t.mY2||t.mY1>e.y2),le=(e,t)=>{if(e.x1<=t.mX1&&e.x2>=t.mX2&&e.y1<=t.mY1&&e.y2>=t.mY2)return!0},ae=(e,t)=>{if(t.x>=e.mX1&&t.x<=e.mX2&&t.y>=e.mY1&&t.y<=e.mY2)return!0},de=e=>{const t=e.x1,i=e.x2,o=e.y1,s=e.y2;e.x1=e.mX1,e.x2=e.mX2,e.y1=e.mY1,e.y2=e.mY2,e.mX1=t,e.mX2=i,e.mY1=o,e.mY2=s},ce=function(e){return!(isNaN(e.x)||isNaN(e.y)||isNaN(e.width)||isNaN(e.height))&&!(e.x>=e.x+e.width||e.y>=e.y+e.height)},ue=function(e,t){const i={};for(const[o]of e.entries())e[o].x1===t[o].x1&&e[o].x2===t[o].x2&&e[o].y1===t[o].y1&&e[o].y2===t[o].y2||(i[o]=!0);return i},me=(e,t,i=!1,o)=>{const s=G(e),r=s.length,n=new Array(r);let l,a=0;for(let e=0;e<r;e++)l=s[e],o&&o[e]||re(t,l)&&(n[a++]=i?e:s[e]);return n.length=a,n},he=(e,t,i)=>{const o=G(e),s=_(e),r=o.length,n=new Array(r);let l=0;for(let e=0;e<r;e++)se(t,o[e])&&e!==i&&(n[l++]=e,s[e].x1=void 0,s[e].y1=void 0,s[e].x2=void 0,s[e].y2=void 0,s[e].mX1=void 0,s[e].mY1=void 0,s[e].mX2=void 0,s[e].mY2=void 0,s[e].x=void 0,s[e].y=void 0,s[e].mX=void 0,s[e].mY=void 0);return n[l++]=i,n.length=l,n},be=(e,t,i)=>{const o=G(e),s=_(e),r=o.length,n=new Array(r);let l=0;for(let e=0;e<r;e++)se(t,o[e])&&e!==i&&(n[l++]=e,s[e].x1=void 0,s[e].y1=void 0,s[e].x2=void 0,s[e].y2=void 0,s[e].mX1=void 0,s[e].mY1=void 0,s[e].mX2=void 0,s[e].mY2=void 0,s[e].x=void 0,s[e].y=void 0,s[e].mX=void 0,s[e].mY=void 0);return n[l++]=i,n.length=l,n},Ie=(e,t,i,o,s,r)=>{const n=G(e),l=I(e);if(t<0||t>=n.length)throw"Index out of bounds.";if("number"!=typeof i||"number"!=typeof o)throw"x or y is not a number.";if(i<l.MARGIN||o<l.MARGIN)throw"Left edges falls outside the grid area.";if("number"!=typeof s||"number"!=typeof r)throw"Width or Height is not a number.";if(i+s+l.MARGIN>l.WIDTH)throw"Right edges falls outside the grid area.";if(s<l.DEFINED_MIN_HEIGHT_AND_WIDTH||r<l.DEFINED_MIN_HEIGHT_AND_WIDTH)throw`Width or height less than min height or width ${l.DEFINED_MIN_HEIGHT_AND_WIDTH}.`;if(r+2*l.MARGIN>l.HEIGHT)throw"Height cannot be greater than height of container.";return!0},we=(e,t,i,o)=>{const s=G(e),r=I(e);if(t<0||t>=s.length)throw"Index out of bounds.";if("number"!=typeof i||"number"!=typeof o)throw"toX or toY is not a number.";if(i<r.MARGIN||o<r.MARGIN)throw"Left edges falls outside the grid area.";if(i+s[t].width+r.MARGIN>r.WIDTH)throw"Right edges falls outside the grid area.";return!0},ve=(e,t,i,o,s)=>({x:e,y:t,width:i,height:o,mX:e-s,mY:t-s,mWidth:i+2*s,mHeight:o+2*s,x1:e,y1:t,x2:e+i,y2:t+o,mX1:e-s,mY1:t-s,mX2:e+i+s,mY2:t+o+s}),pe=(e,t,i,o)=>({x:e,y:t,width:i.width,height:i.height,mX:e-o,mY:t-o,mWidth:i.width+2*o,mHeight:i.height+2*o,x1:e,y1:t,x2:e+i.width,y2:t+i.height,mX1:e-o,mY1:t-o,mX2:e+i.width+o,mY2:t+i.height+o}),ye=e=>{const t=G(e),i=A(e),o=t.length;for(let e=0;e<o;e++)i.$limberGridViewItems[e]&&(i.$limberGridViewItems[e].style.transform=`translate(${t[e].x1}px, ${t[e].y1}px)`,i.$limberGridViewItems[e].style.width=t[e].width+"px",i.$limberGridViewItems[e].style.height=t[e].height+"px")},ge=(e,t,i,o)=>{const s=G(e),r=I(e),n=1.5*r.DEFINED_MIN_HEIGHT_AND_WIDTH,l=s.length,a={x:t,y:i};let d,c,u,m,h,b,w,v,p,y,g,T=Number.MAX_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER,A=Number.MAX_SAFE_INTEGER,D=!1;for(let e=0;e<l;e++)ae(s[e],a)&&(d=e,t=s[d].x,i=s[d].y),e!==o&&(c={x:s[e].mX1,y:s[e].mY1},u={x:s[e].mX2,y:s[e].mY1},m={x:s[e].mX1,y:s[e].mY2},h=Z(c,a),b=Z(u,a),w=Z(m,a),h<T&&h<f&&h<A&&a.x<c.x&&h<=n&&c.x-r.MARGIN-s[o].width>=r.MARGIN&&(v=c.x-r.MARGIN-s[o].width,p=c.y+r.MARGIN,T=h,D=!0,y=e,g="left"),b<f&&b<T&&b<A&&a.x>u.x&&b<=n&&u.x+r.MARGIN+s[o].width<r.WIDTH&&(v=u.x+r.MARGIN,p=u.y+r.MARGIN,f=b,D=!0,y=e,g="right"),w<A&&w<T&&w<f&&a.y>=m.y&&a.x>=m.x&&w<=n&&c.x+r.MARGIN+s[o].width<r.WIDTH&&(v=c.x+r.MARGIN,p=m.y+r.MARGIN,A=w,D=!0,y=e,g="bottom"));return{to:{toX:t,toY:i},toAdj:{toX:v,toY:p},overlappedItemIndex:d,isToAdjPresent:D,toAdjIndex:y,toAdjDirection:g}},Te=(e,t)=>{const i=A(e);for(const e in t)if(i.$limberGridViewItems[e]){const o=t[e];i.$limberGridViewItems[e].style.transform=`translate(${o.x}px, ${o.y}px)`,i.$limberGridViewItems[e].style.width=o.width+"px",i.$limberGridViewItems[e].style.height=o.height+"px"}},fe=(e,t)=>{if(t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2)return!0},Ae=(e,t)=>!(isNaN(e.x1)||isNaN(e.y1)||isNaN(e.x2)||isNaN(e.y2)||isNaN(t.x1)||isNaN(t.y1)||isNaN(t.x2)||isNaN(t.y2))&&!(e.x1>=t.x2||t.x1>=e.x2||e.y1>=t.y2||t.y1>=e.y2),De=(e,t)=>{if(!Ae(e,t))return[];const i={subRectT:{x1:e.x1,x2:e.x2,y1:e.y1,y2:t.y1},subRectR:{x1:t.x2,x2:e.x2,y1:e.y1,y2:e.y2},subRectB:{x1:e.x1,x2:e.x2,y1:t.y2,y2:e.y2},subRectL:{x1:e.x1,x2:t.x1,y1:e.y1,y2:e.y2}};for(const e in i)Ee(i[e])||(i[e]=void 0);let o,s,r,n,l,a,d,c,u,m,h,b,I,w,v,p;i.subRectT&&i.subRectR&&(u={x1:i.subRectT.x1,x2:i.subRectR.x1,y1:i.subRectT.y1,y2:i.subRectT.y2},r={x1:i.subRectR.x1,x2:i.subRectR.x2,y1:i.subRectR.y1,y2:i.subRectT.y2},b={x1:i.subRectR.x1,x2:i.subRectR.x2,y1:i.subRectT.y2,y2:i.subRectR.y2}),i.subRectR&&i.subRectB&&(h={x1:i.subRectR.x1,x2:i.subRectR.x2,y1:i.subRectR.y1,y2:i.subRectB.y1},l={x1:i.subRectR.x1,x2:i.subRectR.x2,y1:i.subRectB.y1,y2:i.subRectR.y2},w={x1:i.subRectB.x1,x2:i.subRectR.x1,y1:i.subRectB.y1,y2:i.subRectR.y2}),i.subRectB&&i.subRectL&&(p={x1:i.subRectL.x1,x2:i.subRectL.x2,y1:i.subRectL.y1,y2:i.subRectB.y1},d={x1:i.subRectB.x1,x2:i.subRectL.x2,y1:i.subRectB.y1,y2:i.subRectL.y2},I={x1:i.subRectL.x2,x2:i.subRectB.x2,y1:i.subRectB.y1,y2:i.subRectB.y2}),i.subRectL&&i.subRectT&&(v={x1:i.subRectL.x1,x2:i.subRectL.x2,y1:i.subRectT.y2,y2:i.subRectL.y2},o={x1:i.subRectL.x1,x2:i.subRectL.x2,y1:i.subRectL.y1,y2:i.subRectT.y2},m={x1:i.subRectL.x2,x2:i.subRectT.x2,y1:i.subRectT.y1,y2:i.subRectT.y2}),s=xe(u,o)||xe(m,r)||u||m,n=Ge(h,r)||Ge(b,l)||h||b,a=xe(I,l)||xe(w,d)||I||w,c=Ge(v,d)||Ge(p,o)||v||p;let y=[o,s,r,n,l,a,d,c];if(y=y.filter(e=>e),0===y.length)for(const e in i)i[e]&&y.push(i[e]);return y},xe=(e,t)=>{if(!e||!t)return;let i;return e.x1===t.x1?i={x1:t.x2,x2:e.x2,y1:e.y1,y2:e.y2}:e.x2===t.x2&&(i={x1:e.x1,x2:t.x1,y1:e.y1,y2:e.y2}),i},Ge=(e,t)=>{if(!e||!t)return;let i;return e.y1===t.y1?i={x1:e.x1,x2:e.x2,y1:t.y2,y2:e.y2}:e.y2===t.y2&&(i={x1:e.x1,x2:e.x2,y1:e.y1,y2:t.y1}),i},Ee=function(e){return!(e.x1>=e.x2||e.y1>=e.y2)},_e=(e,t)=>{const i=new Array(2);let o=0;const s=e.x1<t.x1?e:t,r=e.x2>t.x2?e:t,n=e.y1>t.y1?e:t,l=e.y2<t.y2?e:t,a={x1:s.x1,x2:r.x2,y1:n.y1,y2:l.y2},d=e.x1>t.x1?e:t,c=e.x2<t.x2?e:t,u=e.y1<t.y1?e:t,m=e.y2>t.y2?e:t,h={x1:d.x1,x2:c.x2,y1:u.y1,y2:m.y2};return!Ee(a)||Ce(e,a)||Ce(t,a)||(i[o++]=a),!Ee(h)||Ce(e,h)||Ce(t,h)||(i[o++]=h),i.length=o,i},Ce=(e,t)=>{if(e.x1<=t.x1&&e.x2>=t.x2&&e.y1<=t.y1&&e.y2>=t.y2)return!0},Re=(e,t,i,o)=>{const s={x1:i,x2:o,y1:0,y2:t.y1<0?0:t.y1},r=((e,t,i)=>{const o=G(e);let s,r=0;const n=o.length;for(let e=0;e<n;e++)s=o[e],o[e].y2>r&&s.mX<i&&s.mX2>t&&(r=o[e].y2);return r})(e,i,o);return{topWorkSpace:s,bottomWorkSpace:{x1:i,x2:o,y1:t.y2,y2:r>t.y2?r:t.y2}}},He=(e,t,i=!1,o)=>{const s=_(e),r=s.length,n=new Array(r);let l,a=0;for(let e=0;e<r;e++)l=s[e],o&&o[e]||re(t,l)&&(n[a++]=i?e:s[e]);return n.length=a,n},Me=(e,t)=>e.x1===t.x1?e.y1-t.y1:e.x1-t.x1,$e=(e,t)=>e.y1===t.y1?e.x1-t.x1:e.y1-t.y1,Ne=function(e,t){if(Ce(e,t)&&e!==t)return!0},Oe=(e,t,i,o,s)=>{if(t.mWidth*t.mWidth+t.mHeight*t.mHeight<K(e.x1,e.y1,e.x2,e.y2)&&e.x2-e.x1>=t.mWidth&&e.y2-e.y1>=t.mHeight)return!0;if(!s)return;const r=s;let n={width:0,height:0},l={width:0,height:0};const a=t.mWidth;if((100*a-100*(e.x2-e.x1))/a<=r){const o=(e.x2-e.x1)/t.mWidth,s=t.mHeight*o;s<=e.y2-e.y1&&(n={width:e.x2-e.x1-2*i,height:s-2*i})}const d=t.mHeight;if((100*d-100*(e.y2-e.y1))/d<=r){const o=(e.y2-e.y1)/t.mHeight*t.mWidth;o<=e.x2-e.x1&&(l={width:o-2*i,height:e.y2-e.y1-2*i})}(n.width<o||n.height<o)&&(n.width=0,n.height=0),(l.width<o||l.height<o)&&(l.width=0,l.height=0);return n.width*n.width+n.height*n.height<l.width*l.width+l.height*l.height&&0!==n.width?n.width>0?n:void 0:l.width>0?l:void 0},Ve=(e,t,i)=>{const o=_(e),s=t.length;for(let e=0;e<s;e++)o[t[e]].y+=i,o[t[e]].mY+=i,o[t[e]].y1+=i,o[t[e]].y2+=i,o[t[e]].mY1+=i,o[t[e]].mY2+=i},Le=function(e,t,i){const o=G(e),s=A(e),r=o.length;for(let e=0;e<r;e++)o[e].y>=t&&(o[e].y-=i,o[e].mY-=i,o[e].y1-=i,o[e].y2-=i,o[e].mY1-=i,o[e].mY2-=i,s.$limberGridViewItems[e]&&(s.$limberGridViewItems[e].style.transform="translate("+o[e].x1+"px, "+o[e].y1+"px)"))},Se=function(e,t,i,o,s){const r=I(e),n=G(e);var l={x1:t-r.MARGIN,y1:i-r.MARGIN,x2:t+o+r.MARGIN,y2:i+s+r.MARGIN};if(t<0||i<0)return!1;if("number"!=typeof o||"number"!=typeof s)return!1;if(t+o>r.WIDTH)return!1;if(o<50||s<50)return!1;let a;const d=n.length;for(let e=0;e<d;e++)if(a=ne(l,n[e]),a)return!1;return!0},Pe=function(e,t,i,o,s){const r=I(e),n=G(e),l={x1:0,y1:i,x2:r.WIDTH,y2:i+s};if("number"!=typeof o||"number"!=typeof s)return!1;let a=l.y2,d=l.y1;const c=n.length;for(let e=0;e<c;e++){if(le(l,n[e])||n[e].mY1<l.y1&&n[e].mY2>l.y2)return!1;if(!ne(l,n[e]))continue;const t={x:n[e].mX1,y:n[e].mY1},i={x:n[e].mX2,y:n[e].mY2};n[e].mY1<a&&fe(l,t)&&(a=n[e].mY1),n[e].mY2>d&&fe(l,i)&&(d=n[e].mY2)}return a-d>0&&{y:d,shiftHeight:a-d}};var We=function(e,t){return e.store.variables.trees[t]};var Ye=function(e,t){return e.store.variables.stacks[t]};const Xe=(e,t,i)=>{let o,s;const r=We(e,"rt");if(t){o=He(e,t);const i=ke(e,t,o,r);t.y1=i}if(i){s=He(e,i);const t=Ue(e,i,s,r);i.y2=t}},ke=(e,t,i,o)=>{o.reset();const s=i.length;for(let e=0;e<s;e++)o.insert(i[e]);let r=t.y2;const n=d(e),l=b(e);let a=0;const c={x1:0,x2:0,y1:t.y1,y2:t.y2};let u;for(;a<n;){c.x1=a,c.x2=a+l,u=o.find(c,!1,!0,void 0,!1);const e=u.length;let t=-1;for(let i=0;i<e;i++)u[i].mY2>t&&(t=u[i].mY2);-1!==t&&t<r&&(r=t),a=c.x2}return r},Ue=(e,t,i,o)=>{o.reset();const s=i.length;for(let e=0;e<s;e++)o.insert(i[e]);let r=t.y1;const n=d(e),l=b(e);let a=0;const c={x1:0,x2:0,y1:t.y1,y2:t.y2};let u;for(;a<n;){c.x1=a,c.x2=a+l,u=o.find(c,!1,!0,void 0,!1);const e=u.length;let t=Number.MAX_SAFE_INTEGER;for(let i=0;i<e;i++)u[i].mY1<t&&(t=u[i].mY1);t!==Number.MAX_SAFE_INTEGER&&t>r&&(r=t),a=c.x2}return r},ze=(e,t,i,o)=>{const s=We(e,"rt");let r,n;s.reset(),t.id=o.idCount++,s.insert(t);let l,a=0,d=0;const c=i.length;for(let e=0;e<c;e++){r=i[e],n=s.find(r,!1,!0,void 0,!1),a=n.length;for(let e=0;e<a;e++){de(r),l=De(n[e],r),de(r),s.remove(n[e]),d=l.length;for(let e=0;e<d;e++)l[e].id=o.idCount++,s.insert(l[e])}}return{rt:s}},je=(e,t,i,o)=>{let s=!1;for(;!t.isEmpty();){const e=t.pop();s=!1;const r=i.find(e,!1,!0,void 0,!0),n=(null==r?void 0:r.length)||0;if(n>0){for(let t=0;t<n;t++){const n=r[t],l=_e(n,e);if(1===l.length){const t=l[0];t.id=o.idCount++,Ce(t,n)&&i.remove(n),Ce(t,e)&&(s=!0),i.insert(t)}}!1===s&&(e.id=o.idCount++,i.insert(e))}else e.id=o.idCount++,i.insert(e)}},Fe=e=>{const t=e.getData(),i=t.length;for(let o=0;o<i;o++){const i=t[o];e.find(i,void 0,void 0,Ne,!1)&&e.remove(i)}},Be=async(e,t,i,o)=>{let s;const r=Ye(e,"stack");Array.isArray(t)?(r.setData(t.sort(Me)),s=We(e,"rt"),s.reset()):(r.setData(o.sort(Me)),s=t),je(0,r,s,i),Fe(s);const n=s.getData();return r.setData(n.sort($e)),s.reset(),je(0,r,s,i),Fe(s),{mergedRectsRt:s}},Ze=async(e,t,i,o,s,r,n)=>{const l=_(e),a=G(e),d=I(e),c=p(e),u={},m={},h={};let b,w,v,y=i.getData();t.sort((e=>(t,i)=>K(e[t].x,e[t].y,e[t].x+e[t].width,e[t].y+e[t].height)-K(e[i].x,e[i].y,e[i].x+e[i].width,e[i].y+e[i].height))(a));const g=Ye(e,"garbageStack");let T=t.length;for(;T>0;){let o;b=t[--T],w=l[b],v=a[b];let r,I=Number.MAX_SAFE_INTEGER,p=w;const D=v||{mX1:0,mY1:0,mX2:0,mY2:0},x=y.length;for(let e=0;e<x;e++){const t=y[e],i=(A=D,K((f=t).x1,f.y1,A.mX1,A.mY1)),s=Oe(t,p,d.MARGIN,d.DEFINED_MIN_HEIGHT_AND_WIDTH,c.SHRINK_TO_FIT);s&&i<I&&(I=i,o=y[e],r="object"==typeof s?s:void 0)}if(!o)continue;r&&(w.width=r.width,w.height=r.height,h[b]=!0),w.x=o.x1+d.MARGIN,w.y=o.y1+d.MARGIN,w.x1=w.x,w.y1=w.y,w.x2=w.x+w.width,w.y2=w.y+w.height,oe(w),w.mX=w.x-d.MARGIN,w.mY=w.y-d.MARGIN,w.mWidth=w.width+2*d.MARGIN,w.mHeight=w.height+2*d.MARGIN,w.mX1=w.x1-d.MARGIN,w.mY1=w.y1-d.MARGIN,w.mX2=w.x2+d.MARGIN,w.mY2=w.y2+d.MARGIN,u[b]=w,s&&Ce(s,o)&&(m[b]=b),g.empty();const G=i.find(o,!1,!0,void 0,!1),E=G.length;p={...w},p.x1-=d.MARGIN,p.x2+=d.MARGIN,p.y1-=d.MARGIN,p.y2+=d.MARGIN;for(let e=0;e<E;e++){const t=G[e],o=De(t,p),s=(null==o?void 0:o.length)||0;for(let e=0;e<s;e++)o[e].idCount=n.idCount++,g.push(o[e]);i.remove(t)}const{mergedRectsRt:_}=await Be(e,i,n,g.getData());y=(i=_).getData()}var f,A;return{arranged:u,itemsInBottomWorkSpace:m,resized:h}},Ke=async(e,t,i,o)=>{var s;const r=I(e),n=_(e),l=performance.now(),a={idCount:0},{minY:d,maxY:c}=((e,t,i,o,s,r,n)=>{const l=G(e),a=_(e),d=I(e);let c=Number.MAX_SAFE_INTEGER,u=0,m=Number.MAX_SAFE_INTEGER,h=0;const b=t.length;for(let e=0;e<b;e++)l[t[e]].y<c&&(c=l[t[e]].y),l[t[e]].y2>u&&(u=l[t[e]].y2),l[t[e]].x<m&&(m=l[t[e]].x),l[t[e]].x2>h&&(h=l[t[e]].x2);return s>u&&(u=s),o>h&&(h=o),i<m&&(m=i),r<c&&(c=r),n>u&&(u=n),u-c>1.5*d.HEIGHT&&(c=a[t[b-1]].y,u=a[t[b-1]].y2),{minX:m-d.MARGIN,maxX:h+d.MARGIN,minY:c-d.MARGIN,maxY:u+d.MARGIN}})(e,t,void 0,void 0,void 0,i,o),u=new Array(t.length-1),m=t.length-1;for(let e=0;e<m;e++)u[e]=t[e];const h={x1:0,x2:r.WIDTH,y1:d,y2:c},b={...h},{topWorkSpace:w,bottomWorkSpace:v}=Re(e,h,0,r.WIDTH);Xe(e,w,v),b.y1=w.y1,b.y2=v.y2;let p=He(e,b),y=He(e,b,!0);y=(e=>{const t={};for(const i of e)t[i]=!0;return t})(y);let g=He(e,v,!0,y);const T=((e,t,i=!1,o)=>{const s=_(e);if(!t)return[];const r=s.length,n=new Array(r);let l=0;for(let e=0;e<r;e++)o&&o[e]||t.y2<=s[e].mY1&&(n[l++]=i?e:s[e]);return n.length=l,n})(e,v,!0,y),f=(r.DEFINED_MIN_HEIGHT_AND_WIDTH-2*r.MARGIN)/2;let A=0,D={},x=0,E={},C=0;for(;x!==m;){const{rt:t}=ze(e,b,p,a),i=t.getData(),{mergedRectsRt:o}=await Be(e,i,a),{arranged:s,itemsInBottomWorkSpace:r,resized:n}=await Ze(e,u.filter(e=>!D[e]),o,0,v,0,a);g=[...g,...Object.keys(r)],D={...D,...s},E={...E,...n};const l=Object.values(s);if(p=[...p,...l],x+=l.length,x!==m&&(C++,h.y2+=f,v&&(v.y1+=f,v.y2+=f),b.y2+=f,Ve(e,g,f)),A++,A>1e3)throw"Arrange time out"}if(C>0){Ve(e,T,f*C);let t=g.length;for(let e=0;e<t;e++)D[g[e]]=n[g[e]];t=T.length;for(let e=0;e<t;e++)D[T[e]]=n[T[e]]}const R=performance.now();return console.log("p1: ",l),console.log("p2: ",R),console.log("workSpaceResizeCount",C),console.log("arrange total: ",R-l),null!==(s=e.options.callbacks)&&void 0!==s&&s.getArrangeTime&&e.options.callbacks.getArrangeTime(R-l,C,a.idCount),{arranged:D,resized:E}},qe=function(e,t,i){e.store.variables.status[t]=i},Qe=function(e,t){return e.store.variables.status[t]};var Je=function(e,t){return e.store.constants.messages[t]};const et=e=>e.store.variables.bindedFunctions,tt=function(){const e=U(this),t=A(this),i=H(this),o=et(this);if(e.editable){q(this)||e.enableInteractiveAddAndCut&&(t.$limberGridView.addEventListener("mousedown",o.onDeskMouseDown),e.enableTouchInteraction&&t.$limberGridView.addEventListener("touchstart",o.onDeskTouchStart));for(var s=t.$limberGridViewItems.length,r=0;r<s;r++)!q(this)&&t.$limberGridViewItems[r]&&(t.$limberGridViewItems[r].addEventListener("mousedown",o.onItemMouseDown),e.enableTouchInteraction&&t.$limberGridViewItems[r].addEventListener("touchstart",o.onItemTouchStart)),i.onItemClickCallback&&t.$limberGridViewItems[r]&&t.$limberGridViewItems[r].addEventListener("click",o.onItemClick)}},it=function(){const e=U(this),t=A(this),i=et(this);if(e.editable&&(t.$limberGridView&&(t.$limberGridView.removeEventListener("mousedown",i.onDeskMouseDown),t.$limberGridView.removeEventListener("touchstart",i.onDeskTouchStart)),t.$limberGridViewItems)){const e=t.$limberGridViewItems.length;for(let o=0;o<e;o++)t.$limberGridViewItems[o]&&(t.$limberGridViewItems[o].removeEventListener("mousedown",i.onItemMouseDown),t.$limberGridViewItems[o].removeEventListener("touchstart",i.onItemTouchStart),t.$limberGridViewItems[o].removeEventListener("click",i.onItemClick))}},ot=function(){const e=A(this),t=et(this);if(e.$limberGridViewItems){const i=e.$limberGridViewItems.length;for(let o=0;o<i;o++)e.$limberGridViewItems[o]&&(e.$limberGridViewItems[o].addEventListener("mousedown",t.onItemMouseDown),e.$limberGridViewItems[o].addEventListener("touchstart",t.onItemTouchStart))}},st=function(){const e=A(this),t=et(this);if(e.$limberGridViewItems){const i=e.$limberGridViewItems.length;for(let o=0;o<i;o++)e.$limberGridViewItems[o]&&(e.$limberGridViewItems[o].removeEventListener("mousedown",t.onItemMouseDown),e.$limberGridViewItems[o].removeEventListener("touchstart",t.onItemTouchStart))}};var rt=function(e){return e.store.variables.undoRedo};const nt=function(e,t=!0){const i=U(e),o=G(e),s=I(e),r=p(e),n=A(e),l=H(e);it.call(e);const a=o.length;let d=1;t&&(d=s.WIDTH_SCALE_FACTOR);for(let e=0;e<a;e++)o[e].x1*=d,o[e].x2*=d,o[e].y1*=d,o[e].y2*=d,o[e].x=o[e].x1,o[e].y=o[e].y1,o[e].width*=d,o[e].height*=d,oe(o[e]),o[e].mX1=o[e].x1-s.MARGIN,o[e].mX2=o[e].x2+s.MARGIN,o[e].mY1=o[e].y1-s.MARGIN,o[e].mY2=o[e].y2+s.MARGIN,o[e].mX=o[e].x-s.MARGIN,o[e].mY=o[e].y-s.MARGIN,o[e].mWidth=o[e].width+2*s.MARGIN,o[e].mHeight=o[e].height+2*s.MARGIN;rt(e).setCurrent(o);const c=O(e),u=c.length,m=new Array(u),h=new Array(a);let b;if(q(e)){const t="limber-grid-view-item limber-grid-view-item-mobile-view";b=R(e);for(let e=0;e<u;e++){const i=c[e];b[i].width=s.WIDTH,b[i].height=s.WIDTH/r.MOBILE_ASPECT_RATIO;const o=document.createElement("div");o.setAttribute("class",t),o.setAttribute("data-index",b[i].index),o.style.width=b[i].width+"px",o.style.height=b[i].height+"px",m[e]=o,h[i]=o}f(e).style.transform=`translate(0px, ${s.WIDTH/r.MOBILE_ASPECT_RATIO*15+14*s.MARGIN}px)`}else{let e="limber-grid-view-item";!0===i.editable&&(e="limber-grid-view-item limber-grid-view-item-editable "+(r.SHOW_BOTTOM_LEFT_RESIZE_GUIDE?"limber-grid-view-item-editable-left-resize":""));for(let t=0;t<u;t++){const i=c[t],s=document.createElement("div");s.setAttribute("class",e),s.setAttribute("data-index",i),s.style.transform=`translate(${o[i].x}px, ${o[i].y}px)`,s.style.width=o[i].width+"px",s.style.height=o[i].height+"px",m[t]=s,h[i]=s}}const w=n.$limberGridViewItems.length;for(let e=0;e<w;e++)n.$limberGridViewItems[e]&&(n.$limberGridView.removeChild(n.$limberGridViewItems[e]),n.$limberGridViewItems[e]=void 0);for(let e=0;e<u;e++)n.$limberGridView.appendChild(m[e]);for(let t=0;t<u;t++){const i=c[t],s=m[t];if(q(e)){const i=l.renderContent(b[t].index,b[t].width,b[t].height);ut(e,i,s)}else{const t=l.renderContent(i,o[i].width,o[i].height);ut(e,t,s)}}!function(e,t){e.store.variables.elements.$limberGridViewItems=t}(e,h),tt.call(e),l.renderComplete&&l.renderComplete()},lt=function(e,t){const i=A(e),o=H(e),s=G(e),r=I(e),n=p(e);let l;l=q(e)?o.renderContent(t,r.WIDTH,r.WIDTH/n.MOBILE_ASPECT_RATIO):o.renderContent(t,s[t].width,s[t].height),ut(e,l,i.$limberGridViewItems[t]),o.renderComplete&&o.renderComplete(t)},at=function(e,t){it.call(e);const i=H(e),o=A(e);for(const e in t){const t=o.$limberGridViewItems[e];i.removePlugin&&i.removePlugin(o.$limberGridViewItems[e]),t&&t.remove(),o.$limberGridViewItems[e]=void 0}},dt=function(e,t,i=!1){const o=U(e),s=p(e),r=I(e),n=G(e),l=H(e),a=A(e);let d,c="limber-grid-view-item";!0===o.editable&&(c="limber-grid-view-item limber-grid-view-item-editable "+(s.SHOW_BOTTOM_LEFT_RESIZE_GUIDE?"limber-grid-view-item-editable-left-resize":""));const u=t.length,m=new Array(u);if(q(e)){const i="limber-grid-view-item limber-grid-view-item-mobile-view";d=R(e);for(let e=0;e<u;e++){const o=t[e];d[o].width=r.WIDTH,d[o].height=r.WIDTH/s.MOBILE_ASPECT_RATIO;const n=document.createElement("div");n.setAttribute("class",i),n.setAttribute("data-index",d[o].index),n.style.width=d[o].width+"px",n.style.height=d[o].height+"px",m[e]=n,a.$limberGridViewItems[o]=n}}else for(let e=0;e<u;e++){const i=t[e],o=document.createElement("div");o.setAttribute("class",c),o.setAttribute("data-index",i),o.style.transform=`translate(${n[i].x}px, ${n[i].y}px)`,o.style.width=n[i].width+"px",o.style.height=n[i].height+"px",m[e]=o,a.$limberGridViewItems[i]=o}for(let i=0;i<u;i++){const o=t[i],s=m[i];if(q(e)){const t=l.renderContent(d[o].index,d[o].width,d[o].height);ut(e,t,s)}else{const t=l.renderContent(o,n[o].width,n[o].height);ut(e,t,s)}}let h;void 0!==t[0]&&(h=a.$limberGridViewItems[t[0]+1]);for(let e=0;e<u;e++)i?(a.$limberGridView.insertBefore(m[e],h),h=m[e]):a.$limberGridView.appendChild(m[e]);tt.call(e)},ct=async function(e,t){const i=U(e),o=A(e),s=H(e),r=I(e),n=p(e);it.call(e);try{if(t.x&&t.y&&t.width&&t.height){let i=!1;if(i=Se(e,t.x,t.y,t.width,t.height),!i)return!1;{const i=G(e);E(e,i);const o=_(e);o.push(t),x(e,o),C(e,o),rt(e).reset(),rt(e).push(o)}}else{if(!t.width||!t.height||t.x||t.y)return!1;{if(t.width>r.WIDTH)return!1;const i=G(e);E(e,i);const o=_(e),s=(e=>{const t=G(e);let i=I(e).MARGIN;const o=t.length;for(let e=0;e<o;e++)t[e].mY2>i&&(i=t[e].mY2);return i})(e);o.push({x:void 0,y:void 0,width:t.width,height:t.height,mX:void 0,mY:void 0,mWidth:t.width+2*r.MARGIN,mHeight:t.height+2*r.MARGIN,x1:void 0,y1:void 0,x2:void 0,y2:void 0,mX1:void 0,mY1:void 0,mX2:void 0,mY2:void 0}),await(async(e,t,i)=>{var o;const s=I(e),r=performance.now(),n={idCount:0},l=s.WIDTH,a=i,d=i+s.DEFINED_MIN_HEIGHT_AND_WIDTH,c=t.length,u={x1:0,x2:l,y1:a,y2:d},m={...u},{topWorkSpace:h}=Re(e,u,0,s.WIDTH);Xe(e,h),m.y1=h.y1;let b=He(e,m);const w=s.DEFINED_MIN_HEIGHT_AND_WIDTH-2*s.MARGIN-10;let v=0,p={},y=0,g=0;for(;y!==c;){const{rt:i}=ze(e,m,b,n),o=i.getData(),{mergedRectsRt:s}=await Be(e,o,n),{arranged:r}=await Ze(e,t.filter(e=>!p[e]),s,0,void 0,0,n);p={...p,...r};const l=Object.values(r);if(b=[...b,...l],y+=l.length,y!==c&&(g++,u.y2+=w,m.y2+=w),v++,v>1e4)throw"Arrange time out"}const T=performance.now();return console.log("p1: ",r),console.log("p2: ",T),console.log("workSpaceResizeCount",g),console.log("arrange total: ",T-r),null!==(o=e.options.callbacks)&&void 0!==o&&o.getArrangeTime&&e.options.callbacks.getArrangeTime(T-r,g,n.idCount),p})(e,[o.length-1],s),oe(o[o.length-1]),x(e,o),C(e,o),rt(e).reset(),rt(e).push(o)}}const l=G(e),a=l.length-1;let d;const c=document.createElement("div");if(q(e)){const e="limber-grid-view-item limber-grid-view-item-mobile-view";c.setAttribute("class",e),c.setAttribute("data-index",a),c.style.width=r.WIDTH+"px",c.style.height=r.WIDTH/n.MOBILE_ASPECT_RATIO+"px",d=s.renderContent(a,r.WIDTH,r.WIDTH/n.MOBILE_ASPECT_RATIO,"isAdd")}else{let e="limber-grid-view-item";!0===i.editable&&(e="limber-grid-view-item limber-grid-view-item-editable "+(n.SHOW_BOTTOM_LEFT_RESIZE_GUIDE?"limber-grid-view-item-editable-left-resize":"")),c.setAttribute("class",e),c.setAttribute("data-index",a),c.style.transform=`translate(${l[a].x}px, ${l[a].y}px)`,c.style.width=l[a].width+"px",c.style.height=l[a].height+"px",d=s.renderContent(a,l[a].width,l[a].height,"isAdd")}q(e)||(o.$limberGridView.appendChild(c),ut(e,d,c),o.$limberGridViewItems.push(c),O(e).push(a)),q(e)||o.$limberGridView.scrollTo({left:0,top:l[a].y1,behavior:"smooth"}),s.addComplete&&s.addComplete(a)}catch(e){H(this).getLogMessage({type:"error",message:e}),console.error(e)}tt.call(e)},ut=(e,t,i)=>{const o=H(e);"string"==typeof t?i.innerHTML=t:t instanceof Element?(i.innerHTML="",i.appendChild(t)):o.renderPlugin&&o.renderPlugin(t,i)},mt=async function(e,t,i,o,s){const r=G(this),n=A(this),l=H(this),a=p(this),d=I(this);if(e=parseInt(e),a.LATCH_MOVED_ITEM){const e=Qe(this,"resizeDemo");t=(null==e?void 0:e.x)||t,i=(null==e?void 0:e.y)||i,s=(null==e?void 0:e.height)||s,o=(null==e?void 0:e.width)||o}Ie(this,e,t,i,o,s),E(this,r);const c=_(this),u=ve(t,i,o,s,d.MARGIN);c[e]={...u};const m=he(this,u,e);let h,b;({arranged:h,resized:b}=await Ke(this,m,i,i+s)),x(this,c),rt(this).push(c),n.$limberGridViewItems[e]&&(n.$limberGridViewItems[e].style.transform=`translate(${t}px, ${t}px)`,n.$limberGridViewItems[e].style.width=c[e].width+"px",n.$limberGridViewItems[e].style.height=c[e].height+"px"),Te(this,h),l.resizeComplete&&l.resizeComplete(e,o,s,Object.keys(h)),lt(this,e);for(const e in b)lt(this,e)},ht=async function(e,t,i,o,s,r){var n;const l=G(this),a=A(this),d=p(this),c=I(this);let u;e=parseInt(e),d.LATCH_MOVED_ITEM&&(u=((e,t,i,o,s,r,n)=>{const l=G(e),a=I(e),d=a.MIN_HEIGHT_AND_WIDTH/2,c=a.MIN_HEIGHT_AND_WIDTH/10,u=l.length,m={x:t,y:i},h={x:t+o,y:i},b={x:t+o,y:i+s},w={x:t,y:i+s};let v,p,y,g,T,f,A,D,x,E,_,C,R,H,M,$,N=Number.MAX_SAFE_INTEGER,O=Number.MAX_SAFE_INTEGER,V=Number.MAX_SAFE_INTEGER,L=Number.MAX_SAFE_INTEGER,S=!1;for(let e=0;e<u;e++)e!==r&&(v={x:l[e].x1,y:l[e].y1},p={x:l[e].x1,y:l[e].y2},y={x:l[e].x2,y:l[e].y2},g={x:l[e].x2,y:l[e].y1},f=Z(p,b),T=Z(y,w),A=Z(y,h),D=Z(g,b),x=Z(v,w),E=Z(p,m),f<O&&f<N&&b.x<p.x&&Math.abs(b.y-p.y)<=c&&b.x+a.MARGIN<=a.WIDTH&&(s=p.y-h.y,O=f,S=!0,_=e,C="right",H=p),T<N&&T<O&&w.x>y.x&&Math.abs(w.y-y.y)<=c&&b.x+a.MARGIN<=a.WIDTH&&(s=y.y-m.y,N=T,S=!0,_=e,C="left",H=y),A<V&&A<L&&A<=d&&Math.abs(h.x-y.x)<=c&&n&&(o=y.x-m.x,V=A,S=!0,_=e,R="top",M=y),D<L&&D<V&&D<=d&&Math.abs(b.x-g.x)<=c&&n&&(o=g.x-w.x,L=D,S=!0,_=e,R="bottom",M=g),E<V&&E<L&&E<=d&&Math.abs(m.x-p.x)<=c&&!n&&(o=h.x-p.x,t=p.x,V=E,S=!0,_=e,R="top",M=p),x<L&&x<V&&x<=d&&Math.abs(w.x-v.x)<=c&&!n&&(o=b.x-v.x,t=v.x,L=x,S=!0,_=e,R="bottom",M=v));return H&&M?$={x:M.x,y:H.y}:H?$=H:M&&($=M),{x:t,y:i,height:s,width:o,isToAdjPresent:S,toAdjIndex:_,hToAdjDirection:C,wToAdjDirection:R,latchPoint:$}})(this,t,i,o,s,e,r),qe(this,"resizeDemo",u),t=u.x,i=u.y,s=u.height,o=u.width),null!==(n=u)&&void 0!==n&&n.isToAdjPresent?a.$limberGridViewCrossHairGuide.style.transform=`translate(${u.latchPoint.x-d.CROSS_HAIR_WIDTH/2}px, ${u.latchPoint.y-d.CROSS_HAIR_HEIGHT/2}px)`:a.$limberGridViewCrossHairGuide.style.transform=`translate(-${2*d.CROSS_HAIR_WIDTH}px, -${2*d.CROSS_HAIR_HEIGHT}px)`,Ie(this,e,t,i,o,s),ye(this),E(this,l);const m=_(this),h=ve(t,i,o,s,c.MARGIN);m[e]={...h};const b=he(this,h,e);let w;({arranged:w}=await Ke(this,b,i,i+s)),Te(this,w)},bt=async function(e,t,i){const o=G(this),s=A(this),r=H(this),n=p(this),l=I(this);if(e=parseInt(e),n.LATCH_MOVED_ITEM){const o=Qe(this,"moveDemo");if(null!=o&&o.latchingAdjacent)t=o.adjustedPt.toAdj.toX,i=o.adjustedPt.toAdj.toY;else if(o)t=o.adjustedPt.to.toX,i=o.adjustedPt.to.toY;else{const o=ge(this,t,i,e);t=o.to.toX,i=o.to.toY}}we(this,e,t,i),E(this,o);const a=_(this),d=pe(t,i,o[e],l.MARGIN);a[e]={...d};const c=be(this,d,e),{arranged:u,resized:m}=await Ke(this,c,i,i+o[e].height);x(this,a),rt(this).push(a),s.$limberGridViewItems[e]?(s.$limberGridViewItems[e].style.transform=`translate(${a[e].x}px, ${a[e].y}px)`,n.ANIMATE_MOVED_ITEM||(s.$limberGridViewItems[e].style.transition="none",setTimeout(()=>{s.$limberGridViewItems[e].style.transition=""},n.ANIMATE_TIME))):dt(this,[e]),Te(this,u),r.resizeComplete&&r.moveComplete(e,t,i,Object.keys(u));for(const e in m)lt(this,e)},It=async function(e,t,i){const o=G(this),s=A(this),r=p(this),n=I(this);if(e=parseInt(e),r.LATCH_MOVED_ITEM){var l,a,d,c;const n=ge(this,t,i,e);let u=Qe(this,"moveDemo");if(!isNaN(null===(l=u)||void 0===l||null===(a=l.adjustedPt)||void 0===a?void 0:a.overlappedItemIndex)&&((e,t)=>{if(t.x>e.x1&&t.x<e.x2&&t.y>e.y1&&t.y<e.y2)return!0})(o[u.adjustedPt.overlappedItemIndex],{x:t,y:i})){u={...u,adjustedPt:n};let e=!1;!u.latchingAdjacent&&u.adjustedPt.isToAdjPresent?(t=u.adjustedPt.toAdj.toX,i=u.adjustedPt.toAdj.toY,e=!0):(t=u.adjustedPt.to.toX,i=u.adjustedPt.to.toY),qe(this,"moveDemo",{...u,latchingAdjacent:e})}else{let e=!1;isNaN(n.overlappedItemIndex)&&n.isToAdjPresent?(t=n.toAdj.toX,i=n.toAdj.toY,e=!0):(t=n.to.toX,i=n.to.toY),qe(this,"moveDemo",{adjustedPt:n,latchingAdjacent:e})}u=Qe(this,"moveDemo"),isNaN(null===(d=u)||void 0===d||null===(c=d.adjustedPt)||void 0===c?void 0:c.overlappedItemIndex)||(s.$limberGridViewMoveGuide.style.transform="translate("+o[u.adjustedPt.overlappedItemIndex].x+"px, "+o[u.adjustedPt.overlappedItemIndex].y+"px)",s.$limberGridViewMoveGuide.style.width=o[u.adjustedPt.overlappedItemIndex].width+"px",s.$limberGridViewMoveGuide.style.height=o[u.adjustedPt.overlappedItemIndex].height+"px",s.$limberGridViewMoveGuide.classList.add("limber-grid-view-move-guide-active"),u.latchingAdjacent?s.$limberGridViewMoveGuide.innerHTML=Je(this,"latchedMoveDemo2"):s.$limberGridViewMoveGuide.innerHTML=Je(this,"latchedMoveDemo1")),u.latchingAdjacent?s.$limberGridViewCrossHairGuide.style.transform=`translate(${t-r.CROSS_HAIR_WIDTH/2}px, ${i-r.CROSS_HAIR_HEIGHT/2}px)`:s.$limberGridViewCrossHairGuide.style.transform=`translate(-${2*r.CROSS_HAIR_WIDTH}px, -${2*r.CROSS_HAIR_HEIGHT}px)`}we(this,e,t,i),ye(this),E(this,o);const u=_(this),m=pe(t,i,o[e],n.MARGIN);u[e]={...m};const h=be(this,m,e),{arranged:b}=await Ke(this,h,i,i+o[e].height);Te(this,b)},wt=function(e){return e.store.variables.eventSpecific.itemInteraction},vt=function(e){return e.store.variables.eventSpecific.deskInteraction},pt=function(e){const t=A(this),i=p(this),o=G(this),s=wt(this),r=et(this),n=z(this,e);n&&(Object.assign(s.userActionData,n),"move"===s.userActionData.type?(s.mouseDownCancel=!1,s.mouseDownTimerComplete=!1,document.addEventListener("mousemove",r.onItemMouseMove),document.addEventListener("mouseup",r.onItemMouseUp),document.addEventListener("contextmenu",r.onItemContextMenu),clearTimeout(s.longPressCheck),s.longPressCheck=setTimeout(gt.bind(this,e),i.MOUSE_DOWN_TIME),e.preventDefault()):"resize"!==s.userActionData.type&&"resizeBottomLeft"!==s.userActionData.type||(s.mouseDownCancel=!1,s.mouseDownTimerComplete=!0,t.$limberGridView.addEventListener("mousemove",r.onItemMouseMove),document.addEventListener("mouseup",r.onItemMouseUp),document.addEventListener("contextmenu",r.onItemContextMenu),s.userActionData.itemX=o[s.userActionData.itemIndex].x,s.userActionData.itemY=o[s.userActionData.itemIndex].y,s.userActionData.itemX2=o[s.userActionData.itemIndex].x2,s.userActionData.itemY2=o[s.userActionData.itemIndex].y2,j(this,s.userActionData),e.preventDefault()),e.stopPropagation())},yt=function(e){const t=A(this),i=p(this),o=G(this),s=wt(this),r=et(this);if(1!==e.touches.length)return void Et.call(this,e);if(!X(this,e))return;const n=z(this,e);n&&(Object.assign(s.userActionData,n),"move"===s.userActionData.type?(s.touchHoldCancel=!1,s.touchHoldTimerComplete=!1,document.addEventListener("touchmove",r.onItemTouchMove),document.addEventListener("touchend",r.onItemTouchEnd),document.addEventListener("touchcancel",r.onItemTouchCancel),document.addEventListener("contextmenu",r.onItemTouchContextMenu),s.longTouchCheck=setTimeout(Tt.bind(this,e),i.TOUCH_HOLD_TIME),e.preventDefault()):"resize"!==s.userActionData.type&&"resizeBottomLeft"!==s.userActionData.type||(s.touchHoldCancel=!1,s.touchHoldTimerComplete=!0,t.$limberGridView.addEventListener("touchmove",r.onItemTouchMove),document.addEventListener("touchend",r.onItemTouchEnd),document.addEventListener("touchcancel",r.onItemTouchCancel),document.addEventListener("contextmenu",r.onItemTouchContextMenu),s.userActionData.itemX=o[s.userActionData.itemIndex].x,s.userActionData.itemY=o[s.userActionData.itemIndex].y,s.userActionData.itemX2=o[s.userActionData.itemIndex].x2,s.userActionData.itemY2=o[s.userActionData.itemIndex].y2,j(this,s.userActionData),e.preventDefault()),e.stopPropagation())},gt=function(e){const t=wt(this);!1===t.mouseDownCancel&&(t.mouseDownTimerComplete=!0,F(this,t.userActionData,e))},Tt=function(e){const t=wt(this);!1===t.touchHoldCancel&&(t.touchHoldTimerComplete=!0,F(this,t.userActionData,e))},ft=function(e){const t=A(this),i=I(this),o=p(this),s=wt(this);if(!0===s.mouseDownTimerComplete)if("move"===s.userActionData.type){B(this,s.userActionData,e,"move"),clearTimeout(s.showMoveDemoTimeOutVariable);const t=W(this,e);if(t){const e=t.y;s.isScrolling||(s.isScrolling=!0,setTimeout(()=>{D(this,e,t.offsetY,o.AUTO_SCROLL_FOR_MOUSE),s.isScrolling=!1},o.AUTO_SCROLL_DELAY)),s.showMoveDemoTimeOutVariable=setTimeout(Ct.bind(this,s.userActionData.itemIndex,t),o.DEMO_WAIT_TIME)}}else{B(this,s.userActionData,e,"resize"),clearTimeout(s.showResizeDemoTimeOutVariable);const r=t.$limberGridView.scrollTop,n=t.$limberGridView.scrollLeft,l=s.userActionData.itemX,a=s.userActionData.itemY;let d,c,u,m;"resize"===s.userActionData.type?(d=l,c=a,u=e.offsetX-l+n-i.PADDING_LEFT,m=e.offsetY-a+r-i.PADDING_TOP):(d=e.offsetX+n-i.PADDING_LEFT,c=a,u=s.userActionData.itemX2-d,m=e.offsetY+r-i.PADDING_TOP-c),s.userActionData.newX1=d,s.userActionData.newY1=c,s.userActionData.newWidth=u,s.userActionData.newHeight=m;const h=e.offsetY,b=e.offsetY+r;s.isScrolling||(s.isScrolling=!0,setTimeout(()=>{D(this,b,h,o.AUTO_SCROLL_FOR_MOUSE),s.isScrolling=!1},o.AUTO_SCROLL_DELAY)),u>0&&m>0&&(t.$limberGridViewPseudoItem.style.transform=`translate(${d}px, ${c}px)`,t.$limberGridViewPseudoItem.style.width=u+"px",t.$limberGridViewPseudoItem.style.height=m+"px",t.$limberGridViewPseudoItem.setAttribute("data-after",`w: ${parseInt(u)}px, h: ${parseInt(m)}px`)),s.showResizeDemoTimeOutVariable=setTimeout(Rt.bind(this,s.userActionData.itemIndex,d,c,u,m,"resize"===s.userActionData.type),o.DEMO_WAIT_TIME)}else s.mouseDownCancel=!0,Gt.call(this,e);e.preventDefault(),e.stopPropagation()},At=function(e){const t=A(this),i=p(this),o=wt(this);if(!0===o.touchHoldTimerComplete&&1===e.touches.length)if("move"===o.userActionData.type){B(this,o.userActionData,e,"move"),clearTimeout(o.showMoveDemoTimeOutVariable);const t=Y(this,e);if(t){const e=t.y;let s;o.isScrolling||(o.isScrolling=!0,setTimeout(()=>{s=D(this,e,t.offsetY,!0),o.isScrolling=!1},i.AUTO_SCROLL_DELAY)),!0!==s&&(o.showMoveDemoTimeOutVariable=setTimeout(Ct.bind(this,o.userActionData.itemIndex,t),i.DEMO_WAIT_TIME))}}else{B(this,o.userActionData,e,"resize"),clearTimeout(o.showResizeDemoTimeOutVariable);const s=o.userActionData.itemX,r=o.userActionData.itemY,n=Y(this,e);let l,a,d,c;if("resize"===o.userActionData.type&&n?(l=s,a=r,d=n.x-s,c=n.y-r):n&&(l=n.x,a=r,d=o.userActionData.itemX2-n.x,c=n.y-r),n&&(o.userActionData.newX1=l,o.userActionData.newY1=a,o.userActionData.newWidth=d,o.userActionData.newHeight=c,d>0&&c>0&&(t.$limberGridViewPseudoItem.style.transform=`translate(${l}px, ${a}px)`,t.$limberGridViewPseudoItem.style.width=d+"px",t.$limberGridViewPseudoItem.style.height=c+"px",t.$limberGridViewPseudoItem.setAttribute("data-after",`w: ${parseInt(d)}px, h: ${parseInt(c)}px`))),n){const e=n.y;let t;o.isScrolling||(o.isScrolling=!0,setTimeout(()=>{t=D(this,e,n.offsetY,!0),o.isScrolling=!1},i.AUTO_SCROLL_DELAY)),!0!==t&&(o.showResizeDemoTimeOutVariable=setTimeout(Rt.bind(this,o.userActionData.itemIndex,l,a,d,c,"resize"===o.userActionData.type),i.DEMO_WAIT_TIME))}}else o.touchHoldCancel=!0,Et.call(this,e);e.stopPropagation()},Dt=async function(e){const t=wt(this);if(clearTimeout(t.showMoveDemoTimeOutVariable),clearTimeout(t.showResizeDemoTimeOutVariable),!0===t.mouseDownTimerComplete)if("move"===t.userActionData.type){const o=W(this,e);var i={};try{if(!o)throw"Mouse position outside grid area.";await bt.call(this,t.userActionData.itemIndex,o.x,o.y),i.x=o.x,i.y=o.y}catch(e){console.error(e),H(this).getLogMessage({type:"error",message:e}),Ht(this)}}else try{const e=t.userActionData.newX1,i=t.userActionData.newY1,o=t.userActionData.newWidth,s=t.userActionData.newHeight;await mt.call(this,t.userActionData.itemIndex,e,i,o,s,"resize"===t.userActionData.type)}catch(e){console.error(e),H(this).getLogMessage({type:"error",message:e}),Ht(this)}else t.mouseDownCancel=!0;Gt.call(this,e),t.userActionData={}},xt=async function(e){const t=wt(this);if(clearTimeout(t.showMoveDemoTimeOutVariable),clearTimeout(t.showResizeDemoTimeOutVariable),!0===t.touchHoldTimerComplete&&0===e.touches.length)if("move"===t.userActionData.type){const o=Y(this,e);var i={};try{if(!o)throw"Touch position outside grid area.";await bt.call(this,t.userActionData.itemIndex,o.x,o.y),i.x=o.x,i.y=o.y}catch(e){console.error(e),H(this).getLogMessage({type:"error",message:e}),Ht(this)}}else try{const e=t.userActionData.newX1,i=t.userActionData.newY1,o=t.userActionData.newWidth,s=t.userActionData.newHeight;await mt.call(this,t.userActionData.itemIndex,e,i,o,s,"resize"===t.userActionData.type)}catch(e){console.error(e),H(this).getLogMessage({type:"error",message:e}),Ht(this)}else t.touchHoldCancel=!0;Et.call(this,e),e.stopPropagation(),t.userActionData={}},Gt=function(e){const t=A(this),i=wt(this),o=et(this);clearTimeout(i.showMoveDemoTimeOutVariable),clearTimeout(i.showResizeDemoTimeOutVariable),clearTimeout(i.longPressCheck),clearTimeout(i.longTouchCheck),((e,t)=>{const i=A(e);i.$limberGridViewHeightAdjustGuide.classList.remove("limber-grid-view-height-adjust-guide-active"),i.$limberGridViewPseudoItem.classList.remove("limber-grid-view-pseudo-item-active"),i.$limberGridViewPseudoItem.style.transform="translate(-1000px, -1000px)",i.$body.classList.remove("limber-grid-view-body-tag-state-editing");const o=i.$limberGridViewItems.length;for(let e=0;e<o;e++)i.$limberGridViewItems[e]&&i.$limberGridViewItems[e].classList.remove("limber-grid-view-item-resizing-state");i.$limberGridViewPseudoItem.classList.remove("limber-grid-view-pseudo-item-resizing-state")})(this,i.userActionData),((e,t)=>{const i=A(e),o=p(e);i.$limberGridViewHeightAdjustGuide.classList.remove("limber-grid-view-height-adjust-guide-active"),i.$limberGridViewItems[t.itemIndex]&&i.$limberGridViewItems[t.itemIndex].classList.remove("limber-grid-view-item-demo"),i.$pseudoContainerItem.classList.remove("limber-grid-view-pseudo-container-item-active"),i.$pseudoContainerItem.style.width="0px",i.$pseudoContainerItem.style.height="0px",i.$pseudoContainerItem.style.transform="translate(-1000px, -1000px)",i.$body.classList.remove("limber-grid-view-body-tag-state-editing"),i.$limberGridViewCrossHairGuide.style.transform=`translate(-${2*o.CROSS_HAIR_WIDTH}px, -${2*o.CROSS_HAIR_HEIGHT}px)`})(this,i.userActionData),(e=>{const t=A(e);t.$limberGridViewMoveGuide.classList.remove("limber-grid-view-move-guide-active"),t.$limberGridViewMoveGuide.style.transform="translate(-1000px, -1000px)"})(this),Ht(this),document.removeEventListener("mousemove",o.onItemMouseMove),t.$limberGridView.removeEventListener("mousemove",o.onItemMouseMove),document.removeEventListener("mouseup",o.onItemMouseUp),document.removeEventListener("contextmenu",o.onItemContextMenu),document.removeEventListener("touchmove",o.onItemTouchMove),t.$limberGridView.removeEventListener("touchmove",o.onItemTouchMove),document.removeEventListener("touchend",o.onItemTouchEnd),document.removeEventListener("contextmenu",o.onItemTouchContextMenu),document.removeEventListener("touchcancel",o.onItemTouchCancel),i.userActionData={},qe(this,"moveDemo",void 0),qe(this,"resizeDemo",void 0);We(this,"rt").emptyTree(),e.preventDefault(),e.stopPropagation()},Et=function(e){Gt.call(this,e)},_t=function(e){Gt.call(this,e)},Ct=async function(e,t){const i=A(this);try{if(!1===t)throw"Invalid mouse position.";await It.call(this,e,t.x,t.y),i.$pseudoContainerItem.classList.remove("limber-grid-view-pseudo-container-item-move-disallow"),i.$pseudoContainerItem.classList.add("limber-grid-view-pseudo-container-item-move-allow")}catch(e){console.error(e),H(this).getLogMessage({type:"error",message:e}),i.$pseudoContainerItem.classList.remove("limber-grid-view-pseudo-container-item-move-allow"),i.$pseudoContainerItem.classList.add("limber-grid-view-pseudo-container-item-move-disallow")}},Rt=async function(e,t,i,o,s,r){const n=A(this);try{await ht.call(this,e,t,i,o,s,r),n.$limberGridViewPseudoItem.classList.add("limber-grid-view-pseudo-item-resize-allow")}catch(e){console.error(e),H(this).getLogMessage({type:"error",message:e}),n.$limberGridViewPseudoItem.classList.add("limber-grid-view-pseudo-item-resize-disallow")}},Ht=ye,Mt=e=>{const t=A(e),i=p(e);t.$body.classList.add("limber-grid-view-body-tag-state-editing","limber-grid-view-body-tag-state-editing-adding-cutting");const o=t.$limberGridViewItems.length;for(let e=0;e<o;e++)t.$limberGridViewItems[e]&&t.$limberGridViewItems[e].classList.add("limber-grid-view-item-resizing-state");t.$limberGridViewPseudoItem.classList.add("limber-grid-view-pseudo-item-resizing-state"),"ADD"===i.DESK_INTERACTION_MODE?t.$limberGridViewAddCutGuide.classList.add("limber-grid-view-add-cut-guide-active"):"CUTSPACE"===i.DESK_INTERACTION_MODE&&t.$limberGridViewAddCutGuide.classList.add("limber-grid-view-add-cut-guide-active","limber-grid-view-add-cut-guide-cut-mode"),t.$limberGridViewHeightAdjustGuide.style.height="0px",t.$limberGridViewHeightAdjustGuide.classList.add("limber-grid-view-height-adjust-guide-active")},$t=function(e){const t=A(this),i=p(this),o=vt(this),s=et(this);e.target.classList.contains("limber-grid-view")&&(e.stopPropagation(),o.mouseDownCancel=!1,o.mouseDownTimerComplete=!1,clearTimeout(o.longPressCheck),o.longPressCheck=setTimeout(Ot.bind(this,e,e.offsetX,e.offsetY),i.MOUSE_DOWN_TIME),t.$limberGridView.addEventListener("mousemove",s.onDeskMouseMove),document.addEventListener("mouseup",s.onDeskMouseUp),document.addEventListener("contextmenu",s.onDeskContextMenu))},Nt=function(e){const t=A(this),i=p(this),o=vt(this),s=et(this);e.target.classList.contains("limber-grid-view")&&1===e.touches.length&&(o.tapHoldCancel=!1,o.tapHoldTimerComplete=!1,t.$limberGridView.addEventListener("touchmove",s.onDeskTouchMove),document.addEventListener("touchend",s.onDeskTouchEnd),document.addEventListener("touchcancel",s.onDeskTouchCancel),document.addEventListener("contextmenu",s.onDeskTouchContextMenu),st.call(this),clearTimeout(o.longTouchCheck),o.longTouchCheck=setTimeout(Vt.bind(this,e),i.TOUCH_HOLD_TIME),e.stopPropagation())},Ot=function(e,t,i){const o=A(this),s=I(this),r=vt(this);if(!1===r.mouseDownCancel){r.mouseDownTimerComplete=!0;var n=o.$limberGridView.scrollTop,l=t+o.$limberGridView.scrollLeft-s.PADDING_LEFT,a=i+n-s.PADDING_TOP;r.userActionData={type:"add",addPositionX:l,addPositionY:a},o.$limberGridViewAddCutGuide.style.height="1px",o.$limberGridViewAddCutGuide.style.width="1px",o.$limberGridViewAddCutGuide.style.transform=`translate(${l}px, ${a}px)`,o.$limberGridViewAddCutGuide.setAttribute("data-after","w: 0px, h: 0px"),Mt(this)}},Vt=function(e){const t=A(this),i=vt(this);if(!1===i.tapHoldCancel){i.tapHoldTimerComplete=!0;const o=Y(this,e),s=o.x,r=o.y;i.userActionData={type:"add",addPositionX:s,addPositionY:r};setTimeout(function(){t.$limberGridViewTouchHoldGuide.classList.remove("limber-grid-view-touch-hold-guide-active"),t.$limberGridViewTouchHoldGuide.style.transform="translate(-1000px, -1000px)"}.bind(this),500),t.$limberGridViewAddCutGuide.style.height="1px",t.$limberGridViewAddCutGuide.style.width="1px",t.$limberGridViewAddCutGuide.style.transform=`translate(${s}px, ${r}px)`,t.$limberGridViewAddCutGuide.setAttribute("data-after","w: 0px, h: 0px"),Mt(this),t.$limberGridViewTouchHoldGuide.style.transform=`translate(${s}px, ${r}px)`,t.$limberGridViewTouchHoldGuide.classList.add("limber-grid-view-touch-hold-guide-active"),e.preventDefault()}},Lt=function(e){const t=A(this),i=I(this),o=p(this),s=vt(this);if(!0===s.mouseDownTimerComplete){t.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-allow","limber-grid-view-add-cut-guide-disallow");const r=t.$limberGridView.scrollTop,n=t.$limberGridView.scrollLeft,l=s.userActionData.addPositionX,a=s.userActionData.addPositionY,d=e.offsetX-l+n-i.PADDING_LEFT,c=e.offsetY-a+r-i.PADDING_TOP;s.userActionData.newWidth=d,s.userActionData.newHeight=c;const u=e.offsetY,m=e.offsetY+r;s.isScrolling||(s.isScrolling=!0,setTimeout(()=>{D(this,m,u,o.AUTO_SCROLL_FOR_MOUSE),s.isScrolling=!1},o.AUTO_SCROLL_DELAY)),d>0&&c>0&&(t.$limberGridViewAddCutGuide.style.width=d+"px",t.$limberGridViewAddCutGuide.style.height=c+"px",t.$limberGridViewAddCutGuide.setAttribute("data-after",`w: ${parseInt(d)}px, h: ${parseInt(c)}px`)),"ADD"===o.DESK_INTERACTION_MODE?(clearTimeout(s.addItemAllowCheckTimeOutVariable),s.addItemAllowCheckTimeOutVariable=setTimeout(Ut.bind(this,s.userActionData.addPositionX,s.userActionData.addPositionY,d,c),o.DEMO_WAIT_TIME)):"CUTSPACE"===o.DESK_INTERACTION_MODE&&(clearTimeout(s.cutSpaceAllowCheckTimeOutVariable),s.cutSpaceAllowCheckTimeOutVariable=setTimeout(zt.bind(this,s.userActionData.addPositionX,s.userActionData.addPositionY,d,c),o.DEMO_WAIT_TIME))}else kt.call(this,e);e.stopPropagation()},St=function(e){const t=A(this),i=p(this),o=vt(this);if(!0===o.tapHoldTimerComplete&&1===e.touches.length){t.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-allow","limber-grid-view-add-cut-guide-disallow");const s=o.userActionData.addPositionX,r=o.userActionData.addPositionY,n=Y(this,e),l=(null==n?void 0:n.x)-s,a=(null==n?void 0:n.y)-r;if(n&&(o.userActionData.newWidth=l,o.userActionData.newHeight=a,l>0&&a>0&&(t.$limberGridViewAddCutGuide.style.width=l+"px",t.$limberGridViewAddCutGuide.style.height=a+"px",t.$limberGridViewAddCutGuide.setAttribute("data-after",`w: ${parseInt(l)}px, h: ${parseInt(a)}px`))),n){const e=n.y;let t;o.isScrolling||(o.isScrolling=!0,setTimeout(()=>{t=D(this,e,n.offsetY,!0),o.isScrolling=!1},i.AUTO_SCROLL_DELAY)),"ADD"===i.DESK_INTERACTION_MODE?(clearTimeout(o.addItemAllowCheckTimeOutVariable),!0!==t&&(o.addItemAllowCheckTimeOutVariable=setTimeout(Ut.bind(this,o.userActionData.addPositionX,o.userActionData.addPositionY,l,a),i.DEMO_WAIT_TIME))):"CUTSPACE"===i.DESK_INTERACTION_MODE&&(clearTimeout(o.cutSpaceAllowCheckTimeOutVariable),!0!==t&&(o.cutSpaceAllowCheckTimeOutVariable=setTimeout(zt.bind(this,o.userActionData.addPositionX,o.userActionData.addPositionY,l,a),i.DEMO_WAIT_TIME)))}e.preventDefault()}else kt.call(this);e.stopPropagation()},Pt=function(e){const t=A(this),i=p(this),o=vt(this);if(clearTimeout(o.addItemAllowCheckTimeOutVariable),clearTimeout(o.longPressCheck),!0===o.mouseDownTimerComplete){if("ADD"===i.DESK_INTERACTION_MODE){if(Se(this,o.userActionData.addPositionX,o.userActionData.addPositionY,o.userActionData.newWidth,o.userActionData.newHeight)){var s={x:o.userActionData.addPositionX,y:o.userActionData.addPositionY,width:o.userActionData.newWidth,height:o.userActionData.newHeight},r=t.$limberGridView.scrollTop;ct(this,s),t.$limberGridView.scrollTop=r}}else if("CUTSPACE"===i.DESK_INTERACTION_MODE){const e=Pe(this,o.userActionData.addPositionX,o.userActionData.addPositionY,o.userActionData.newWidth,o.userActionData.newHeight);e&&Le(this,e.y,e.shiftHeight)}}else o.mouseDownCancel=!0;kt.call(this),e.stopPropagation()},Wt=function(e){const t=A(this),i=p(this),o=vt(this);if(clearTimeout(o.addItemAllowCheckTimeOutVariable),clearTimeout(o.longTouchCheck),!0===o.tapHoldTimerComplete&&0===e.touches.length){if("ADD"===i.DESK_INTERACTION_MODE){if(Se(this,o.userActionData.addPositionX,o.userActionData.addPositionY,o.userActionData.newWidth,o.userActionData.newHeight)){const e={x:o.userActionData.addPositionX,y:o.userActionData.addPositionY,width:o.userActionData.newWidth,height:o.userActionData.newHeight},i=t.$limberGridView.scrollTop;ct(this,e),t.$limberGridView.scrollTop=i}}else if("CUTSPACE"===i.DESK_INTERACTION_MODE){const e=Pe(this,o.userActionData.addPositionX,o.userActionData.addPositionY,o.userActionData.newWidth,o.userActionData.newHeight);e&&Le(this,e.y,e.shiftHeight)}}else o.tapHoldCancel=!0;kt.call(this),e.stopPropagation()},Yt=function(e){kt.call(this)},Xt=function(e){e.preventDefault()},kt=function(e){const t=A(this),i=vt(this),o=et(this);clearTimeout(i.addItemAllowCheckTimeOutVariable),clearTimeout(i.cutSpaceAllowCheckTimeOutVariable),clearTimeout(i.longPressCheck),clearTimeout(i.longTouchCheck),(e=>{const t=A(e);t.$body.classList.remove("limber-grid-view-body-tag-state-editing","limber-grid-view-body-tag-state-editing-adding-cutting");const i=t.$limberGridViewItems.length;for(var o=0;o<i;o++)t.$limberGridViewItems[o]&&t.$limberGridViewItems[o].classList.remove("limber-grid-view-item-resizing-state");t.$limberGridViewPseudoItem.classList.remove("limber-grid-view-pseudo-item-resizing-state"),t.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-active","limber-grid-view-add-cut-guide-cut-mode","limber-grid-view-add-cut-guide-add-allow","limber-grid-view-add-cut-guide-add-disallow"),t.$limberGridViewAddCutGuide.style.transform="translate(-1000px, -1000px)",t.$limberGridViewHeightAdjustGuide.style.height="0px",t.$limberGridViewHeightAdjustGuide.classList.remove("limber-grid-view-height-adjust-guide-active"),t.$limberGridViewTouchHoldGuide.classList.remove("limber-grid-view-touch-hold-guide-active"),t.$limberGridViewTouchHoldGuide.style.transform="translate(-1000px, -1000px)"})(this),t.$limberGridView.removeEventListener("mousemove",o.onDeskMouseMove),document.removeEventListener("mouseup",o.onDeskMouseUp),document.removeEventListener("contextmenu",o.onDeskContextMenu),t.$limberGridView.removeEventListener("touchmove",o.onDeskTouchMove),document.removeEventListener("touchend",o.onDeskTouchEnd),document.removeEventListener("touchcancel",o.onDeskTouchCancel),document.removeEventListener("contextmenu",o.onDeskTouchContextMenu),ot.call(this),i.userActionData={},e&&(e.preventDefault(),e.stopPropagation())},Ut=function(e,t,i,o){const s=A(this);!1===Se(this,e,t,i,o)?(s.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-allow"),s.$limberGridViewAddCutGuide.classList.add("limber-grid-view-add-cut-guide-disallow")):(s.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-disallow"),s.$limberGridViewAddCutGuide.classList.add("limber-grid-view-add-cut-guide-allow"))},zt=function(e,t,i,o){const s=A(this);!1===Pe(this,0,t,i,o)?(s.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-allow"),s.$limberGridViewAddCutGuide.classList.add("limber-grid-view-add-cut-guide-disallow")):(s.$limberGridViewAddCutGuide.classList.remove("limber-grid-view-add-cut-guide-disallow"),s.$limberGridViewAddCutGuide.classList.add("limber-grid-view-add-cut-guide-allow"))};var jt=i(3),Ft=i.n(jt);const Bt={ADD:!0,CUTSPACE:!0},Zt=async function(e,t,i){const o=A(e),s=I(e),r=G(e);if(!0===i||!(e=>{if(Array.isArray(e)){const o=e.length;for(let s=0;s<o;s++)if(i=e[s],isNaN(i.x1)||isNaN(i.x2)||isNaN(i.y1)||isNaN(i.y2)||i.x1>=i.x2||i.y1>=i.y2){if(!ce(e[s]))return!1;ee(e[s])}else(t=e[s]).x=t.x1,t.y=t.y1,t.width=t.x2-t.x1,t.height=t.y2-t.y1;return!0}var t,i;return!1})(r)){console.warn("Auto-arranging"),E(e,r);const t=_(e),i=r.length,o=new Array(i);for(let e=0;e<i;e++)o[e]=e,t[e].x1=0,t[e].x2=0,t[e].y1=0,t[e].y2=0,t[e].x=0,t[e].y=0,t[e].width=t[e].width/s.WIDTH_SCALE_FACTOR||2*s.MIN_HEIGHT_AND_WIDTH,t[e].height=t[e].height/s.WIDTH_SCALE_FACTOR||2*s.MIN_HEIGHT_AND_WIDTH,t[e].mX1=0,t[e].mX2=0,t[e].mY1=0,t[e].mY2=0,t[e].mX=0,t[e].mY=0,t[e].mWidth=t[e].width+2*s.MARGIN,t[e].mHeight=t[e].height+2*s.MARGIN,Object.assign(r[e],t[e]);a(e,s.GRID_WIDTH),c(e,s.GRID_HEIGHT),m(e,s.GRID_MARGIN),u(e,1),h(e,s.MIN_HEIGHT_AND_WIDTH),await(async e=>{const t=_(e),i=I(e),o=2*i.MIN_HEIGHT_AND_WIDTH,s=o,r=Math.floor(i.WIDTH/o),n=t.length;let l=0;for(let e=0;e<n;e+=r){const a=e/r;for(let e=0;e<r&&l<n;e++)t[l].x1=e*i.MARGIN*2+e*o+i.MARGIN,t[l].x2=t[l].x1+o,t[l].y1=a*i.MARGIN*2+a*s+i.MARGIN,t[l].y2=t[l].y1+s,t[l].x=t[l].x1,t[l].y=t[l].y1,oe(t[l]),t[l].mX1=t[l].x1-i.MARGIN,t[l].mX2=t[l].x2+i.MARGIN,t[l].mY1=t[l].y1-i.MARGIN,t[l].mY2=t[l].y1+i.MARGIN,t[l].mX=t[l].mX1,t[l].mY=t[l].mY2,l++}})(e),x(e,t)}if(function(e,t){e.store.constants.privateConstants.PADDING_LEFT=t}(e,parseInt(window.getComputedStyle(o.$limberGridView,null).getPropertyValue("padding-left"))),function(e,t){e.store.constants.privateConstants.PADDING_RIGHT=t}(e,parseInt(window.getComputedStyle(o.$limberGridView,null).getPropertyValue("padding-right"))),function(e,t){e.store.constants.privateConstants.PADDING_TOP=t}(e,parseInt(window.getComputedStyle(o.$limberGridView,null).getPropertyValue("padding-top"))),function(e,t){e.store.constants.privateConstants.PADDING_BOTTOM=t}(e,parseInt(window.getComputedStyle(o.$limberGridView,null).getPropertyValue("padding-bottom"))),a(e,o.$limberGridView.clientWidth-s.PADDING_LEFT-s.PADDING_RIGHT),c(e,o.$limberGridView.clientHeight-s.PADDING_TOP-s.PADDING_BOTTOM),t){const e=r.length;for(let t=0;t<e;t++)r[t].x1/=s.WIDTH_SCALE_FACTOR,r[t].x2/=s.WIDTH_SCALE_FACTOR,r[t].y1/=s.WIDTH_SCALE_FACTOR,r[t].y2/=s.WIDTH_SCALE_FACTOR,r[t].x/=s.WIDTH_SCALE_FACTOR,r[t].y/=s.WIDTH_SCALE_FACTOR,r[t].width/=s.WIDTH_SCALE_FACTOR,r[t].height/=s.WIDTH_SCALE_FACTOR;s.MARGIN/=s.WIDTH_SCALE_FACTOR,s.DEFINED_MIN_HEIGHT_AND_WIDTH/=s.WIDTH_SCALE_FACTOR}if(u(e,s.WIDTH/s.GRID_WIDTH),m(e,s.MARGIN*s.WIDTH_SCALE_FACTOR),h(e,s.DEFINED_MIN_HEIGHT_AND_WIDTH*s.WIDTH_SCALE_FACTOR),q(e)){T(e).style.transform="translate(1px, 1px)",C(e,r);const t=new Array(15).fill(0).map((e,t)=>t);N(e,t)}else{T(e).style.transform=`translate(0px, ${L(e)*s.HEIGHT}px)`,f(e).style.transform=`translate(0px, ${P(e)*s.HEIGHT}px)`;const t={x1:0,x2:s.WIDTH,y1:L(e)*s.HEIGHT-s.HEIGHT/2,y2:P(e)*s.HEIGHT+s.HEIGHT/2};N(e,me(e,t,!0))}},Kt=function(e){var t,i,o,s,r,n,l,a,d,c,u,m,h,b,I,w,p,y,g,T,f,A,D,x,G,E,_,C;"number"==typeof(null==e||null===(t=e.gridData)||void 0===t?void 0:t.WIDTH)&&(_=this,C=e.gridData.WIDTH,_.store.constants.privateConstants.GRID_WIDTH=C),"number"==typeof(null==e||null===(i=e.gridData)||void 0===i?void 0:i.HEIGHT)&&function(e,t){e.store.constants.privateConstants.GRID_HEIGHT=t}(this,e.gridData.HEIGHT),"number"==typeof(null==e||null===(o=e.gridData)||void 0===o?void 0:o.MARGIN)&&function(e,t){e.store.constants.privateConstants.GRID_MARGIN=t}(this,e.gridData.MARGIN),"number"==typeof(null==e||null===(s=e.gridData)||void 0===s?void 0:s.MIN_HEIGHT_AND_WIDTH)&&function(e,t){e.store.constants.privateConstants.MIN_HEIGHT_AND_WIDTH=t}(this.options.gridData.MIN_HEIGHT_AND_WIDTH),"number"==typeof(null==e||null===(r=e.publicConstants)||void 0===r?void 0:r.mobileAspectRatio)&&v(this,"MOBILE_ASPECT_RATIO",e.publicConstants.mobileAspectRatio),"number"==typeof(null==e||null===(n=e.publicConstants)||void 0===n?void 0:n.moveGuideRadius)&&v(this,"MOVE_GUIDE_RADIUS",e.publicConstants.moveGuideRadius),"number"==typeof(null==e||null===(l=e.publicConstants)||void 0===l?void 0:l.resizeSquareGuideLength)&&v(this,"RESIZE_SQUARE_GUIDE_LENGTH",e.publicConstants.resizeSquareGuideLength),"number"==typeof(null==e||null===(a=e.publicConstants)||void 0===a?void 0:a.resizeSquareBorderGuideWidth)&&v(this,"RESIZE_SQUARE_GUIDE_BORDER_WIDTH",e.publicConstants.resizeSquareBorderGuideWidth),"boolean"==typeof(null==e||null===(d=e.publicConstants)||void 0===d?void 0:d.showBottomLeftResizeGuide)&&v(this,"SHOW_BOTTOM_LEFT_RESIZE_GUIDE",e.publicConstants.showBottomLeftResizeGuide),"number"==typeof(null==e||null===(c=e.publicConstants)||void 0===c?void 0:c.autoScrollDistance)&&v(this,"AUTO_SCROLL_DISTANCE",e.publicConstants.autoScrollDistance),"number"==typeof(null==e||null===(u=e.publicConstants)||void 0===u?void 0:u.autoScrollPoint)&&v(this,"AUTO_SCROLL_POINT",e.publicConstants.autoScrollPoint),"number"==typeof(null==e||null===(m=e.publicConstants)||void 0===m?void 0:m.moveOrResizeHeightIncrements)&&v(this,"MOVE_OR_RESIZE_HEIGHT_INCREMENTS",e.publicConstants.moveOrResizeHeightIncrements),"boolean"==typeof(null==e||null===(h=e.publicConstants)||void 0===h?void 0:h.autoScrollForMouse)&&v(this,"AUTO_SCROLL_FOR_MOUSE",e.publicConstants.autoScrollForMouse),"number"==typeof(null==e||null===(b=e.publicConstants)||void 0===b?void 0:b.mouseDownTime)&&v(this,"MOUSE_DOWN_TIME",e.publicConstants.mouseDownTime),"number"==typeof(null==e||null===(I=e.publicConstants)||void 0===I?void 0:I.touchHoldTime)&&v(this,"TOUCH_HOLD_TIME",e.publicConstants.touchHoldTime),"number"==typeof(null==e||null===(w=e.publicConstants)||void 0===w?void 0:w.demoWaitTime)&&v(this,"DEMO_WAIT_TIME",e.publicConstants.demoWaitTime),"number"==typeof(null==e||null===(p=e.publicConstants)||void 0===p?void 0:p.windowResizeWaitTime)&&v(this,"WINDOW_RESIZE_WAIT_TIME",e.publicConstants.windowResizeWaitTime),"number"==typeof(null==e||null===(y=e.publicConstants)||void 0===y?void 0:y.autoScrollDelay)&&v(this,"AUTO_SCROLL_DELAY",e.publicConstants.autoScrollDelay),null!=e&&null!==(g=e.publicConstants)&&void 0!==g&&g.deskInteractionMode&&Bt[e.publicConstants.deskInteractionMode]&&v(this,"DESK_INTERACTION_MODE",e.publicConstants.deskInteractionMode),"boolean"==typeof(null==e||null===(T=e.publicConstants)||void 0===T?void 0:T.latchMovedItem)&&v(this,"LATCH_MOVED_ITEM",e.publicConstants.latchMovedItem),"boolean"==typeof(null==e||null===(f=e.publicConstants)||void 0===f?void 0:f.animateMovedItem)&&v(this,"ANIMATE_MOVED_ITEM",e.publicConstants.animateMovedItem),"number"==typeof(null==e||null===(A=e.publicConstants)||void 0===A?void 0:A.animateTime)&&v(this,"ANIMATE_TIME",e.publicConstants.animateTime),"number"==typeof(null==e||null===(D=e.publicConstants)||void 0===D?void 0:D.crossHairWidth)&&v(this,"CROSS_HAIR_WIDTH",e.publicConstants.crossHairWidth),"number"==typeof(null==e||null===(x=e.publicConstants)||void 0===x?void 0:x.crossHairHeight)&&v(this,"CROSS_HAIR_HEIGHT",e.publicConstants.crossHairHeight),"number"==typeof(null==e||null===(G=e.publicConstants)||void 0===G?void 0:G.shrinkToFit)&&(null==e||null===(E=e.publicConstants)||void 0===E?void 0:E.shrinkToFit)<=10&&v(this,"SHRINK_TO_FIT",e.publicConstants.shrinkToFit)},qt=function(){const e=A(this),t=k(this),i=p(this);var o,s;let r;o=this,s=document.getElementsByTagName("body")[0],o.store.variables.elements.$body=s;do{r="limber-grid-view-pseudo-container-"+J()}while(null!==document.getElementById(r));!function(e,t){e.store.variables.essentials.pseudoContainerId=t}(this,r);const n=document.createElement("div");if(n.setAttribute("class","limber-grid-view-pseudo-container"),n.setAttribute("id",r),function(e,t){e.store.variables.elements.$pseudoContainer=t}(this,n),t.pseudoElementContainer){let e;"string"==typeof t.pseudoElementContainer?e=document.getElementById(t.pseudoElementContainer):t.pseudoElementContainer instanceof Element&&(e=t.pseudoElementContainer),e.appendChild(n)}else e.$body.appendChild(n);e.$el.innerHTML='<div class = "limber-grid-view-container"><div class = "limber-grid-view"></div><div class = "limber-grid-view-license"><div class = "limber-grid-view-license-icon">Â©</div><div class = "limber-grid-view-license-details">LimberGridView Copyright Â© 2018-2020 Subendra Kumar Sharma. License GPLv3+: GNU GPL version 3 or later &lthttps://www.gnu.org/licenses/&gt.</div></div></div>',function(e,t){e.store.variables.elements.$limberGridViewContainer=t}(this,e.$el.getElementsByClassName("limber-grid-view-container")[0]),function(e,t){e.store.variables.elements.$limberGridView=t}(this,e.$el.getElementsByClassName("limber-grid-view")[0]);const l=document.createElement("div"),a=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),m=document.createElement("div");m.innerHTML="<div></div>";const h=document.createElement("div");h.innerHTML="<hr></hr><hr></hr>";const b=document.createElement("div"),I=document.createElement("div");l.setAttribute("class","limber-grid-view-pseudo-container-item"),a.setAttribute("class","limber-grid-view-pseudo-item"),d.setAttribute("class","limber-grid-view-move-guide"),c.setAttribute("class","limber-grid-view-height-adjust-guide"),u.setAttribute("class","limber-grid-view-add-cut-guide"),m.setAttribute("class","limber-grid-view-touch-hold-guide"),h.setAttribute("class","limber-grid-view-cross-hair-guide"),h.style.transform=`translate(-${2*i.CROSS_HAIR_WIDTH}px, -${2*i.CROSS_HAIR_HEIGHT}px)`,b.setAttribute("class","limber-grid-view-io-top-helper"),I.setAttribute("class","limber-grid-view-io-bottom-helper"),e.$pseudoContainer.appendChild(l),e.$limberGridView.appendChild(a),e.$limberGridView.appendChild(d),e.$limberGridView.appendChild(c),e.$limberGridView.appendChild(u),e.$limberGridView.appendChild(m),e.$limberGridView.appendChild(h),e.$limberGridView.appendChild(b),e.$limberGridView.appendChild(I),function(e,t){e.store.variables.elements.$pseudoContainerItem=t}(this,l),function(e,t){e.store.variables.elements.$limberGridViewPseudoItem=t}(this,a),function(e,t){e.store.variables.elements.$limberGridViewMoveGuide=t}(this,d),function(e,t){e.store.variables.elements.$limberGridViewHeightAdjustGuide=t}(this,c),function(e,t){e.store.variables.elements.$limberGridViewAddCutGuide=t}(this,u),function(e,t){e.store.variables.elements.$limberGridViewTouchHoldGuide=t}(this,m),function(e,t){e.store.variables.elements.$limberGridViewCrossHairGuide=t}(this,h),function(e,t){e.store.variables.elements.$limberGridViewIOTopHelper=t}(this,b),function(e,t){e.store.variables.elements.$limberGridViewIOBottomHelper=t}(this,I)},Qt=function(e,t){e.store.observer.resizeObserver.isResizeObserving=t},Jt=function(){M(this,ti(g(this).getBoundingClientRect()));const e=window.ResizeObserver?window.ResizeObserver:Ft.a;this.store.observer.resizeObserver.resizeObserver=new e(et(this).resizeObserverCallback),this.store.observer.resizeObserver.resizeObserver.observe(g(this))},ei=function(){const e=p(this);this.store.observer.resizeObserver.isResizeObserving||(Qt(this,!0),setTimeout(async()=>{const e=$(this);M(this,ti(g(this).getBoundingClientRect())),!q(this)&&q(this,e)&&(V(this,-1),S(this,1.5),N(this,[])),await Zt(this,!0,!1),nt(this),Qt(this,!1)},e.WINDOW_RESIZE_WAIT_TIME))},ti=function(e){return{x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left}},ii=function(){this.store.observer.intersectionObserver.intersectionObserver=new IntersectionObserver(et(this).intersectionObserverCallback,{root:g(this),threshold:1}),this.store.observer.intersectionObserver.intersectionObserver.observe(T(this)),this.store.observer.intersectionObserver.intersectionObserver.observe(f(this))},oi=function(e,t){if(1!==e.length||!e[0].isIntersecting)return;const i=e[0];if(q(this)){const e=O(this),t=G(this).length;let o,s=!1;if(i.target.classList.contains("limber-grid-view-io-top-helper")){const t=e[0];o=t-9>0?t-9:0,s=!0}else{const t=e[e.length-1];o=t-4>0?t-4:0}const r=o+14<t?o+14:t-1;if(r<0){const t={};for(const i of e)t[i]=!0;return at(this,t),dt(this,[]),void N(this,[])}const n=[],a={},d={},c={},u=[];for(let e=o;e<=r;e++)n.push(e),a[e]=!0;for(const t of e)d[t]=!0,a[t]||(c[t]=!0);for(const e of n)d[e]||u.push(e);N(this,n),s&&u.reverse(),at(this,c),dt(this,u,s);const m=A(this),h=l(this),b=w(this);s&&u.length&&m.$limberGridView.scrollTo({left:0,top:h.WIDTH/b.MOBILE_ASPECT_RATIO*u.length,behavior:"auto"})}else i.target.classList.contains("limber-grid-view-io-top-helper")?(S(this,L(this)+1.5),V(this,L(this)-1)):(V(this,P(this)-1.5),S(this,P(this)+1)),si(this)},si=function(e){const t=l(e),i={x1:0,x2:t.WIDTH,y1:L(e)*t.HEIGHT-t.HEIGHT/2,y2:P(e)*t.HEIGHT+t.HEIGHT/2},o=me(e,i,!0),s={};for(const e of o)s[e]=!0;const r=O(e),n={};for(const e of r)n[e]=!0;const a={};for(const e of o)n[e]||(a[e]=!0);const d={};for(const e of r)s[e]||(d[e]=!0);N(e,o),at(e,d),dt(e,Object.keys(a)),T(e).style.transform=`translate(0px, ${L(e)*t.HEIGHT}px)`,f(e).style.transform=`translate(0px, ${P(e)*t.HEIGHT}px)`},ri=function(e){clearTimeout(this.store.variables.essentials.onScrollTimeout),function(e,t){e.store.variables.essentials.onScrollTimeout=t}(this,setTimeout(et(this).onScrollCallback,1e3))},ni=function(e){const t=l(this),i=g(this);if(!q(this)){const e=i.scrollTop,r={x1:0,x2:t.WIDTH,y1:e,y2:e+t.HEIGHT},n={x1:0,x2:t.WIDTH,y1:L(this)*t.HEIGHT,y2:P(this)*t.HEIGHT};if(o=r,s=n,isNaN(o.x1)||isNaN(o.y1)||isNaN(o.x2)||isNaN(o.y2)||isNaN(s.x1)||isNaN(s.y1)||isNaN(s.x2)||isNaN(s.y2)||o.x1>s.x2||s.x1>o.x2||o.y1>s.y2||s.y1>o.y2){const e={...r};e.y1=r.y1-.75*t.HEIGHT;let i=Q(e.y1/t.HEIGHT,1);i=i%1>.66?Math.ceil(i):i%1<.33?Math.trunc(i):Math.trunc(i)+.5;const o=i+2.5;V(this,i),S(this,o),si(this)}}var o,s};
/** @license LimberGridView

LimberGridView, a powerful JavaScript Libary that gives you movable, resizable(any size) and auto-arranging grids.

Copyright Â© 2018-2020 Subendra Kumar Sharma. All Rights reserved. (jobs.sharma.subendra.kr@gmail.com)

This file is part of LimberGridView.

LimberGridView is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

LimberGridView is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with LimberGridView.  If not, see <https://www.gnu.org/licenses/>.

Written by Subendra Kumar Sharma.

*/
function li(e){var t,i;if(this.initializeStore(),function(e,t){Object.assign(e.options,t)}(this,e),x(this,e.positionData),t=this,i=e.callbacks,t.store.variables.essentials.callbacks=i,rt(this).push(G(this)),"string"==typeof e.el){const t=document.getElementById(e.el);if(!t)throw"No for element found for id "+e.el;y(this,t)}else{if(!(e.el instanceof Element))throw"Valid DOM Element or Id required";y(this,e.el)}Kt.call(this,e),qt.call(this),Jt.call(this),ii.call(this);A(this).$limberGridView.addEventListener("scroll",et(this).onScroll),setTimeout(async function(){await Zt(this,!1,e.autoArrange),nt(this,!0)}.bind(this))}li.prototype.initializeStore=function(){this.options={editable:!0,reRenderOnResize:!0,enableInteractiveAddAndCut:!0,enableTouchInteraction:!0},this.store={variables:{elements:{$body:void 0,$pseudoContainer:void 0,$pseudoContainerItem:void 0,$el:void 0,$limberGridViewContainer:void 0,$limberGridView:void 0,$limberGridViewItems:[],$limberGridViewPseudoItem:void 0,$limberGridViewMoveGuide:void 0,$limberGridViewHeightAdjustGuide:void 0,$limberGridViewAddCutGuide:void 0,$limberGridViewTouchHoldGuide:void 0,$limberGridViewDebugMergedTempRects:[],$limberGridViewDebugStackTopRect:void 0,$limberGridViewDebugStackTopAdjRect:void 0,$limberGridViewDebugMergedRect:void 0,$limberGridViewDebugAdjRect:void 0,$limberGridViewDebugResultStackRects:[],$limberGridViewDebugStackRects:[],$limberGridViewDebugUnmergedRects:[],$limberGridViewDebugMergedFreeRects:[]},essentials:{pseudoContainerId:void 0,positionData:[],modifiedPositionData:[],renderedItems:[],ioTopHelperPos:-1,ioBottomHelperPos:1.5,gridData:{},callbacks:{}},bindedFunctions:{onItemMouseDown:pt.bind(this),onItemTouchStart:yt.bind(this),onItemMouseMove:ft.bind(this),onItemTouchMove:At.bind(this),onItemMouseUp:Dt.bind(this),onItemTouchEnd:xt.bind(this),onItemContextMenu:Gt.bind(this),onItemTouchContextMenu:Et.bind(this),onItemTouchCancel:_t.bind(this),onDeskMouseDown:$t.bind(this),onDeskTouchStart:Nt.bind(this),onDeskMouseMove:Lt.bind(this),onDeskTouchMove:St.bind(this),onDeskMouseUp:Pt.bind(this),onDeskTouchEnd:Wt.bind(this),onDeskTouchCancel:Yt.bind(this),onDeskTouchContextMenu:Xt.bind(this),onDeskContextMenu:kt.bind(this),resizeObserverCallback:ei.bind(this),intersectionObserverCallback:oi.bind(this),onScroll:ri.bind(this),onScrollCallback:ni.bind(this)},eventSpecific:{itemInteraction:{userActionData:{},mouseDownCancel:!1,mouseDownTimerComplete:!0,touchHoldCancel:!1,touchHoldTimerComplete:!1,longPressCheck:void 0,longTouchCheck:void 0,showResizeDemoTimeOutVariable:void 0,showMoveDemoTimeOutVariable:void 0},deskInteraction:{userActionData:{},mouseDownCancel:!1,mouseDownTimerComplete:!1,tapHoldCancel:!1,tapHoldTimerComplete:!1,longPressCheck:void 0,longTouchCheck:void 0,addItemAllowCheckTimeOutVariable:void 0,cutSpaceAllowCheckTimeOutVariable:void 0}},status:{},trees:{rt:new o.RTreeIterative({M:4})},stacks:{stack:new s.ArrayStack,garbageStack:new s.ArrayStack},undoRedo:new n.a},constants:{privateConstants:{WIDTH:0,HEIGHT:0,PADDING_LEFT:0,PADDING_RIGHT:0,PADDING_TOP:0,PADDING_BOTTOM:0,WIDTH_SCALE_FACTOR:1,MARGIN:8,DEFINED_MIN_HEIGHT_AND_WIDTH:150,GRID_WIDTH:1920,GRID_HEIGHT:1080,GRID_MARGIN:8,MIN_HEIGHT_AND_WIDTH:150},publicConstants:{MOBILE_ASPECT_RATIO:5/4,MOVE_GUIDE_RADIUS:10,RESIZE_SQUARE_GUIDE_LENGTH:10,RESIZE_SQUARE_GUIDE_BORDER_WIDTH:3,SHOW_BOTTOM_LEFT_RESIZE_GUIDE:!1,AUTO_SCROLL_DISTANCE:50,AUTO_SCROLL_POINT:50,MOVE_OR_RESIZE_HEIGHT_INCREMENTS:50,AUTO_SCROLL_FOR_MOUSE:!1,MOUSE_DOWN_TIME:300,TOUCH_HOLD_TIME:300,DEMO_WAIT_TIME:500,WINDOW_RESIZE_WAIT_TIME:1e3,AUTO_SCROLL_DELAY:100,DESK_INTERACTION_MODE:"CUTSPACE",LATCH_MOVED_ITEM:!0,ANIMATE_MOVED_ITEM:!1,ANIMATE_TIME:250,CROSS_HAIR_WIDTH:500,CROSS_HAIR_HEIGHT:500,SHRINK_TO_FIT:10},messages:{latchedMoveDemo1:"Move curser close to an adjacent item over this box to latch next to that item.",latchedMoveDemo2:"Move curser over this box to latch on to this item."}},observer:{resizeObserver:{resizeObserver:void 0,isResizeObserving:!1},intersectionObserver:{intersectionObserver:void 0}}}},li.prototype.renderItem=function(e){lt(this,e)},li.prototype.getGridData=function(){const e=l(this),t=G(this),i=t.length,o=new Array(i);for(let s=0;s<i;s++)o[s]={x:Q(t[s].x/e.WIDTH_SCALE_FACTOR),y:Q(t[s].y/e.WIDTH_SCALE_FACTOR),width:Q(t[s].width/e.WIDTH_SCALE_FACTOR),height:Q(t[s].height/e.WIDTH_SCALE_FACTOR)};return{gridData:{height:e.GRID_HEIGHT,width:e.GRID_WIDTH,margin:e.GRID_MARGIN,MIN_HEIGHT_AND_WIDTH:e.MIN_HEIGHT_AND_WIDTH},positionData:o}},li.prototype.setDeskInteractMode=function(e){Bt[e]&&v(this,"DESK_INTERACTION_MODE",e)},li.prototype.setLatchMovedItem=function(e){"boolean"==typeof e&&v(this,"LATCH_MOVED_ITEM",e)},li.prototype.setShrinkToFit=function(e){"number"==typeof e&&e<=10&&v(this,"SHRINK_TO_FIT",e)},li.prototype.addItem=function(e){if(!e){const t=l(this);e={width:t.DEFINED_MIN_HEIGHT_AND_WIDTH,height:t.DEFINED_MIN_HEIGHT_AND_WIDTH}}ct(this,e)},li.prototype.removeItem=function(e){Number.isInteger(e)&&function(e,t){const i=A(e),o=H(e),s=G(e),r=I(e),n=p(e);it.call(e),s.splice(t,1),rt(e).reset(),rt(e).push(s),i.$limberGridViewItems[t]&&(o.removePlugin&&o.removePlugin(i.$limberGridViewItems[t]),i.$limberGridView.removeChild(i.$limberGridViewItems[t]),o.removeComplete&&o.removeComplete(t,i.$limberGridViewItems[t]),i.$limberGridViewItems[t]=void 0),i.$limberGridViewItems.splice(t,1);const l=s.length;for(let e=t;e<l;e++)i.$limberGridViewItems[e]&&i.$limberGridViewItems[e].setAttribute("data-index",e);for(let a=t;a<l;a++){if(!i.$limberGridViewItems[a])continue;let t;t=q(e)?o.renderContent(a,r.WIDTH,r.WIDTH/n.MOBILE_ASPECT_RATIO):o.renderContent(a,s[a].width,s[a].height),ut(e,t,i.$limberGridViewItems[a])}const a=O(e);a.find(e=>e===t)&&(a.length=a.length-1),tt.call(e)}(this,e)},li.prototype.setIsMobileCheck=function(e){this.options.isMobileCheck=e},li.prototype.undo=function(){const e=rt(this).undo();if(e){const t=ue(G(this),e);x(this,e),ye(this);for(const e in t)this.renderItem(e)}},li.prototype.redo=function(){const e=rt(this).redo();if(e){const t=ue(G(this),e);x(this,e),ye(this);for(const e in t)this.renderItem(e)}},li.prototype.isUndoAvailable=function(){return rt(this).isUndoAvailable()},li.prototype.isRedoAvailable=function(){return rt(this).isRedoAvailable()},li.prototype.setAutoScrollDelay=function(e){"number"==typeof e&&v(this,"AUTO_SCROLL_DELAY",e)},li.prototype.setAutoScrollForMouse=function(e){"boolean"==typeof e&&v(this,"AUTO_SCROLL_FOR_MOUSE",e)},li.prototype.destroy=function(e){it.call(this);const t=this.store.variables.elements.$pseudoContainer;const i=function(e){return e.store.variables.elements.$limberGridViewContainer}(this);t.remove(),i.remove()};t.default=li}])}));